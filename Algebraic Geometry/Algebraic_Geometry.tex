\documentclass{report}
\input{preamble}
\input{macros}
\input{letterfonts}

\title{Notes on Algebraic Geometry and Commutative Algebra}
\author{Eric Liu}
\date{}
\begin{document}
\maketitle
\newpage% or \cleardoublepage
% \pdfbookmark[<level>]{<title>}{<dest>}
\pdfbookmark[section]{\contentsname}{toc}

\tableofcontents
\pagebreak
\chapter{Commutative Algebra} 
\section{Rings}
The precise meaning of the term \textbf{ring} varies across different books, depending on the context and purpose. In this note, the multiplication of a ring is always associative, commutative, and has an identity. The additive identity is denoted by $0$. From the axioms, we can straightforwardly show that $x\cdot 0 = 0$ for all $x$. Consequently, the multiplicative and additive identities are always distinct unless the ring contained only one element, and in such case, we say the ring is the \textbf{zero ring}. By \textbf{ring homomorphisms}, we mean mappings between two rings respecting addition\footnote{Respecting addition immediately implies respecting $0$ and negation. Respecting multiplication and multiplicative identity immediately implies respecting units.}, multiplication, and multiplicative identity. 
\begin{theorem}
\label{THrh}
\textbf{(Properties of ring homomorphisms)} Let $A,B$ be two rings and  $f:A\rightarrow B$ be a ring homomorphism. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $f(0_A)=0_B$. 
  \item $f(-x)=-f(x)$ for all $x \in A$. 
  \item $f(u)\in B$ is a unit for all unit $u \in A$. 
\end{enumerate}
\end{theorem}
\begin{proof}
(i): Observe $f(0_A)+0_B=f(0_A)=f(0_A+0_A)=f(0_A)+f(0_A)$. Subtracting both side with $f(0_A)$, we now see $f(0_A)=0_B$. \\

(ii) follows from (i), as $f(-x)+f(x)=f(-x+x)=f(0)=0$. \\

(iii): $f(u)f(u^{-1})=f(uu^{-1})=f(1)=1$. 
\end{proof}

Clearly, inverse of a bijective ring homomorphism is also a ring homomorphism.\\  

An \textbf{ideal} of a ring $A$ is an additive subgroup $\mathfrak{a}$ such that $xy \in \mathfrak{a}$ for all $x \in \mathfrak{a},  y \in A$. \textbf{Quotient ring} is a ring $A\quotient \mathfrak{a}$ together with a surjective ring homomorphism $\pi :A\rightarrow A\quotient \mathfrak{a}$ that satisfies the \textbf{universal property of quotient ring}: For each ring homomorphism $f:A\rightarrow B$ that vanishes on  $\mathfrak{a}$, there exists an unique $\tilde{f}\in \operatorname{Hom}(A\quotient \mathfrak{a},B)$ that makes the diagram: 
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJBIl0sWzIsMCwiQiJdLFswLDIsIkFcXHF1b3RpZW50IFxcbWF0aGZyYWt7YX0iXSxbMCwxLCJmIl0sWzAsMiwiXFxwaSIsMl0sWzIsMSwiXFx0aWxkZXtmfSIsMl1d
\[\begin{tikzcd}
	A && B \\
	\\
	{A\quotient \mathfrak{a}}
	\arrow["f", from=1-1, to=1-3]
	\arrow["\pi"', from=1-1, to=3-1]
	\arrow["{\tilde{f}}"', from=3-1, to=1-3]
\end{tikzcd}\]
commutes. 
\begin{equiv_def}
\textbf{(First isomorphism theorem for rings)} Let $A$ be a ring and $\mathfrak{a}\subseteq A$. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{a}$ is an ideal in $A$.  
  \item $\mathfrak{a}$ is the kernel of some ring homomorphism. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definition. 
\end{proof}
\begin{theorem}
\textbf{(Second isomorphism theorem for rings)} Let $A$ be a ring,  $B \subseteq A$ a subring, and $\mathfrak{a}\subseteq A$ an ideal. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $B+ \mathfrak{a}\triangleq \set{b+a\in A: b \in B,a \in \mathfrak{a}}$ forms a subring of $A$.  
  \item $B\cap \mathfrak{a}$ forms an ideal in $B$.  
  \item $(B+\mathfrak{a})\quotient \mathfrak{a}\cong B\quotient (B \cap \mathfrak{a})$ as rings.
\end{enumerate}
\end{theorem}
\begin{proof}
Unroll the definitions.  
\end{proof}
One should always be careful with the word \textbf{unit} and the word \textbf{zero-divisor}.\footnote{Note that $0$ is defined to be a zero-divisor. To justify this convention, note that if we allow  $0$ to be a non-zero-divisor, then the total ring of fraction is always the zero ring.}
\begin{theorem}
\label{THunz}
\textbf{(Unit can not be zero-divisors in nonzero ring)} Let $A$ be a ring and $u \in A$ be a unit. If $A=\Z_1$, then $u$ is vacuously a zero-divisor. If $A$ is nonzero, then  $u$ isn't a zero-divisor. 
\end{theorem}
\begin{proof}
Unroll the definitions. 
\end{proof}
Given rings $A \subseteq B$, it is possible that $a \in A$ forms a non-zero-divisor (or unit) in $A$ but not in  $B$. Under our initial requirement that rings are commutative unital, for a nonzero ring $A$ to be an \textbf{integral domain}, we only need all nonzero elements to be non-zero-divisors, and for $A$ to be a  \textbf{field}, we only need all nonzero elements to be units.
\begin{equiv_def}
\label{edF}
\textbf{(Field)} Let $A$ be a nonzero ring. The followings are equivalent:
 \begin{enumerate}[label=(\roman*)]
  \item $A$ is a field.  
  \item $A$ have only two ideals, i.e.,  $\set{0}$ and $A$. 
  \item Every ring homomorphism of $A$ into a nonzero ring  $B$ is injective. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}
We use the term \textbf{proper} to describe strict set inclusion. A \textbf{maximal ideal} is  a proper ideal contained by no other proper ideals. A \textbf{prime ideal} is a proper ideal $\mathfrak{p}$ such that the product of two element lies in $\mathfrak{p}$ implies one of then lies in $\mathfrak{p}$. 
\begin{equiv_def}
\label{edP}
\textbf{(Prime ideals)} Let $\mathfrak{p}\subseteq A$ be an ideal. The followings are equivalent:
\begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{p}$ is prime. 
  \item $A\quotient \mathfrak{p}$ forms an integral domain.  
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}
\begin{equiv_def}
\textbf{(Integral domain)} Let $A$ be a ring. The followings are equivalent: 
 \begin{enumerate}[label=(\roman*)]
  \item $A$ is an integral domain.  
  \item The zero ideal of $A$ is prime. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definitions.
\end{proof}
\begin{theorem}
\label{Tit}\label{ctfr}
\textbf{(Third isomorphism theorem and correspondence theorem for rings)} Let $A$ be a ring, $\mathfrak{a}\subseteq \mathfrak{b} \subseteq A$ be two ideals, $S$ the collection of ideals in $A$ that contains  $\mathfrak{a}$, and $\pi :A \twoheadrightarrow A\quotient \mathfrak{a}$ the quotient map. We denote $\mathfrak{b}\quotient \mathfrak{a}\triangleq \pi  (\mathfrak{a})$. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{b}\quotient \mathfrak{a}\subseteq A\quotient \mathfrak{a}$ forms an ideal.
  \item $(A\quotient \mathfrak{a})\quotient (\mathfrak{b}\quotient \mathfrak{a})\cong A\quotient \mathfrak{b}$ as rings.
  \item The map $\mathfrak{c}\in S \mapsto \mathfrak{c}\quotient \mathfrak{a}$ forms a bijection between $S$ and the collection of ideals in  $A\quotient \mathfrak{a}$, a bijection between $S \cap \operatorname{Spec}A$ and $\operatorname{Spec}(A\quotient \mathfrak{a})$, and a bijection between $S\cap \operatorname{Max}A$ and $\operatorname{Max}(A\quotient \mathfrak{a})$. 
\end{enumerate}
\end{theorem}
\begin{proof}
Unroll the definition. 
\end{proof}
Let $A$ be a ring. Chain of prime ideals $\mathfrak{p}_0\subset \mathfrak{p}_1 \subset \cdots \subset \mathfrak{p}_n$ has \textbf{length} $n$. Given a prime ideal $\mathfrak{p}$, its \textbf{height} $\operatorname{ht}(\mathfrak{p})$ is:
\begin{align*}
\operatorname{ht}(\mathfrak{p})\triangleq \operatorname{sup} \set{n\inz: \mathfrak{p}_0 \subset \mathfrak{p}_1 \subset \cdots \subset \mathfrak{p}_n \subseteq \mathfrak{p}}
\end{align*}
Given an ordinary ideal $\mathfrak{a}$, its  \textbf{height} is: 
\begin{align*}
\operatorname{ht}(\mathfrak{a})\triangleq \operatorname{inf} \set{\operatorname{ht}(\mathfrak{p})\inz : \mathfrak{a}\subseteq\mathfrak{p}\in \operatorname{Spec}A}
\end{align*}
The \textbf{Krull dimension $\operatorname{Krudim}(A)$} of $A$ is: 
\begin{align*}
\operatorname{Krudim}(A)\triangleq \operatorname{sup} \set{\operatorname{ht}(\mathfrak{p}): \mathfrak{p}\in \operatorname{Spec}A}
\end{align*}
\begin{equiv_def}
\textbf{(Krull dimension)} Let $A$ be a ring. The Krull dimension of  $A$ equals to the supremum of the length of chain of prime ideals in  $A$. 
\end{equiv_def}
\begin{proof}

\end{proof}

\begin{equiv_def}
\label{edM}
\textbf{(Maximal ideals)} Let $\mathfrak{m}\subseteq A$ be an ideal. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{m}$ is maximal. 
  \item $A\quotient \mathfrak{m}$ forms a field.
\end{enumerate}
\end{equiv_def}
\begin{proof}
This follows from \customref{Tit}{correspondence theorem for rings} and  \customref{edF}{equivalent definitions of field}. 
\end{proof}
\begin{corollary}
\textbf{(Maximal ideals are prime)} Let $A$ be a ring. If  $\mathfrak{m}\subseteq A$ is maximal, then $\mathfrak{m}$ is prime. 
\end{corollary}
\begin{proof}
This follows from \customref{edP}{equivalent definition of prime ideals} and  \customref{edM}{equivalent definition of maximal ideals}. 
\end{proof}
Intersection of ideals clearly always form an ideal. We now introduce a key property of prime ideals: 
\begin{theorem}
\label{Pop}
\textbf{(Property of prime ideal)} 
\begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{a}\subseteq \mathfrak{p}_1 \cup  \cdots \cup  \mathfrak{p}_n\implies \mathfrak{a} \subseteq \mathfrak{p}_i$ for some $i$.  
  \item $\mathfrak{a}_1 \cap  \cdots \cap  \mathfrak{a}_n \subseteq \mathfrak{p} \implies \mathfrak{a}_i \subseteq \mathfrak{p}$ for some $i$. 
  \item $\mathfrak{a}_1\cap \cdots \cap \mathfrak{a}_n=\mathfrak{p}\implies \mathfrak{a}_i =\mathfrak{p}$ for some $i$. 

\end{enumerate}
\end{theorem}
\begin{proof}
  (i) is proved by induction. Assume not and cause a contradiction by considering $\sum (x_1\cdots \widehat{x}_i\cdots x_n)$ where $x_i \in \mathfrak{a}-\mathfrak{p}_i$. For (ii), assume not, and cause a contradiction by considering $\prod a_i$ where $a_i \in \mathfrak{a}_i-\mathfrak{p}$. (iii) follows from (ii). 
\end{proof}
For all subsets $S$ of some ring $A$, the ideal $\langle S\rangle $ \textbf{generated} by $S$ is the smallest ideals that contain $S$. 
 \begin{equiv_def}
\textbf{(Generated ideals)} Let $A$ be a ring and  $S\subseteq A$. We have: 
\begin{align*}
\langle S\rangle = \set{\sum_{\text{finite}}a_is_i \in A: a_i \in A,s_i \in S}
\end{align*}
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}
A \textbf{principal ideal} $\langle x\rangle $ is an ideal generated by a single element. There are many ideals operations. Given any family of ideal $(\mathfrak{a}_i)$ in $A$, their \textbf{sum ideal} is:
\begin{align*}
\sum \mathfrak{a}_i \triangleq \set{\sum_{\text{finite}} a_i\in A: a_i \in \mathfrak{a}_i}
\end{align*}
\begin{equiv_def}
\label{Soi}
\textbf{(Sum of ideals)} Let $A$ be a ring and  $\set{\mathfrak{a}_i : i \in I}$ a family of ideals in $A$. Then: 
\begin{align*}
\sum_{i\in I}\mathfrak{a}_i= \left\langle \bigcup_{i \in I} \mathfrak{a}_i\right\rangle = \bigcup_{\substack{J \subseteq I\\ J\text{ finite }}} \sum_{j \in J} \mathfrak{a}_j
\end{align*}
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}
\begin{theorem}
\textbf{(Expressing image of ideals in quotient ring using ideals sum)}  Let $A$ be a ring, $\mathfrak{a},\mathfrak{b}$ be two ideals in $A$, and $\pi : A \twoheadrightarrow A \quotient \mathfrak{a}$ be the quotient map. We always have:
\begin{align*}
\pi  (\mathfrak{b})= \mathfrak{a}+ \mathfrak{b}\quotient \mathfrak{a}
\end{align*}
\end{theorem}
\begin{proof}
Unroll the definitions. 
\end{proof}



Given any finite family $\mathfrak{a}_1,\dots ,\mathfrak{a}_n$ of ideals in $A$, their  \textbf{product ideal} is: 
\begin{align*}
\prod_{i=1}^n \mathfrak{a}_i \triangleq \set{ \sum_{j=1}^m a_{j,1}\cdots a_{j,n} \in A: a_{j,i}\in \mathfrak{a}_i}
\end{align*}
\begin{equiv_def}
\textbf{(Product of ideals)} Let $A$ be a ring and $\set{\mathfrak{a}_1,\dots ,\mathfrak{a}_n}$ a finite family of ideals in $A$. The product ideal  $(\mathfrak{a}_1\cdots \mathfrak{a}_n)$ is generated by  $\set{a_1\cdots a_n\in A:a_i \in\mathfrak{a}_i}$. 
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}
One should check that both the definitions of sum and product for ideals are consistent in the sense that they indeed are both  associative. Moreover, we have the distributive law: 
\begin{align*}
  (\mathfrak{a}+\mathfrak{b})\mathfrak{c}=\mathfrak{a}\mathfrak{c}+\mathfrak{b}\mathfrak{c}
\end{align*}
Given two ideals $\mathfrak{a},\mathfrak{b}$ in $A$, their  \textbf{quotient ideal} $(\mathfrak{a}:\mathfrak{b})$ is:
\begin{align*}
  (\mathfrak{a}:\mathfrak{b})\triangleq \set{ x\in A: xb \in \mathfrak{a},\quad  \text{ for all }b \in \mathfrak{b}}
\end{align*}
To simplify matter, we write $(\mathfrak{a}:x)$ instead of $(\mathfrak{a}:\langle x\rangle )$. This notation is justified since $(\mathfrak{a}:\langle x\rangle )=\set{y \in A: xy \in \mathfrak{a}}$. The \textbf{Jacobson radical} $\operatorname{Jacob}(A)$ is the intersection of all maximal ideals of $A$. An element $x \in A$ is called \textbf{nilpotent} if $x^n=0$ for some  $n\inn$. The set of all nilpotent elements clearly form an ideal $\operatorname{Nil}(A)$ in $A$, which is the \textbf{nilradical} of $A$. 
\begin{theorem}
\label{EDfN}
\textbf{(Equivalent Definition for Nilradical)} Let $A$ be a ring. We have:
\begin{align*}
\operatorname{Nil}(A)=\bigcap \operatorname{Spec} A
\end{align*}
\end{theorem}
\begin{proof}
$\operatorname{Nil}(A)\subseteq \bigcap \operatorname{Spec}A$ is clear. Assume $x \in \bigcap \operatorname{Spec}A -  \operatorname{Nil}(A)$ for a contradiction. Let $\Sigma$ be the set of ideals $\mathfrak{a}$ such that $x^n\not\in \mathfrak{a}$ for all $n>0$. Because unions of chains in $\Sigma$ belong to $\Sigma$ and because $0 \in \Sigma$, by Zorn's Lemma, there exists some maximal element $\mathfrak{a} \in \Sigma$. Because $x\not \in \mathfrak{a}$, to close out the proof, we only have to show $\mathfrak{a}$ is prime.\\

Let $yz \in \mathfrak{a}$. Assume for a contradiction that $y\not\in \mathfrak{a}$ and $z\not\in \mathfrak{a}$. By maximality of $\mathfrak{a}$, both  $\mathfrak{a}+ \langle y\rangle,\mathfrak{a}+\langle z\rangle$ don't belong to $\Sigma$. This implies $x^n \in \mathfrak{a}+ \langle y\rangle$ and $x^m \in \mathfrak{a} + \langle z\rangle $ for some $n,m>0$, which cause a contradiction to $\mathfrak{a} \in \Sigma$, since $x^{n+m} \in \mathfrak{a} + \langle yz\rangle =\mathfrak{a}$. 
\end{proof}
Let $\mathfrak{a}$ be an ideal of the ring $A$. Its  \textbf{radical} $\sqrt{\mathfrak{a}}$ in $A$ is: 
\begin{align*}
\sqrt{\mathfrak{a}}\triangleq \set{ x \in A : x^n \in \mathfrak{a} \text{ for some } n > 0 }
\end{align*}
\begin{equiv_def}
\label{Roi}
\textbf{(Radical of ideal)} Let $A$ be a ring and $\mathfrak{a}\subseteq A$ an ideal. The following are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $\sqrt{\mathfrak{a}}$. 
  \item $\set{x \in A: x^n \in \mathfrak{a}\text{ for }n\gg  0 }$. 
  \item The ideal in $A$ that \customref{ctfr}{correspond} to $\operatorname{Nil}(A\quotient \mathfrak{a})$ with respect to quotient map $A \twoheadrightarrow A\quotient \mathfrak{a}$. 
  \item The intersection of all prime ideals in $A$ that contains  $\mathfrak{a}$. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
  (i) $=$ (ii) $=$  (iii): Unroll the definition.  (ii) $=$ (iii): Consider the \customref{ctfr}{correspondence theorem} and \customref{EDfN}{$\operatorname{Nil}(A \quotient \mathfrak{a})= \bigcap \operatorname{Spec} A \quotient \mathfrak{a}$}. 
\end{proof}
Let  $A$ be a ring and $\mathfrak{a} \subseteq A$ be an ideal. A \textbf{minimal prime ideal $\mathfrak{p}$ over} $\mathfrak{a}$ is a prime ideal minimal among all prime ideals that contain $\mathfrak{a}$. Because of the \customref{Roi}{third definition of radical}, $\mathfrak{a}$ and $\sqrt{\mathfrak{a}}$ share same set of minimal prime ideal. It should be noted that there is a "less is more" philosophy in our wording and notations for product, quotient and radical of ideals. For any ideal $\mathfrak{a},\mathfrak{b}$, we have 
 \begin{align*}
\mathfrak{a}\mathfrak{b} \subseteq \mathfrak{a} \subseteq \sqrt{\mathfrak{a}}  \text{ and }\mathfrak{a} \subseteq (\mathfrak{a}:\mathfrak{b})
\end{align*}
Let  $A$ be a ring. A \textbf{radical ideal} $\mathfrak{a}$ in $A$ satisfies  $\sqrt{\mathfrak{a}}= \mathfrak{a}$. 
\begin{equiv_def}
\label{EDRi}
\textbf{(Radical ideals)} Let  $A$ be a ring and  $\mathfrak{a}\subseteq A$ be an ideal. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{a}$ is radical. 
  \item $\mathfrak{a}=\sqrt{\mathfrak{b}}$ for some ideal $\mathfrak{b} \subseteq A$. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
  (i)$\implies $(ii) is trivial. (ii)$\implies $(i) is done by unrolling the definitions, which give us $\sqrt{\sqrt{\mathfrak{b}} }=\sqrt{\mathfrak{b}}$. 
\end{proof}
For ease in the section on fraction of rings and modules, we close this section by introducing two concept. Let $f:A\rightarrow B$ be some ring homomorphism. If $E$ is a subset of $A$, we call the ideal in  $B$ generated by $f(E)$ the \textbf{extension} of $E$, which we denote by  $E^e$. If  $E$ is a subset of  $B$, we call the ideal in  $A$ generated by  $f^{-1}(E)$ the \textbf{contraction} of $E$, which we denote by $E^c$. Clearly, if  $E$ is an ideal in $B$, then $E^c=f^{-1}(E)$. 
\section{Modules and Algebra}
Let $A$ be some ring. By an $A$-\textbf{module}, we mean an abelian group $M$ together with a compatible $A$-scalar multiplication. An $A$\textbf{-module homomorphism}  $f:M\rightarrow N$ is a function that respect addition\footnote{Respecting addition immediately implies respecting $0$ and negation.}, multiplication, and multiplicative identity. Note that every ring form a module over itself, and there is one-to-one correspondence between ideals and submodules when we do such. \\

Let $N$ be a submodule of $A$-module  $M$. \textbf{Quotient $A$-module} is an $A$-module $M\quotient N$ together with a surjective $A$-module homomorphism $\pi : M \rightarrow M \quotient N$ that satisfies the \textbf{universal property of quotient module}: For each $A$-module homomorphism  $f:M\rightarrow L$ that vanishes on $N$, there exists a unique $A$-module homomorphism  $\tilde{f}:M\quotient N\rightarrow L$ that makes the diagram:
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJBIl0sWzIsMCwiQiJdLFswLDIsIkFcXHF1b3RpZW50IFxcbWF0aGZyYWt7YX0iXSxbMCwxLCJmIl0sWzAsMiwiXFxwaSIsMl0sWzIsMSwiXFx0aWxkZXtmfSIsMl1d
\[\begin{tikzcd}
	M && L \\
	\\
	{M\quotient N}
	\arrow["f", from=1-1, to=1-3]
	\arrow["\pi"', from=1-1, to=3-1]
	\arrow["{\tilde{f}}"', from=3-1, to=1-3]
\end{tikzcd}\]
commutes. 
\begin{equiv_def}
\label{Fitfm}
\textbf{(First isomorphism theorem for modules)} Let $N$ be a subset of an $A$-module $M$. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $N$ is an $A$-submodule of  $M$.   
  \item $N$ is the kernel of some $A$-module homomorphism. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definition. 
\end{proof}
\begin{theorem}
\textbf{(Second isomorphism theorem for modules)} Let $N,T$ be two $A$-submodules of  $M$. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $N+T\triangleq \set{x+y\in M: x \in N,y \in T}$ forms an $A$-submodule.  
  \item $N\cap T$ forms an $A$-submodule.  
  \item $(N+T)\quotient T\cong N\quotient (N \cap T)$ as $A$-modules.
\end{enumerate}
\end{theorem}
\begin{proof}
Unroll the definitions.  
\end{proof}

\begin{theorem}
\label{Titctfm}
\textbf{(Third isomorphism theorem and correspondence theorem for modules)} Let $M$ be an $A$-module,  $T\subseteq N \subseteq M$ be two $A$-submodules,  $S$ the collection of submodules of $M$ that contains  $T$, and  $\pi : M \twoheadrightarrow M \quotient T$ the quotient map. Then:   
\begin{enumerate}[label=(\roman*)]
  \item $\pi  (N)$ forms a submodule isomorphic to $N\quotient T$, which shall be how we identify $N\quotient T$ as a submodule of $M\quotient T$.  
  \item $(M \quotient T)\quotient  (N \quotient T)\cong M \quotient N$ as $A$-modules.  
  \item The map $G \in S \mapsto G \quotient T$ forms a bijection between  $S$ and the collection of submodules of $M\quotient T$. 
\end{enumerate}

\end{theorem}
\begin{proof}
Unroll the definition. 
\end{proof}
Let $\set{M_i:i \in I}$ be a collection of $A$-modules. If we give the Cartesian product $\prod M_i$ the obvious addition and multiplication, then we say it is the \textbf{direct product}. It is clear that 
\begin{align*}
\bset{(x_i)_{i \in I} \in \prod_{i \in I}M_i:x_i \neq 0\text{ for finitely many }i.}
\end{align*}
forms a submodule of the direct product. We denote this submodule by $\bigoplus M_i$, and call it the  \textbf{direct sum}.  Obviously, if the index set $I$ is finite, then the direct product and direct sum are identical. Given a subset $S$ of $A$-module $M$, its \textbf{span} is the smallest $A$-submodule of $M$ that contains  $S$. 
\begin{equiv_def}
\textbf{(Spanned modules)} Let $M$ be an  $A$-module and  $S \subseteq M$. We have: 
\begin{align*}
\operatorname{span}(S)= \set{\sum_{\text{finite}} a_is_i \in M : a_i \in A,s_i \in S}
\end{align*}
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}
We say an $A$-module  is \textbf{finitely generated} if it can be spanned by some of its finite subset.  
\begin{theorem}
\textbf{(Property of finitely generated modules)} Let $M$ be an $A$-module spanned by $\set{x_1,\dots ,x_n}$. $M$ is isomorphic to some quotient modules of $A^n$.\footnote{Albeit seems quite arbitrary and unimportant for now, this property will later prove useful for it guarantees that finitely generated module over rings of some certain properties carry the same property. For example, this shows that \customref{cpoN}{finitely generated module over Noetherian ring is Noetherian}.} 
\end{theorem}
\begin{proof}
Clearly, $(a_1,\dots ,a_n)\mapsto \sum a_ix_i$ forms a surjective $A$-module homomorphism from $A^n$ to  $M$. The rest of the proof then follows from  \customref{Fitfm}{first isomorphism theorem for modules}. 
\end{proof}



Quite often, we are required to consider \textbf{extension of scalars}: Given ring homomorphism $f:A\rightarrow B$ and $B$-module  $N$, we can give $N$ an $A$-module by setting $an\triangleq f(a)n$.
\begin{theorem}
\label{Fgas}
\textbf{(Finite generation and scalar extension)} Given ring homomorphism $f:A\rightarrow B$ and some finitely generated $B$-module  $N$, if $B$ is finitely generated as an  $A$-module under extension of scalar, then $N$ is also finitely generated as an  $A$-module under extension of scalar.\footnote{This will be later used in \customref{Id}{section on integral dependence}. }
\end{theorem}
\begin{proof}
If $b_1,\dots ,b_k$ generate $B$ over $A$ and  $n_1,\dots ,n_r$ generate $N$ over  $B$, then clearly $\set{b_i n_j \in N: i \in \set{1,\dots ,k} \text{ and } j\in \set{1,\dots ,r}}$ generates $N$ over $A$. 
\end{proof}
Given an ideal $\mathfrak{a}$ of $A$, an  $A$-module $M$ and an $A$-submodule  $N\subseteq M$, the \textbf{product $\mathfrak{a}N$ of the submodule $N$ by the ideal $\mathfrak{a}$} is the $A$-submodule: 
\begin{align*}
\mathfrak{a}N \triangleq \set{\sum_{\text{finite}}a_ix_i \in M: a_i \in \mathfrak{a}\text{ and }x_i \in N}
\end{align*}
We may now state  \customref{Nakayama}{Nakyama's Lemma}. 
\begin{lemma}
\label{Nakayama}
\textbf{(Nakayama)} Let $M$ be a finitely generated  $A$-module. If there exists some ideal $\mathfrak{a}\subseteq A$ contained by $\operatorname{Jacob}(A)$ that makes $\mathfrak{a}M=M$, then $M=0$. 
\end{lemma}
\begin{proof}
Assume for a contradiction that $M\neq 0$. Let $u_1,\dots ,u_n$ be a minimal set of generators of $M$. Write $u_n=a_1u_1+\cdots + a_n  u_n$ where $a_i \in \mathfrak{a}$. This give us 
\begin{align}
\label{1anun}
  (1-a_n) u_n= a_1u_1+\cdots + a_{n-1}u_{n-1}
\end{align}
We know that $1-a_n$ must be a unit, otherwise by Zorn's Lemma\footnote{Note that union of proper ideals is always proper because otherwise one of them would have contain $1$.} there exists a maximal ideal $\mathfrak{m}$ containing  $1-a_n$, which is impossible since  $a_n \in \operatorname{Jacob}(A)$ would have implies $1 \in \mathfrak{m}$. Because $1-a_n$ is a unit, by \myref{Equation}{1anun}, $u_n$ can be generated by  $\set{u_1,\dots ,u_{n-1}}$, a contradiction to the minimality of $\set{u_1,\dots ,u_n}$. 
\end{proof}
Given two $A$-submodules  $N,P$ of $M$, their \textbf{quotient} $(N:P)$ is the collection of $a \in A$ that maps $P$ into  $N$, which clearly need to be an ideal in $A$. In particular, the \textbf{annihilator $\operatorname{Ann}(M)$ of $M$}  is $(0:M)$. Clearly, if $\mathfrak{a} \subseteq \operatorname{Ann}(M)$, we may view $M$ as an $A\quotient \mathfrak{a}$-module. We say $M$ is a  \textbf{faithful $A$-module} if $\operatorname{Ann}(M)=0$.
\begin{equiv_def}
\textbf{(Faithful modules)} Let $M$ be an  $A$-module. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $M$  is faithful. 
  \item For each $a\neq b\in A$, there exists $x\in M$ such that $ax\neq bx$. 
  \item Each $a \in A$ defines a unique endomorphism of $M$. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}
Let $M$ be an  $A$-module, clearly  $M$ is always faithful as an  $A\quotient \operatorname{Ann}(M)$-module, and $A$ is always faithful as an  $A$-module. An \textbf{exact} sequence of $A$-modules is a sequence of $A$-modules whose every image equals to kernel of the next $A$-module homomorphism. Let $A$ be a ring, $\mathfrak{C}$ a subcategory of $A$-modules, and $G$ an abelian group. A function  $\ld : \mathfrak{C}\rightarrow G$ is said to be \textbf{additive} if for each short exact sequence $0\rightarrow M'\rightarrow M\rightarrow M''\rightarrow 0$ in $\mathfrak{C}$, we have $\ld (M)=\ld (M')+\ld (M'')$. 
\begin{theorem}
\label{Eod}
\textbf{(Examples of additive functions)} The followings are examples of additive functions:
\begin{enumerate}[label=(\roman*)]
  \item Let $A$ be a field. The map $V\mapsto  \operatorname{dim}V$ is an additive function on the category of finite-dimensional vector space with codomain $\Z$. 
\end{enumerate}
\end{theorem}
\begin{proof}
  (i): Unroll the definition with rank-nullity theorem. 
\end{proof}
There are multiple equivalent definitions for the term \textbf{algebra $B$ over ring $A$}. The easiest one is to say we have a ring homomorphism $f:A\rightarrow B$, which induces the scalar product: $a(b)\triangleq f(a)b$. Let $B,C$ be two  $A$-algebras with scalar defining map $f,g$. By an \textbf{$A$-algebra homomorphism}, we mean some ring homomorphism $h:B\rightarrow C$ that is also a $A$-module homomorphism. 
\begin{equiv_def}
\textbf{(Algebra homomorphisms)} Let $B,C$ be two  $A$-algebras with scalar defining map $f,g$, and $h:B\rightarrow C$ be a ring homomorphism. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $h$ is an $A$-algebra homomorphism.  
  \item $h\circ f=g$. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}
Let $B$ be an  $A$-algebra.  $B$ is \textbf{finitely generated as an $A$-algebra} if $B=A[x_1,\dots ,x_n]$ for some $\set{x_1,\dots ,x_n}\subseteq B$. Because there are three structures on $B$, one shall again be careful with the wording. 
\section{Tensor product for modules and algebras}
Let $R$ be some ring. By \textbf{free $R$-modules}, we mean $R$-modules of the form $\bigoplus_{i \in I}M_i$ where $M_i \cong R$. We denote the free module $\bigoplus_{i \in I}M_i$ by $R^{(I)}$. Given a finite collection $\set{M_1,\dots ,M_n}$ of $R$-modules, by the term \textbf{tensor product space}, we mean a $R$-module denoted by $\bigotimes M_i$ and a $R$-multilinear map $\otimes : \prod M_i \rightarrow \bigotimes M_i$ that satisfies the \textbf{universal property}: For each multilinear map $f:\prod M_i \rightarrow P$, there exists unique linear map $\tilde{f}:\bigotimes M_i \rightarrow P$ such that the diagram 
% https://q.uiver.app/#q=WzAsMyxbMiwyLCJOIl0sWzAsMCwiXFxwcm9kIE1faSJdLFsyLDAsIlxcb3RpbWVzIE1faSJdLFsxLDIsIlxcb3RpbWVzIl0sWzEsMCwiZiIsMl0sWzIsMCwiZiIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	{\prod M_i} && {\bigotimes   M_i} \\
	\\
	&& P 
	\arrow["\otimes ", from=1-1, to=1-3]
	\arrow["f"', from=1-1, to=3-3]
	\arrow["\tilde{f} ", dashed, from=1-3, to=3-3]
\end{tikzcd}\]
commutes. This definition is unique up to isomorphism: If $\bigotimes 'M_i$ is also a tensor product, then there exists some module isomorphism from $\bigotimes  M_i$ to $\bigotimes  'M_i$ that sends $m_1 \otimes  \cdots \otimes  m_n$ to $m_1 \otimes  ' \cdots \otimes  ' m_n$. One common construction of the tensor product space is to quotient the free module $R^{(\prod M_i)}$ with the submodule spanned by the set:
\begin{align*}
  \bigcup_{i=1}^n &\Big[\bset{(x_1,\dots, rx_i ,\dots, x_n)-r(x_1,\dots ,x_n)}\\
 & \cup \bset{(x_1,\dots ,x_i +x_i',\dots  ,x_n)- (x_1,\dots ,x_i,\dots  ,x_n)-(x_1,\dots ,x_i',\dots ,x_n)}  \Big]
\end{align*}
Denoting this spanned submodule by $D$, our tensor product space $\bigotimes M_i$ is now $R^{(\prod M_i)}\quotient D$, and because of the forms of the generators of $D$, the tensor product map $\otimes  :\prod M_i \rightarrow \bigotimes  M_i$ defined by 
\begin{align*}
x_1\otimes  \cdots \otimes  x_n \triangleq [(x_1,\dots ,x_n)] 
\end{align*}
is clearly multilinear. Because free module $R^{(\prod M_i)}$ is a direct sum, it is clear that $\bigotimes M_i$ is generated by the \textbf{basic elements}\footnote{Elements of the form $x_1\otimes  \cdots \otimes  x_n$}, and because of such, for every multilinear map $f:\prod M_i \rightarrow P$, the induced map $\tilde{f}: \bigotimes M_i \rightarrow P$ must be unique. To actually induce $\tilde{f}$, one first extend $f$ to the whole free module $\overline{f}:R^{(\prod M_i)}\rightarrow P$ by setting $\overline{f}(\sum r (x_1,\dots ,x_n))\triangleq \sum rf(x_1,\dots ,x_n)$, and see that because $\overline{f}$ vanishes on the generators of $D$, we may induce some mapping from $\bigotimes M_i$ to $P$ that clearly has the desired action of $\tilde{f}$ on the basic elements. \\

Note that the \textbf{tensor-horn adjunction} isomorphism 
\begin{align*}
\operatorname{Hom}(M\otimes N,P) \cong  \operatorname{Hom}(M,\operatorname{Hom}(N,P))
\end{align*}
maps $f \in \operatorname{Hom}(M\otimes N,P)$ to   $\tilde{f}\in \operatorname{Hom}(M,\operatorname{Hom}(N,P))$ with the action
\begin{align*}
  \tilde{f}(m)n\triangleq f(m\otimes n)
\end{align*}
\section{Localization}
\label{Lalr}
Let $A$ be a ring. We say  $S\subseteq A$ is a \textbf{multiplicatively closed subset} of $A$ if  $S$ contains $1$ and is closed under multiplication. We say a ring $B$ and a homomorphism $f:A\rightarrow B$ satisfies the \textbf{universal property of localization of $A$ by $S$} if
\begin{enumerate}[label=(\alph*)]
  \item $f(S) \subseteq B^{\times}$. 
  \item $f(a)=0\implies as=0$  for some $s \in S$. 
  \item $B= \set{f(a)f(s)^{-1}: a \in A\text{ and }  s \in S}$
\end{enumerate}
Suppose $f:A\rightarrow B$ satisfies the universal property of localization of $A$ by  $S$. Clearly, given any ring homomorphism $g:A\rightarrow C$ that maps $S$ into  $C^{\times}$, the ring homomorphism $\tilde{g}:B\rightarrow C$ well-defined by $\tilde{g}(f(a)f(s)^{-1})\triangleq g(a)g(s)^{-1} $ is the unique ring homomorphism such that the diagram
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJBIl0sWzIsMCwiQiJdLFsyLDIsIkMiXSxbMCwyLCJnIiwyXSxbMCwxLCJmIl0sWzEsMiwiXFx0aWxkZXtmfSIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	A && B \\
	\\
	&& C
	\arrow["f", from=1-1, to=1-3]
	\arrow["g"', from=1-1, to=3-3]
	\arrow["{\tilde{g}}", dashed, from=1-3, to=3-3]
\end{tikzcd}\]
commutes.\footnote{ Just like the universal properties for other mathematical objects, one many check that if  $A\overset{f'}{\longrightarrow }B'$ also satisfies the universal property of localization of $A$ by $S$, then $B \cong B'$, and the proof is exactly the same as the ones for other mathematical objects.} By \textbf{localization of $A$ by $S$}, we merely mean some $A\overset{f}{\longrightarrow }B$ that satisfies the universal property of localization of $A$ by  $S$. Moreover, we always use the notation  $S^{-1}A$ to denote $B$, and refer to $f$ as the \textbf{canonical ring homomorphism}. Adopting the convention of denoting $f(a)f(s)^{-1} \in S^{-1}A$ by $\frac{a}{s}$, we see that we have the intuitive:
\begin{align*}
 \frac{a}{s}+ \frac{b}{t}= \frac{at+bs}{st} \text{ and } \frac{a}{s}\cdot \frac{b}{t}=\frac{ab}{st}
\end{align*}
and by universal property 
\begin{align*}
\frac{a}{s}= \frac{a'}{s'} \iff  (as'-a's)s''=0\text{ for some }s'' \in S. 
\end{align*}
\begin{equiv_def}
\label{EDla}
\textbf{(Localization as ring extension)} Let $A$ be a ring, $S \subseteq A$ a multiplicatively closed subset, and $j: A \rightarrow S^{-1}A$ the canonical ring homomorphism. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $S$ consists of only non-zero-divisors. 
  \item $j:A\rightarrow S^{-1}A$ is injective.
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definitions.
\end{proof}
\begin{equiv_def}
\textbf{(Height of prime ideals)} Let $A$ be a ring and  $\mathfrak{p}\in \operatorname{Spec}A$. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $\operatorname{ht}(\mathfrak{p})$. 
  \item $\operatorname{Krudim}(A_{\mathfrak{p}})$
\end{enumerate}
\end{equiv_def}
\begin{proof}

\end{proof}
Just as our fraction notation suggest, if $T\subseteq S$ is another multiplicatively closed subset of $A$, then clearly the canonical ring homomorphism $A\longrightarrow S^{-1}A$ maps $T$ into  $(S^{-1}A)^{\times}$. This by universal property implies the existence and uniqueness of a ring homomorphism from $T^{-1}A$ to $S^{-1}A$ that forms a commutative triangle with the two canonical ring homomorphism. This ring homomorphism have the obvious action, and will be how we are going to identify $T^{-1}A $ as a subring of $S^{-1}A$\footnote{One may check that this ring homomorphism is indeed injective.}. Similarly, given $A \longhookrightarrow B$, universal property implies the existence and uniqueness of a ring homomorphism from $S^{-1}A$ to $S^{-1}B$ that forms a commutative triangle with $A\longrightarrow S^{-1}A$ and the composited $A \longhookrightarrow B \longrightarrow S^{-1}B$, which have the obvious action and will be how we are going to identify $S^{-1}A$ as a subring of $S^{-1}B$.\\


There are even more reason to adopt the fractional notation for localizations: observe 
\begin{enumerate}[label=(\roman*)]
  \item $S^{-1}A=0$ if $0 \in S$, aligning with our intuition that $0$ can never be a denominator. 
  \item $(\set{1})^{-1}A\cong  A$. 
  \item $as^{-1} \in S^{-1}A$ is a unit in $S^{-1}A$ if and only if $a \in S$. 
\end{enumerate}


Let $A$ be a ring, and let $S \subseteq A$ be a multiplicatively closed subset that contains no zero-divisors. Clearly, in $S^{-1}A$, 
\begin{align*}
\frac{a}{s}=\frac{b}{t}\text{ if and only if }at=bs. 
\end{align*}
This implies that the canonical ring homomorphism $A \longrightarrow  S^{-1}A$ is injective, which is how we are going to identify $A$ as a subring of $S^{-1}A$. Using the universal property, we see that the  \textbf{field of fraction} $\operatorname{Frac}(D)\triangleq (D^*)^{-1}D$ is the smallest field that contains a subring isomorphic to $D$. 
\begin{theorem}
\label{THlid}
\textbf{(Localizations of integral domain at prime share the same fraction field)} Let $A$ be an integral domain. Then:
\begin{enumerate}[label=(\roman*)]
  \item For all $\mathfrak{p}\in \operatorname{Spec}A$, we have $\operatorname{Frac}(A_{\mathfrak{p}})=\operatorname{Frac}(A)$. 
\end{enumerate}
\end{theorem}
\begin{proof}
\end{proof}
Let $A$ be a ring. The \textbf{total ring of fraction} is the ring $S^{-1}A$, where   $S\subseteq A$ is the of non-zero-divisors. \\


Let $A$ be some ring,  $S\subseteq A$ an multiplicatively closed subset, and $M$ an  $A$-module. By the \textbf{localization of $M$ by  $S$}, we mean an $A$-module $S^{-1}M$ and a canonical $A$-module homomorphism $M\overset{j}{\longrightarrow } S^{-1}M$ that satisfies the \textbf{universal property for localization of $M$ by  $S$}: 
\begin{enumerate}[label=(\alph*)]
  \item Every $s \in S$ acts invertibly on $S^{-1}M$. 
  \item For any $A$-module $N$ on which all $s \in S$ acts invertibly and any $A$-module homomorphism $M\overset{g}{\longrightarrow } N$, there exists a unique $A$-module homomorphism $\tilde{g} $ such that the diagram 
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJBIl0sWzIsMCwiQiJdLFsyLDIsIkMiXSxbMCwyLCJnIiwyXSxbMCwxLCJmIl0sWzEsMiwiXFx0aWxkZXtmfSIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	M && S^{-1}M \\
	\\
	&& N
	\arrow["j", from=1-1, to=1-3]
	\arrow["g"', from=1-1, to=3-3]
	\arrow["{\tilde{g}}", dashed, from=1-3, to=3-3]
\end{tikzcd}\]
commutes.
\end{enumerate}
Just like localization of ring, we adopt the fractional notation $y\triangleq \frac{m}{s}$ for $sy=j(m)$, which give us the intuitive: 
\begin{align*}
\frac{m}{s}+ \frac{n}{t}= \frac{mt+ns}{st}\text{ and } a \cdot \frac{m}{s}
\end{align*}
and also by universal property: 
\begin{align*}
\frac{m}{s}= \frac{m'}{s'}\iff (ms'-m's)s''=0\text{ for some }s'' \in S. 
\end{align*}
Again, if $T \subseteq S$ is another multiplicatively closed subset of $A$, if there exists injective ring homomorphism $A \longhookrightarrow B$, and if there exists $A$-submodule $N \subseteq M$, then the obvious action is what the universal property will induce, thus being how we identify one as subsets of another.\\ 

Contrary to ring localization, there is one more thing to note about localization of module. Given some $A$-module $N$ on which all  $s \in S$ act invertibly, we may give $N$ the \textbf{canonical}  $S^{-1}A$-module structure\footnote{It is the obvious one.}, and this is how we are going to view $S^{-1}M$ as an $S^{-1}A$-module. Also, given an $A$-module homomorphism  $M \overset{f}{\longrightarrow }N$, one may check that the unique $A$-module homomorphism $S^{-1}f$ from $S^{-1}M$ to $S^{-1}N$ that  forms a commutative triangle with $M\longrightarrow S^{-1}M$ and $M \overset{f}{\longrightarrow }N \longrightarrow S^{-1}N$ have the action $\frac{a}{s}\mapsto \frac{f(a)}{s}$, and is thus also an $S^{-1}A$-module homomorphism. Note that we have the result:
\begin{align*}
M' \overset{f}{\longrightarrow } M \overset{g}{\longrightarrow }M '' \implies S^{-1}(g \circ f)=S^{-1}g \circ S^{-1}f
\end{align*}
where the left hand side diagram happens in the category of $A$-module. In other words, localization forms a functor. 
\begin{theorem}
\textbf{(Localization is an exact functor)} If 
\begin{align*}
M' \overset{f}{\longrightarrow }M \overset{g}{\longrightarrow }M''
\end{align*}
is exact, then 
\begin{align*}
S^{-1}M' \xrightarrow {S^{-1}f} S^{-1}M \xrightarrow{S^{-1}g}  S^{-1}M''
\end{align*}
is also exact. 
\end{theorem}
\begin{proof}
Clearly, we only have to prove $\operatorname{Ker}(S^{-1}g) \subseteq \operatorname{Ker}(S^{-1}f)$. Suppose $\frac{m}{s} \in \operatorname{Ker}(S^{-1}g)$. We have $tg(m)=0$ for some $t \in S$. This implies $tm \in \operatorname{Ker}g= \operatorname{Im}f$. Suppose $f(m')=tm$. This now give us $\frac{m}{s}= S^{-1}f(\frac{m'}{st})$. 
\end{proof}



If $f\in A$, we often write $A_f$ in place of $(\set{f^n:n\geq 0})^{-1}A$, and if $\mathfrak{p}$ is a prime ideal of  $A$, we often just call  $A_\mathfrak{p}\triangleq (A\setminus \mathfrak{p})^{-1}A$ the \textbf{localization of $A$ at $\mathfrak{p}$}. Clearly, every nontrivial localizations of integral domain $A$, even not at primes, are still integral domain, so it make sense to talk the fraction field of $S^{-1}A$. Moreover, a routine, long, and tedious proof from universal property, shows that the obvious map from $\operatorname{Frac}(S^{-1}A)$ to $\operatorname{Frac}(A)$ is an isomorphism, so we usually treat $S^{-1}A$ as a subring of $\operatorname{Frac}(A)$ containing $A$. In fact, one have $A=\bigcap A_\mathfrak{m}$ where $\mathfrak{m}$ runs over all maximal ideals of $A$\footnote{Because if $s \in A$ is not in any maximal ideal of $A$, then  $s$ must be a unit.}. \label{sam} \\


A \textbf{local ring} is a ring that has only one maximal ideal.  
\begin{equiv_def}
\textbf{(Local rings)} Let $A$ be a ring. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $A$ is a local ring.  
  \item $A$ is the localization of some ring  $B$ at some  $\mathfrak{p}\in \operatorname{Spec}B$. 
  \item Its set of non-units form an ideal. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
  (i)$\implies $(ii): Check that $B\triangleq A$ and $\mathfrak{p}\triangleq \mathfrak{m}$ suffice. (ii)$\implies $(iii): Because $\mathfrak{p}$ is prime, we see that the set of non-units in $B_\mathfrak{p}$ is exactly $\set{b\quotient s \in B_\mathfrak{p}: b \in \mathfrak{p}}$. This set forms an ideal as one can check. (iii)$\implies $(i): The proof follows from noting that any ideal that contains some unit contains the whole ring. 
\end{proof}
One of the key property of local ring $A$ is that if we let $\mathfrak{m}$ be its unique maximal ideal, then the quotient $A$-module  $\mathfrak{m}\quotient \mathfrak{m}^2$ forms a $A\quotient \mathfrak{m}$-vector space, called the \textbf{cotangent space of} $A$, with the obvious assignment of scalar product.  If $A$ is local, we often write  $(A,\mathfrak{m},k)$ to mean that $\mathfrak{m}$ is the unique maximal ideal of $A$ and  $k$ the residue field  $k\triangleq A\quotient \mathfrak{m}$. A \textbf{local ring homomorphism} is a ring homomorphism $f:(A,\mathfrak{m})\rightarrow (B,\mathfrak{n})$ between two local rings such that $f^{-1}(\mathfrak{n})=\mathfrak{m}$. 
\begin{equiv_def}
\textbf{(Local ring homomorphism)} Let $f:(A,\mathfrak{m})\rightarrow (B,\mathfrak{n})$ be a ring homomorphism between two local rings. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $f$ is a local ring homomorphism. 
  \item $f(\mathfrak{m})\subseteq \mathfrak{n}$. 
  \item $f^{-1}(\mathfrak{n})\supseteq\mathfrak{m}$
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definitions. 
\end{proof}

\section{Integral dependence}
\label{Id}
Let $A$ be a subring of some ring  $B$. We say  $x \in B$ is \textbf{integral over} $A$ if  $x$ is a root of some monic polynomial with coefficients in $A$. 
\begin{theorem}
\label{CHTffgm}
\textbf{(Cayley-Hamilton Theorem for finitely generated module)} Suppose $\mathfrak{a}\subseteq A$ is an ideal, and $M$ is a finitely generated $A$-module. If $\pfi \in \operatorname{End}(M)$ satisfies $\operatorname{Im}\pfi \subseteq \mathfrak{a}M$, then there exists some $a_0,\dots ,a_{n-1} \in \mathfrak{a}$ such that 
\begin{align*}
  \pfi^n + a_{n-1}\pfi^{n-1}+\cdots + a_0= 0
\end{align*}
\end{theorem}
\begin{proof}
Let $\set{m_1,\dots , m_n}$ generate $M$. Because $\operatorname{Im}(\pfi)\subseteq \mathfrak{a}M$, we may write 
\begin{align*}
 \pfi(m_i)= \sum_{j=1}^n a_{ij}m_j,\quad \text{where }a_{ij}\in \mathfrak{a}
\end{align*}
Clearly, for each $i$, we have 
\begin{align*}
\sum_{j=1}^n (\delta_{ij}\pfi - a_{ij}\textbf{1})m_i=0, 
\end{align*}
where $\textbf{1} \in \operatorname{End}(M)$ is the identity operator and $\delta_{ij}$ is the Kronecker delta. Defining $R\triangleq A[\pfi]\subseteq \operatorname{End}(M)$, we may now view $\delta_{ij}\pfi - a_{ij}\textbf{1}$ as an $n\times n$ matrix, whose entries are elements of ring $R$. Because $R$ is a commutative unital ring, there exist $R$-matrix $X$ \textbf{adjugate} to $(\delta_{ij}\pfi-a_{ij}\textbf{1})$, i.e., $X (\delta_{ij}\pfi-a_{ij}\textbf{1})=\operatorname{det}(\delta_{ij}\pfi-a_{ij}\textbf{1})I$, where $I$ is the identity  $R$-matrix. This implies that 
\begin{align*}
\operatorname{det} (\delta_{ij}\pfi-a_{ij}\textbf{1}) m_k=0,\quad \text{ for all }k \in \set{1,\dots ,n}
\end{align*}
Noting that $\operatorname{der}(\delta_{ij}\pfi - a_{ij}\textbf{1})$ is an $\mathfrak{a}$-polynomial in $\pfi$ and $M=\langle m_1,\dots ,m_n\rangle $, our proof is done. 
\end{proof}
\customref{CHTffgm}{Cayley-Hamilton Theorem for finitely generated module} allow us to give the \customref{EDfid}{equivalent definitions of integral dependence}, which are the keys for defining integral closure.  
\begin{equiv_def}
\label{EDfid}
\textbf{(Equivalent Definitions for integral dependence)} Let $A$ be a subring of $B$, and let $x \in B$. The following are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $x\in B$ is integral over $A$.  
  \item $A[x]$ is a finitely generated $A$-module. 
  \item $A[x]$ is contained in a subring $C$ of $B$ such that $C$ as an $A$-module is finitely generated.  
  \item There exists a faithful $A[x]$-module $M$ which is finitely generated as an  $A$-module. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
  $(\text{i})\implies (\text{ii})\implies (\text{iii})\implies (\text{iv})$ is clear. We now prove $(\text{iv})\implies (\text{i})$. Define an $A$-module endomorphism  $\pfi: M\rightarrow M$ by $y\mapsto xy$. By \customref{CHTffgm}{Cayley-Hamilton Theorem for finitely generated module}, $\pfi^n + a_{n-1}\pfi^{n-1}+\cdots + a_0=0$.  In other words, $(x^n+a_{n-1}x^{n-1}+\cdots + a_0)y=0$ for all $y \in M$. Consider the case when $c=1$, and we are done.  
\end{proof}
\begin{corollary}
\label{Pro}
\textbf{(Polynomial rings of integral elements are finitely generated)} Let $A\subseteq B$ be rings, and $\set{x_1,\dots ,x_n}\subseteq B$ all be integral over $A$. Subring $A[x_1,\dots ,x_n]\subseteq B$ is finitely generated as an $A$-module.  
\end{corollary}
\begin{proof}
The proof is done by induction on $n$. Base case  $n=1$  follows from \customref{EDfid}{equivalent definitions for integral dependence}. We now do the inductive case, where $n>1$. Clearly, $x_n$ is integral over  $A[x_1,\dots ,x_{n-1}]$. This by \customref{EDfid}{equivalent definitions for integral dependence} implies $A[x_1,\dots ,x_n]$ is finitely generated as a $A[x_1,\dots ,x_{n-1}]$-module. Inductive hypothesis said that $A[x_1,\dots ,x_{n-1}]$ is finitely generated as an $A$-module. The rest of the proof then follows from \myref{theorem}{Fgas}. 
\end{proof}
\begin{corollary}
\label{DoIC}
\textbf{(Integral closure is well-defined)} Let $A \subseteq B$ be rings. The set of $x \in B$ integral over $A$ forms a ring. 
\end{corollary}
\begin{proof}
Let $x,y\in B$ be integral over $A$. We are required to prove  $x\pm y,xy$ are also integral over $A$. \myref{Corollary}{Pro} stated that $A[x,y]$ is finitely generated as an $A$-module. The rest of the proof then follows from \customref{EDfid}{equivalent definitions for integral dependence} and the observation $A[x+y],A[xy]\subseteq A[x,y]$. 
\end{proof}
Because of \myref{corollary}{DoIC}, we may well define \textbf{integral closure of $A$ in $B$} to be the ring of elements of $B$ integral over $A$. If $A$ itself is the integral closure of itself in $B$, we say  $A$ is \textbf{integrally closed in}  $B$. An integral domain is said to be an \textbf{integrally closed domain} if it is integrally closed in its field of fraction.  \\

Note that integral and algebraic dependence are related as expected. Given two integral domains $A \subseteq B$ where $B$ is integral over $A$,  $\operatorname{Frac}(B)$ is algebraic over $A$. 
\begin{corollary}
\label{ToIC}
\textbf{(Transitivity of Integral Closure)} Let $A \subseteq B \subseteq C$ be rings. If $C$ is integral over $B$ and $B$ is integral over $A$, then  $C$ is integral over $A$. 
\end{corollary}
\begin{proof}
Let $x \in C$. Because $C$ is integrally over $B$, we know 
 \begin{align*}
x^n+b_{n}x^{n-1}+ \cdots + b_1=0,\quad \text{for some }b_1,\dots ,b_{n} \in B
\end{align*}
\end{proof}
\begin{theorem}
\label{THrll}
\textbf{(Regular local rings are integrally closed domain)} Let $(A,\mathfrak{m},k)$ be a regular local ring. Then:
\begin{enumerate}[label=(\roman*)]
  \item $A$ is an integrally closed domain. 
\end{enumerate}
\end{theorem}
\section{Homological lemmas}
Let $R$ be some ring. Given a sequence of $R$-modules and $R$-modules homomorphism 
\begin{align*}
\cdots \longrightarrow M_{k-1} \overset{f}{\longrightarrow } M_k \overset{g}{\longrightarrow } M_{k+1} \longrightarrow \cdots 
\end{align*}
we say the sequence is \textbf{exact} at $M_k$ if  $\operatorname{Im}(f)=\operatorname{Ker}(g)$, and we say a sequence is \textbf{exact} if it is exact at each of its module. By a \textbf{short} exact sequence, we mean exact sequence of the form 
\begin{align*}
0 \longrightarrow   M' \longrightarrow M \longrightarrow M'' \longrightarrow  0
\end{align*}

\begin{lemma}
\label{FL}
\textbf{(Five Lemma)}
% https://q.uiver.app/#q=WzAsMTAsWzAsMCwiQSJdLFsyLDAsIkIiXSxbNCwwLCJDIl0sWzYsMCwiRCJdLFs4LDAsIkUiXSxbMCwyLCJBJyJdLFsyLDIsIkInIl0sWzQsMiwiQyciXSxbNiwyLCJEJyJdLFs4LDIsIkUnIl0sWzAsMSwiZiJdLFsxLDIsImciXSxbMiwzLCJoIl0sWzMsNCwiaiJdLFs1LDYsInIiXSxbNiw3LCJzIl0sWzcsOCwidCJdLFs4LDksInUiXSxbMCw1LCJsIiwxXSxbMSw2LCJtIiwxXSxbMiw3LCJuIiwxXSxbMyw4LCJwIiwxXSxbNCw5LCJxIiwxXV0=
Given a commutative diagram in the category of $R$-module: 
\[\begin{tikzcd}
	A && B && C && D && E \\
	\\
	{A'} && {B'} && {C'} && {D'} && {E'}
	\arrow["f", from=1-1, to=1-3]
	\arrow["l"{description}, from=1-1, to=3-1]
	\arrow["g", from=1-3, to=1-5]
	\arrow["m"{description}, from=1-3, to=3-3]
	\arrow["h", from=1-5, to=1-7]
	\arrow["n"{description}, from=1-5, to=3-5]
	\arrow["j", from=1-7, to=1-9]
	\arrow["p"{description}, from=1-7, to=3-7]
	\arrow["q"{description}, from=1-9, to=3-9]
	\arrow["r", from=3-1, to=3-3]
	\arrow["s", from=3-3, to=3-5]
	\arrow["t", from=3-5, to=3-7]
	\arrow["u", from=3-7, to=3-9]
\end{tikzcd}\]
If the two rows are exact, $m,p$ are isomorphism, $l$ is surjective and  $q$ is injective, then $n$ is also an isomorphism. The proof of Five Lemma follows immediately from the two Four Lemma, and their proof are both just diagram chasing. For demonstration, we present a proof for the \customref{FFL}{first four lemma}. 
\end{lemma}
\begin{lemma}
\label{FFL}
\textbf{(First Four Lemma)} Given a commutative diagram in the category of $R$-module:
% https://q.uiver.app/#q=WzAsOCxbMiwwLCJCIl0sWzQsMCwiQyJdLFs2LDAsIkQiXSxbMiwyLCJCJyJdLFs0LDIsIkMnIl0sWzYsMiwiRCciXSxbMCwyLCJBJyJdLFswLDAsIkEiXSxbMCwxLCJnIl0sWzEsMiwiaCJdLFszLDQsInMiXSxbNCw1LCJ0Il0sWzAsMywibSIsMV0sWzEsNCwibiIsMV0sWzIsNSwicCIsMV0sWzYsMywiciJdLFs3LDYsImwiLDFdLFs3LDAsImYiXV0=
\[\begin{tikzcd}
	A && B && C && D \\
	\\
	{A'} && {B'} && {C'} && {D'}
	\arrow["f", from=1-1, to=1-3]
	\arrow["l"{description}, from=1-1, to=3-1]
	\arrow["g", from=1-3, to=1-5]
	\arrow["m"{description}, from=1-3, to=3-3]
	\arrow["h", from=1-5, to=1-7]
	\arrow["n"{description}, from=1-5, to=3-5]
	\arrow["p"{description}, from=1-7, to=3-7]
	\arrow["r", from=3-1, to=3-3]
	\arrow["s", from=3-3, to=3-5]
	\arrow["t", from=3-5, to=3-7]
\end{tikzcd}\]
If the two rows are exact, $m,p$ are injective,  $l$ is surjective, then $n$ is injective.  
\end{lemma}
\begin{proof}
Let $c \in C$ such that $n(c)=0$. We are required to show $c=0$. Using the hypothesis, we may deduce 
\begin{align*}
n(c)=0 \implies t\circ n(c)=0 \implies p\circ h(c)=0 \implies  h(c)=0 \implies c=g(b)
\end{align*}
for some $b \in B$. Observing that $s(m(b))=n \circ g(b)=n(c)=0$, we see $m(b)=r(a')$ for some $a'\in A'$. Because $l$ is surjective, $a'=l(a)$ for some $a \in A$. Now, because  
\begin{align*}
m \circ f(a)=r\circ l(a)=r(a')=m(b)
\end{align*}
by injectivity of $m$, we may deduce  $b=f(a)$. This together with first row being exact shows that 
\begin{align*}
c=g(b)=g\circ f(a)=0 
\end{align*}
\end{proof}
\begin{lemma}
\textbf{(Second Four Lemma)} Given a commutative diagram in the category of $R$-modules: 
% https://q.uiver.app/#q=WzAsOCxbMCwwLCJCIl0sWzIsMCwiQyJdLFs0LDAsIkQiXSxbNiwwLCJFIl0sWzAsMiwiQiciXSxbMiwyLCJDJyJdLFs0LDIsIkQnIl0sWzYsMiwiRSciXSxbMCwxLCJnIl0sWzEsMiwiaCJdLFsyLDMsImoiXSxbNCw1LCJzIl0sWzUsNiwidCJdLFs2LDcsInUiXSxbMCw0LCJtIiwxXSxbMSw1LCJuIiwxXSxbMiw2LCJwIiwxXSxbMyw3LCJxIiwxXV0=
\[\begin{tikzcd}
	B && C && D && E \\
	\\
	{B'} && {C'} && {D'} && {E'}
	\arrow["g", from=1-1, to=1-3]
	\arrow["m"{description}, from=1-1, to=3-1]
	\arrow["h", from=1-3, to=1-5]
	\arrow["n"{description}, from=1-3, to=3-3]
	\arrow["j", from=1-5, to=1-7]
	\arrow["p"{description}, from=1-5, to=3-5]
	\arrow["q"{description}, from=1-7, to=3-7]
	\arrow["s", from=3-1, to=3-3]
	\arrow["t", from=3-3, to=3-5]
	\arrow["u", from=3-5, to=3-7]
\end{tikzcd}\]
If the two rows are exact, $m,p$ are surjective,  $q$ is injective, then  $n$ is surjective. As a special case of the \customref{FL}{Five Lemma}, we now have the \customref{SFL}{Short Five Lemma}.  
\end{lemma}
\begin{lemma}
\label{SFL}
\textbf{(Short Five Lemma)} Given a commutative diagram in the category of $R$-modules: 
% https://q.uiver.app/#q=WzAsMTAsWzIsMCwiQiJdLFs0LDAsIkMiXSxbNiwwLCJEIl0sWzIsMiwiQiciXSxbNCwyLCJDJyJdLFs2LDIsIkQnIl0sWzAsMiwiMCJdLFswLDAsIjAiXSxbOCwyLCIwIl0sWzgsMCwiMCJdLFswLDFdLFsxLDJdLFszLDRdLFs0LDVdLFswLDMsIm0iLDFdLFsxLDQsIm4iLDFdLFsyLDUsInAiLDFdLFs3LDBdLFs1LDhdLFsyLDldLFs2LDNdXQ==
\[\begin{tikzcd}
	0 && B && C && D && 0 \\
	\\
	0 && {B'} && {C'} && {D'} && 0
	\arrow[from=1-1, to=1-3]
	\arrow[from=1-3, to=1-5]
	\arrow["m"{description}, from=1-3, to=3-3]
	\arrow[from=1-5, to=1-7]
	\arrow["n"{description}, from=1-5, to=3-5]
	\arrow[from=1-7, to=1-9]
	\arrow["p"{description}, from=1-7, to=3-7]
	\arrow[from=3-1, to=3-3]
	\arrow[from=3-3, to=3-5]
	\arrow[from=3-5, to=3-7]
	\arrow[from=3-7, to=3-9]
\end{tikzcd}\]
If the two rows are exact and $m,p$ are isomorphisms, then $n$ is an isomorphism.  
\end{lemma}



\section{Valuation Rings}
Let $K$ be a field and  $D$ a subring of  $K$. If for each  $x\neq 0 \in K$ either $x \in D$ or $x^{-1} \in D$, then the mapping $K\longrightarrow \operatorname{Frac}(D)$ defined by  
\begin{align*}
x\mapsto \begin{cases}
  \frac{x}{1}& \text{ if $x \in D$ }\\
  \frac{1}{x^{-1}}& \text{ if $x\not\in D$ }
\end{cases}
\end{align*}
forms a ring isomorphism\footnote{Category of fields is a subcategory of rings. Field homomorphisms are ring homomorphisms.}. Because of this identification, for each integral domain $D$, it make sense to say $D$ is a  \textbf{valuation ring of field $K$} if 
\begin{align}
\label{xinD}
x\in \operatorname{Frac}(D)\implies x \in D\text{ or }x^{-1} \in D
\end{align}
 since if we replace $\operatorname{Frac}(D)$ with $K$ in \myref{equation}{xinD}, we know that  $K$ is isomorphic to   $\operatorname{Frac}(D)$. Given a field $K$ and a totally ordered abelian group $\Gamma $, we say $\nu : K\rightarrow \Gamma \cup \set{\infty}$ is a \textbf{valuation} if it satisfies:
\begin{enumerate}[label=(\alph*)]
  \item $\nu ^{-1}(\infty)= \set{0}$. 
  \item $\nu  (xy)=\nu  (x)+ \nu  (y)$. 
  \item $\nu  (x+y)\geq \min  \set{\nu (x),\nu  (y)}$, with the equality holds true if $\nu (x)\neq \nu  (y)$. 
\end{enumerate}
\begin{equiv_def}
\label{EDovr}
\textbf{(Equivalent Definitions of valuation rings)} Let $D$ be an integral domain. The following are equivalent 
\begin{enumerate}[label=(\roman*)]
  \item $D$ is a valuation ring. 
  \item The principal ideals of $D$ are totally ordered by inclusion. 
  \item The ideals of $D$ are  totally ordered by inclusion.  
  \item There is a totally ordered abelian group $\Gamma $ and a valuation $\nu : \operatorname{Frac}(D)\rightarrow \Gamma \cup \set{\infty}$ such that $D= \set{x \in \operatorname{Frac}(D): \nu  (x)\geq 0 \in \Gamma }$. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
It is easy to prove $(\text{vi})\implies (\text{i})\implies (\text{ii})\implies (\text{iii})\implies (\text{i})$. For $(\text{i})\implies (\text{iv})$, let $D^{\times}$ be the set of units of $D$. Clearly,  $D^{\times}$ is a normal subgroup of $(\operatorname{Frac}D)^*$. Because $D$ is a valuation ring, we may well define a total order on $\Gamma \triangleq (\operatorname{Frac}D)^* \quotient D^\times$ by 
\begin{align*}
[x]\geq [y]\overset{\triangle}{\iff } xy^{-1} \in D
\end{align*}
It is routine to check that $\nu  : \operatorname{Frac}(D)\rightarrow \Gamma \cup  \set{\infty}$ defined by 
\begin{align*}
\nu (x)\triangleq \begin{cases}
  [x]& \text{ if $x\neq 0$ } \\
  \infty& \text{ if $x=0$ }
\end{cases}
\end{align*}
is a valuation such that $D= \set{x\in \operatorname{Frac}(D):\nu  (x)\geq 0 \in \Gamma }$. 
\end{proof}
Obviously, the name "valuation rings" comes from the fact an integral domain $D$ is a valuation ring if and only if its field of fraction admits some valuation whose preimage of nonnegative element is exactly  $D$. Because of such, given field $K$  and valuation $\nu  : K \rightarrow \Gamma \cup \set{\infty}$, when we want to refer to the valuation ring $\set{x\in K : \nu  (x)\geq 0 \in \Gamma }$, we may refer it as the valuation ring \emph{of} $\nu $.  

\begin{theorem}
  \label{Vraic}
\textbf{(Valuation rings are integrally closed)} If $D$ is a valuation ring, then $D$ is integrally closed. 
\end{theorem}
\begin{proof}
Let $x \in \operatorname{Frac}(B)$ be integral over $B$, say,  
\begin{align*}
x^n + b_1 x^{n-1}+ \cdots + b_n=0,\quad \text{where }b_i \in B.  
\end{align*}
If $x \in B$ there is noting to prove. If not, then $x^{-1}\in B$ and thus $x=-(b_1+b_2x^{-1}+\cdots + b_n x^{1-n})\in B$. 
\end{proof}



Clearly, if $D$ is a valuation ring of $\nu$, then the set of units of $D$ is exactly the preimage  $\nu ^{-1}(0)$.\footnote{Because $0=\nu  (1)=\nu (x)+ \nu  (x^{-1})$ and $D=\nu ^{-1}(\set{x \in K: \nu  (x)\geq 0\in \Gamma })$, we know $x,x^{-1}\in D \implies \nu  (x)=0$, and we also know $\nu  (x)=0 \implies \nu (x^{-1})=0 \implies x^{-1} \in D$.} This tell us for all $x \in K$, we have 
\begin{table}[h]
\centering
\begin{tabular}{l|l|l}
                   & $x\in D$    & $x\not \in D$ \\ \hline
$x^{-1}\in D$      & $\nu (x)=0$ & $\nu(x)<0$    \\ \hline
$x^{-1}\not \in D$ & $\nu (x)>0$ & impossible   
\end{tabular}
\end{table}



Moreover, because \customref{EDovr}{ideals of valuation rings are totally ordered by inclusion}, we know valuation ring is local, and thus the set of non-units form an ideal, the unique maximal ideal $\mathfrak{m}$. In fact, $\mathfrak{m}$ has the form:  
\begin{align*}
\mathfrak{m}= \set{x \in D: \nu  (x)>0 \in \Gamma }
\end{align*}
\begin{theorem}
\textbf{()} Let $K$ be a field,  $\Omega$ an algebraically closed field, $\Sigma$ the set of all pairs $(A,f)$, where $A$ is a subring of $K$ and  $f$ is a ring homomorphism of $A$ into $\Omega$. If we partially order $\Sigma$ by 
\begin{align*}
  (A,f)\leq (A',f')\overset{\tirangle}{\iff }A \subseteq A' \text{ and }f'|_A=f
\end{align*}
\end{theorem}
\section{Noetherian}
Given some collection $\Sigma$ of sets, we say $\Sigma$ satisfies the \textbf{ascending chain condition, a.c.c.}, if for each chain $x_1 \subseteq x_2 \subseteq  \cdots$ there exists $n$ such that $x_n=x_{n+1}=\cdots$, and we say $\Sigma$ satisfies the \textbf{descending chain condition, d.c.c.}, if for each chain $x_1 \supseteq x_2 \supseteq \cdots $ there exists $n$ such that $x_n=x_{n+1}= \cdots$. Let $M$ be some module. We say  $M$  is  \textbf{Noetherian} if the collection of submodules of $M$ satisfies  a.c.c., and we say $M$ is  \textbf{Artinian} if the collection of submodules  satisfies d.c.c. Thanks to axiom of choice, we have: 
\begin{equiv_def}
\label{EDoN}
\textbf{(Noetherian modules)} Let $M$ be a module. The following are equivalent: 
\begin{enumerate}[label=(\alph*)]
  \item $M$ is Noetherian.  
  \item Every nonempty collection of submodules of $M$ has a maximal element.  
  \item Every submodule of $M$ is finitely generated.
\end{enumerate}
\end{equiv_def}
Immediately from the equivalent definitions of Noetherian, we have the following useful properties for ideals in Noetherian ring. How useful? See how we established equivalent characterization of DVR with \myref{corollary}{IiN} in \myref{theorem}{ECoDp1}.  
\begin{corollary}
\label{IiN}
  \textbf{(Ideals in Noetherian always contain some powers of its radical)} If $\mathfrak{a}\subseteq A$ for Noetherian $A$, then $\mathfrak{a}\supseteq (\sqrt{ \mathfrak{a}})^n$ for some $n$. 
\end{corollary}
\begin{proof}
Suppose $\sqrt{\mathfrak{a}}= \langle x_1,\dots ,x_k\rangle $ and $x_i^{n_i}\in \mathfrak{a}$. Defining  
\begin{align*}
m \triangleq \left(\sum_{i=1}^k n_i-1\right)+1 
\end{align*}
We have 
\begin{align*}
 \left(\sqrt{\mathfrak{a}}\right)^m = \left\langle \set{x_1^{r_1}\cdots x_k^{r_k} \in A: \sum_{i=1}^k r_i =m \text{ and }r_i \geq 0}\right\rangle 
\end{align*}
Now, by definition of $m$, we have 
 \begin{align*}
\sum_{i=1}^k r_i= m \text{ and }r_i \geq 0\implies r_i \geq n_i \text{ for at least one }i
\end{align*}
which implies $x_1^{r_1}\cdots x_1^{r_k} \in \mathfrak{a}$ for all $\sum_{i=1}^k r_i=m$ and $r_1 \geq 0$.  
\end{proof}
\begin{corollary}
\label{PIoN}
\textbf{(Primary ideals of Noetherian rings)} Let $A$ be Noetherian and $\mathfrak{m}\subseteq A$ maximal. For any ideal $\mathfrak{q}\subseteq A$, we have 
\begin{align*}
\mathfrak{q}\text{ is }\mathfrak{m}\text{-primary} \iff  \mathfrak{m}^n \subseteq \mathfrak{q} \subseteq \mathfrak{m}\text{ for some }n>0
\end{align*}
\end{corollary}
\begin{proof}
  $(\implies ):$ This follows from \myref{corollary}{IiN}.  $(\impliedby):$ $\mathfrak{m}=\sqrt{\mathfrak{q}} $ follows from $\mathfrak{m} \subseteq  \sqrt{\mathfrak{m}^n} \subseteq \sqrt{\mathfrak{q}}\subseteq \sqrt{\mathfrak{m}} = \mathfrak{m}$. It remains to prove $\mathfrak{q}$ is indeed primary. \\


Because $\mathfrak{m}=\sqrt{\mathfrak{q}} $, by \customref{raed}{definition of radical} $\mathfrak{m}$ is preimage of  $\operatorname{Nil}(A\quotient \mathfrak{q})$. This implies by correspondence theorem for rings\footnote{What we mean by the correspondence theorem for ring is \customref{ctfr}{this}.} that $\operatorname{Nil}(A\quotient \mathfrak{q})$ is the only prime ideal of $A\quotient \mathfrak{q}$.\footnote{This is because $\operatorname{Nil}(A\quotient \mathfrak{q})=\bigcap \operatorname{Spec}(A\quotient \mathfrak{q})$. See \myref{theorem}{EDfN}. The proof is nontrivial.}. We have shown $A\quotient \mathfrak{q}$ is local, so $\operatorname{Nil}(A\quotient \mathfrak{q})$ is exactly the collection of non-units of $ A\quotient \mathfrak{q}$. This implies every zero-divisor in $A\quotient \mathfrak{q}$ is nilpotent, which implies $\mathfrak{q}$ is primary.  
\end{proof}
We close this section by showing Noetherian and Artinian properties are closed under multiple operations.  
\begin{proposition}
\label{FpNm}
\textbf{(Formal properties of Noetherian and Artinian modules)} Given a short exact sequence of $A$-modules:  
 \begin{align*}
0 \longrightarrow M' \overset{\alpha }{\longrightarrow } M \overset{\beta }{\longrightarrow } M'' \longrightarrow 0
\end{align*}
$M$ is Noetherian if and only if  $M'$ and $M''$ are both Noetherian. Also, $M$ is Artinian if and only if $M'$ and  $M''$ are both Artinian. 
\end{proposition}
\begin{proof}
Consider chain condition definition. For the "if" part, let $L_n$ be an ascending chain of submodules of  $M$, and use \customref{SFL}{short five lemma} on
% https://q.uiver.app/#q=WzAsMTEsWzAsMCwiMCJdLFsyLDAsIlxcYWxwaGFeey0xfShMX24pIl0sWzQsMCwiTF9uIl0sWzYsMCwiXFxiZXRhKExfbikiXSxbOCwwLCIwIl0sWzAsMiwiMCJdLFsyLDIsIlxcYWxwaGFeey0xfShMX3tuKzF9KSJdLFs0LDIsIkxfe24rMX0iXSxbMywyXSxbOCwyLCIwIl0sWzYsMiwiXFxiZXRhKExfe24rMX0pIl0sWzAsMV0sWzEsMiwiXFxhbHBoYSJdLFsyLDMsIlxcYmV0YSJdLFs1LDZdLFs2LDcsIlxcYWxwaGEiXSxbMyw0XSxbNywxMCwiXFxiZXRhIl0sWzEwLDldLFszLDEwLCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFsyLDcsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzEsNiwiIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XV0=
\[\begin{tikzcd}
	0 && {\alpha^{-1}(L_n)} && {L_n} && {\beta(L_n)} && 0 \\
	\\
	0 && {\alpha^{-1}(L_{n+1})} & {} & {L_{n+1}} && {\beta(L_{n+1})} && 0
	\arrow[from=1-1, to=1-3]
	\arrow["\alpha", from=1-3, to=1-5]
	\arrow[hook, from=1-3, to=3-3]
	\arrow["\beta", from=1-5, to=1-7]
	\arrow[hook, from=1-5, to=3-5]
	\arrow[from=1-7, to=1-9]
	\arrow[hook, from=1-7, to=3-7]
	\arrow[from=3-1, to=3-3]
	\arrow["\alpha", from=3-3, to=3-5]
	\arrow["\beta", from=3-5, to=3-7]
	\arrow[from=3-7, to=3-9]
\end{tikzcd}\]
to conclude that $L_n$ must stop at some point.  
\end{proof}
\begin{theorem}
\label{cpoN}
\textbf{(closed property of Noetherian)} Let $A$ be a Noetherian ring, $S\subseteq A$ a multiplicatively closed subset, $\mathfrak{a}\subseteq A$ an ideal, $M$ an  $A$-module, and $N\subseteq M$ an $A$-submodule.  We have: 
\begin{enumerate}[label=(\roman*)] 
\item $A^n$ as an $A$-module is Noetherian.  
\item If $M$ is Noetherian, then  $M\quotient N$ is also Noetherian.   
  \item If $M$ is finitely generated, then $M$ is Noetherian.  
  \item $\mathfrak{a}$ as an $A$-module is Noetherian.   
  \item $S^{-1}A$ is Noetherian. 
\end{enumerate}
\end{theorem}
\begin{proof}
For $(\text{i})$, just apply \myref{Proposition}{FpNm} inductively to 
\begin{align*}
 0\longrightarrow A \longrightarrow A^n \longrightarrow A^{n-1} \longrightarrow 0 
\end{align*}
And for (ii), just apply \myref{Proposition}{FpNm} to 
\begin{align*}
0 \longrightarrow 0 \longrightarrow M \longrightarrow M\quotient N \longrightarrow 0
\end{align*}
For (iii), one simply note that if $M= \langle x_1,\dots ,x_n\rangle $, then $\pfi :A^n \to M ; (a_1,\dots ,x_n)\mapsto  a_1x_1+ \cdots +a_nx_n$ forms a surjective $A$-module homomorphism, thus $M$ isomorphic to  $A \quotient \operatorname{Ker}\pfi$ is Noetherian by (i) and (ii). (iv) is clear. \\

(v) \red{unproved}. 
\end{proof}

\begin{theorem}
\label{cpoA}
\textbf{(closed property of Artinian)} Let $A$ be a Artinian ring, $S\subseteq A$ a multiplicatively closed subset, $\mathfrak{a}\subseteq A$ an ideal, $M$ an  $A$-module, and $N\subseteq M$ an $A$-submodule.  We have: 
\begin{enumerate}[label=(\roman*)] 
\item $A^n$ as an $A$-module is Artinian.  
\item If $M$ is Artinian, then  $M\quotient N$ is also Artinian.   
  \item If $M$ is finitely generated, then $M$ is Artinian.  
  \item $\mathfrak{a}$ as an $A$-module is Artinian.  
\end{enumerate}
\end{theorem}
\begin{proof}
  The proofs are identical to that of \myref{Theorem}{cpoN}. 
\end{proof}
We say $A$ is a \textbf{regular local ring} if $A$ is a Noetherian local ring that satisfies  $\operatorname{dim}_k(\mathfrak{m}\quotient \mathfrak{m}^2)=\operatorname{Krudim}(A)$.
\begin{equiv_def}
\textbf{(Regular local rings)} Let $(A,\mathfrak{m},k)$ be a Noetherian local ring. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $A$ is regular.  
  \item $\operatorname{Dim}_k(\mathfrak{m}\quotient \mathfrak{m}^2)=\operatorname{Krudim}(A)$. 
\end{enumerate}
\end{equiv_def}
\begin{proof}

\end{proof}
\begin{theorem}
\label{THrlrU}
\textbf{(Local rings and UFDs)} Let $(A,\mathfrak{m},k)$ be a local ring. Then: 
\begin{enumerate}[label=(\roman*)]
  \item If $A$ is regular, then  $A$ is a UFD.  
  \item If $A$ is a UFD and of Krull dimension $1$, then $A$ is regular.  
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}
\section{Length}
Given a finite \textbf{chain} of submodules 
\begin{align*}
M_0 \subset M_1 \subset \cdots \subset M_n 
\end{align*}
we say this chain is of \textbf{length} $n$. Under the obvious assignment of order on the collection of all finite chains of submodules of $M$, we may define the \textbf{composition series} of $M$ to be the maximal finite chains. Clearly, a finite chain 
\begin{align*}
0= M_0 \subset \cdots \subset M_n= M
\end{align*}
is maximal if and only if  $M_k\quotient M_{k-1}$ are simple. 
\begin{theorem}
\label{Lom}
\textbf{(Length of modules is well defined)} Every composition series of a module $M$ have the same length. 
\end{theorem}
\begin{proof}
Suppose $M$ has a composition series, and let $l(M)$ denote the least length of a composition series of $M$. We wish to show every chain has length smaller than $l(M)$. Before such, we first prove 
\begin{align}
\label{NsM}
N \subset M \implies  l(N)< l(M)
\end{align}
Let $M_0 \subset \cdots \subset M_n=M$ be a composition series of least length. Define $N_k \triangleq N \cap M_k$ for all $k \in \set{0,\dots ,n}$. Consider the obvious homomorphism $N_k \quotient N_{k-1} \rightarrow M_k \quotient M_{k-1}$. We see that either $N_k \quotient N_{k-1} \cong M_k \quotient M_{k-1}$ or $N_k = N_{k-1}$. This implies that the chain $N_0 \subset \cdots \subset N_n$ will be a composition series of $N$ after the unnecessary terms are removed. It remains to show there are unnecessary terms in $N_0 \subset \cdots \subset N_n$. Assume not for a contradiction. Because $N_1 \subseteq M_1$ and $N_1 \quotient \set{0} \cong   M_1 \quotient \set{0}$, we have $N_1 = M_1$. Repeating the same argument, we have  $N=N_n=M_n=M$, a contradiction. We have proved \myref{statement}{NsM}.\\

Now, let $M_0' \subset \cdots \subset M_r'$ be some composition series of $M$. The proof then follows from using \myref{statement}{NsM} to deduce 
\begin{align*}
l(M)=l (M_r') > \cdots > l(M_0')=0 \implies r\leq l(M)
\end{align*}
\end{proof}
Because of \myref{Theorem}{Lom}, we may well define the \textbf{length} $l(M)$ of module. For obvious reason, if module $M$ has no composition series, we say $M$ has infinite length and write $l(M)=\infty$. Clearly, if $M$ is of finite length, then $M$ is both Noetherian and Artinian. Conversely, if $M$ is both Noetherian and Artinian, then by the maximal element definition of Noetherian, there exists a decreasing sequence $M=M_0 \supset M_1 \supset M_2 \supset \cdots $, which by d.c.c. must be finite.   
\begin{theorem}
\label{AaN}
\textbf{(Artinian and Noetherian are equivalent for vector space)} Let $k$ be some field, and $V$ some $k$-vector space. The following are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $V$ is finite dimensional. 
  \item $V$ is of finite length. 
  \item $V$ is Noetherian. 
  \item $V$ is Artinian. 
\end{enumerate}
Moreover, $l(V)=\operatorname{dim}(V)$ in such case. 
\end{theorem}
\begin{proof}
$(\text{i})\implies (\text{ii})\implies (\text{iii})$ and $(\text{ii})\implies (\text{iv})$ are clear. It remains to prove $(\text{iii})\implies (\text{i})$ and $(\text{iv})\implies (\text{i})$. Assume for a contradiction that $\set{v_i \in V: i \inn}$ is linearly independent. The contradiction to Noetherian of $V$ then occurs at  $(\operatorname{span}\set{v_i \in V: i\leq n})_n$ doesn't stop growing strictly, and the contradiction to Artinian of $V$ then occurs at $(\operatorname{span}\set{v_i \in  V : i\geq n})_n$ strictly decrease infinitely.  
\end{proof}
For usage in \customref{AR}{ section on Artin ring}, we give a corollary. 
\begin{corollary}
\label{Aiet}
\textbf{(Artinian is equivalent to Noetherian in the class of rings whose zero ideal is some finite product of maximal ideals)} Let $A$ be a ring with $0=\mathfrak{m}_1\cdots \mathfrak{m}_n$, where $\mathfrak{m}_i$ are maximal. We have 
\begin{align*}
A\text{ is Noetherian }\iff A\text{ is Artinian }
\end{align*}
\end{corollary}
\begin{proof}
WLOG, we only prove $(\implies )$. The proof is done by  induction. Write $\mathfrak{a}_i\triangleq \mathfrak{m}_1 \cdots \mathfrak{m}_i$, where $\mathfrak{a}_0\triangleq A$ and $\mathfrak{a}_n=0$. Clearly, $\mathfrak{a}_n$ is Artinian as an $A$-module. We now show $\mathfrak{a}_{n-1}$ is also Artinian as an $A$-module. Consider the short exact sequence of $A$-module:    
\begin{align*}
0 \longrightarrow \mathfrak{a}_n \longrightarrow \mathfrak{a}_{n-1} \longrightarrow \mathfrak{a}_{n-1} \quotient  \mathfrak{a}_{n} \longrightarrow 0
\end{align*}
By \myref{proposition}{FpNm}, to prove $\mathfrak{a}_{n-1}$ is Artinian as an $A$-module, we only have to show  $\mathfrak{a}_{n-1}\quotient \mathfrak{a}_n$ is Artinian as an $A$-module. Before such, we first have to make two remarks: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{a}_{n-1}\quotient \mathfrak{a}_n$ forms an $A\quotient \mathfrak{m}_n$-vector space  under obvious assignment of scalar product. 
  \item For each $E \subseteq \mathfrak{a}_{n-1}\quotient \mathfrak{a}_n$, $E$ forms an $A$-submodule if and only if $E$ forms an  $A\quotient \mathfrak{m}_n$-submodule. 
\end{enumerate}

Now, by \myref{proposition}{cpoN} we know $\mathfrak{a}_n \quotient \mathfrak{a}_{n-1}$ is Noetherian as an $A$-module, which with remark  (ii) implies that $\mathfrak{a}_n \quotient \mathfrak{a}_{n-1}$ is Noetherian as an $A\quotient \mathfrak{m}_n$-module, which further implies by \myref{theorem}{AaN} that $\mathfrak{a}_n \quotient \mathfrak{a}_{n-1}$ is Artinian as an $A\quotient \mathfrak{m}_n$-module, which further further implies with remark (ii) that, indeed, $\mathfrak{a}_n \quotient \mathfrak{a}_{n-1}$ is Artinian as an $A$-module. \\


We have shown $\mathfrak{a}_{n-1}$ is Artinian as an $A$-module, and if we apply the same argument\footnote{Replace $A\quotient \mathfrak{m}_n$ with $A\quotient \mathfrak{m}_{n-1}$} short exact sequence of $A$-module: 
 \begin{align*}
0 \longrightarrow \mathfrak{a}_{n-1} \longrightarrow \mathfrak{a}_{n-2}\longrightarrow \mathfrak{a}_{n-2}\quotient \mathfrak{a}_{n-1} \longrightarrow 0
\end{align*}
We see $\mathfrak{a}_{n-2}$ is also Artinian as an $A$-module. Continuing the same process, we see that indeed  $A=\mathfrak{a}_0$ is Artinian. (as an $A$-module)
\end{proof}
\section{Regularity and flat Frobenius}

\begin{theorem} 
  \textbf{(Well-definedness of Frobenius endomorphism and $R^p$)} Let $R$ be a ring. Define $F: R \rightarrow R$ by $r \mapsto  r^{\operatorname{char}(R)}$. If $R$ has prime characteristic, then $F$ forms a ring homomorphism, and if $R$ is moreover reduced, then $F$ is injective. 
\end{theorem}
\begin{proof}
Clearly $F$ respect multiplication and multiplicative identity. Let $\operatorname{char}(R)$ be prime $p$. To see $F$ also respect addition, just compute:     
\begin{align*}
\label{EQxyp}
  (x+y)^p = \sum_{i=0}^p \binom{p}{i} x^i y^{p-i}= x^p +y^p
\end{align*}
where the last equality hold true because $p$ divides $\binom{p}{i}$ for all $0<i<p$. We have shown $F$ forms a ring homomorphism when $R$ has prime characteristic. Now, if $R$ is moreover reduced, then it easy to see $F$ is injective.
\end{proof}
Let $R$ be a reduced ring with prime characteristic. We call such $F$ the \textbf{Frobenius endomorphism}. Let $R^p\triangleq F(P)$. Because $R^p$ also is reduced with prime characteristic, we know that the restriction $F|_{R^p}:R^p \rightarrow R^p$ is also a ring endomorphism. Denoting $R^{p^2}\triangleq F(R^p)$, we now get an infinite chain of subrings of $R$: 
\begin{align*}
R \supseteq R^p \supseteq R^{p^2} \supseteq R^{p^3} \supseteq \cdots ,
\end{align*}
each isomorphic to $R$.
\begin{theorem}
\label{THWp}
\textbf{(Fractional powers are well defined)} Let $R$ be a reduced domain of prime characteristic $p$, and let $K$ be an algebraic closure   $\operatorname{Frac}(R)$. For each $r \in R$ and $e>1$, there exists a unique $x \in K$, which we from now on denote by $r^{\frac{1}{p^e}}$, such that $x^{p^e}=r$. The set $\set{x \in K : x^{p^e} \in R}$ forms a reduced ring of characteristic $p$, which we denote by $R^{\frac{1}{p^e}}$. Similarly defined, we have an infinite chain of ring: 
 \begin{align*}
\cdots \supseteq R^{\frac{1}{p^2}}\supseteq R^{\frac{1}{p}} \supseteq R \supseteq R^p \supseteq R^{p^2} \supseteq \cdots , 
\end{align*}
More generally, for all $n\inz,f\in R^{p^n}$, and $a\inn$, when we define the \textbf{fractional power} $f^{ap^n}$, not only it is well-defined in term of the order of taking roots and power:  
\begin{align*}
(f^{a})^{p^n}=(f^{p^n})^a
\end{align*}
but also satisfies the expected law of arithmetic: 
\begin{align*}
  f^{(ap^m)p^n}=f^{ap^{m+n}},\quad \text{ for all }m \inz
\end{align*}
\end{theorem}
\begin{proof}
Fix $r \in R$. The existence of $x \in K$ satisfying $x^{p^e}=r$ is guaranteed by the algebraic closedness of  $K$. Let $x,y \in K$ satisfy $x^{p^e}=y^{p^e}=r$. To see $x=y$, just recall that  $R$ is reduced and that $(x-y)^{p^e} =x^{p^e}-y^{p^e}=0$. The rest are also straightforward to to check.
\end{proof}
\begin{theorem}
\label{THKrrr}
\textbf{(Kunz's criteria for regularity of reduced ring with prime characteristic, 1976)} Let $R$ be a reduced domain of prime characteristic $p$. The followings are equivalent:
\begin{enumerate}[label=(\roman*)]
  \item $R$ is regular. 
  \item $R$ is locally free as an $R^p$-module. 
\end{enumerate}
\end{theorem}
\begin{theorem}
\label{THFfp}
\textbf{(Frobenius for polynomial rings over finite fields)} Let $p$ be prime, and $R\triangleq \F_p [x_1,\dots ,x_n]$. For all $e\inz$, we have: 
\begin{align*}
R^{p^e} = \F_p [x_1^{p^e}, \dots ,x_n ^{p^e}]
\end{align*}
Because of such, for all $e\inn$, $R^{\frac{1}{p^e}}$ is a free $R$-module with free basis: 
\begin{align*}
\set{x_1^{\frac{a_1}{p^e}}\cdots  x_n^{\frac{a_n}{p^e}} \in R^{\frac{1}{p^e}}:\text{For all }i,0\leq a_i \leq p^e -1 }
\end{align*}
\end{theorem}
\begin{proof}
Note that the case $e>0$ follows from:  
\begin{align*}
  \left(\sum_\alpha  r_\alpha \textbf{x}^{\alpha }\right)^{p^e}= \sum_\alpha r_\alpha \textbf{x}^{p^e \alpha}
\end{align*}
which hold true because of \customref{THFLT}{Fermat's little theorem}. The case $e<0$ follows from: 
\begin{align*}
\left( \sum_\alpha r_\alpha \textbf{x}^{ \frac{\alpha }{p^e} } \right)^{p^e}= \sum_\alpha r_\alpha \textbf{x}^{\alpha }
\end{align*}
which hold true also because of \customref{THFLT}{Fermat's little theorem}. 
\end{proof}

Let $R\triangleq \F_p[x_1,\dots ,x_n]$. One can also check that $R$ as a $R^p$-module is also free with basis $\set{\textbf{x}^{\alpha }}_{0 \leq \alpha _i \leq p-1 }$. Explicitly, one have: 
\begin{align*}
\textbf{x}^{\alpha }= \textbf{x}^{\beta } \textbf{x}^{\gamma },\quad \text{ where } \alpha_i =q\beta_i + \gamma _i \text{ and } 0 \leq \gamma _i \leq p-1  
\end{align*}
We have just proved that $R$ is a free  $R^p$-module, therefore locally free. This by \customref{THKrrr}{Kunz criteria} implies $R$ is regular, and most importantly, the affine space $(\F_p)^n$ is smooth.\\

Let $f\in R\triangleq  \F_p[x_1,\dots ,x_n]$ vanishes at $\textbf{0}$, and let $a,e \in \N \cup  \set{0}$. Because \customref{THFfp}{$R^{\frac{1}{p^e}}$ is a free $R$-module with free basis:}
\begin{align}
\label{EQfb}
\set{x_1^{\frac{a_1}{p^e}}\cdots  x_n^{\frac{a_n}{p^e}} \in R^{\frac{1}{p^e}}:\text{For all }i,0\leq a_i \leq p^e -1 }
\end{align}
we may write $f^{a \quotient p^e}$ uniquely as a linear combination with respect to this free basis: 
\begin{align}
\label{EQfape}
  f^{\frac{a}{p^e}}= \sum_{0\leq b_i \leq p^e-1} r_\beta  x_1^{\frac{b_1}{p^e}} \cdots x_n ^{\frac{b_n}{p^e}}
\end{align}
Moreover, if we let a coprime pair $(c,p^{d})$ satisfies $a\quotient p^e= c \quotient  p^{d}$, when we write $f^{c \quotient p^{d}}$ uniquely as a linear combination with respect to the corresponding free basis: 
\begin{align*}
f^{\frac{a}{p^e}}=f ^{ \frac{c}{p^{d}}}= \sum_{0 \leq b_i \leq p^{d}-1} r_{\gamma  } x_1^{\frac{b_1}{p^{d}}} \cdots x_n ^{\frac{b_n}{p^{d}}}
\end{align*}
we see that $r_\beta  =0 $ for all $\beta  \not\leq  (p^{e}-1,\dots ,p^{e}-1)$, and $r_\gamma =r_{\beta }$ for  all $\beta  \leq (p^{e}-1,\dots ,p^{e}-1)$. Because of such, for each $p$-power denominator rational number $a\quotient p^e$, it is well-defined, independent of the representation, whether there exist coefficient $r_\beta \in R$ in \myref{equation}{EQfape} that lies the maximal ideal $\mathfrak{m}\triangleq (x_1,\dots ,x_n)\subseteq R$. We define the $F$\textbf{-purity threshold} $FT(f)$ of $f$ to be the supremum of all nonnegative $p$-power denominator rational number $a\quotient p^{e}$ such that in \myref{equation}{EQfape}, we have $r_\beta \not \in \mathfrak{m}$ for all $\beta  $. 
\begin{equiv_def}
\label{EDFth}
\textbf{($F$-purity threshold)} Let $p$ be prime, $R\triangleq \F_p[x_1,\dots ,x_n]$,  $\mathfrak{m}\triangleq (x_1,\dots ,x_n)\subseteq R$, and $f \in R$ vanishes at $\textbf{0}$. The following numbers are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $FT(f)$.  
  \item $\sup \set{\frac{a}{p^e}:a,e \geq 0 \text{ and }f^{\frac{a}{p^e}}\not \in \mathfrak{m}R^{\frac{1}{p^e}}}$, where $\mathfrak{m}R^{\frac{1}{p^e}}\subseteq R^{\frac{1}{p^e}}$ is the extension ideal. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
The proof is a consequence of the observation: 
\begin{align*}
f^{a\quotient p^e} \text{ isn't in the extension ideal }  \mathfrak{m}R^{\frac{1}{p^e}}\iff  r_\beta  \not \in \mathfrak{m}\text{ for some }\beta  
\end{align*}
\end{proof}
 Because we require $f$ to vanishes at  $\textbf{0}$, we know $f \in \mathfrak{m} R^{\frac{1}{p^e}}$. This implies that for all $ a\geq p^e$, we have $f^{\frac{a}{p^e}}=f \cdot f^{\frac{a-p^e}{p^e}} \in \mathfrak{m} R^{\frac{1}{p^e}}$. In other words, we always have $FT(f) \leq 1$.  
\begin{theorem}
\label{THWHTY}
\textbf{(Watanabe, Hara, Takagi, Yoshida, etc. 2004 $F$-threshold converges to log canonical threshold)} Let $f \in\Z [x_1,\dots ,x_n]$. We have 
\begin{enumerate}[label=(\roman*)]
  \item $FT(f\text{ mod }p)\leq \operatorname{lct}(f)$ for all $p \gg 0$. 
  \item $\lim_{p\to \infty} FT(f\text{ mod }p)=\operatorname{lct}(f)$
\end{enumerate}
\end{theorem}
\begin{theorem}
\label{THLmbf}
\textbf{(Lucas' modulo binomial formula)} Let $m\geq n \inn$ and $p$ be prime. Writing $m$ and $n$ in $p$-base: $m=\sum_{j=0}^r m_jp^j$ and $n=\sum_{j=0}^r n_jp^j$, we have: 
\begin{align*}
\binom{m}{n}\equiv \binom{m_0}{n_0} \binom{m_1}{n_1} \cdots \binom{m_r}{n_r}\quad (\text{mod } p)
\end{align*}
\end{theorem}
\begin{example}
Consider $x^2+y^3 \in \F_p [x,y]$. By \customref{THFLT}{Fermat's little theorem} and \myref{theorem}{THWp} we have 
\begin{align*}
  (x^2+y^3)^{\frac{a}{p^e}}= \left(\sum_{i=0}^a \binom{a}{i} x^{2i}y ^{3(a-i)} \right)^{\frac{1}{p^e}}= \sum_{i=0}^a \binom{a}{i} x^{\frac{2i}{p^e}} y ^{ \frac{3(a-i)}{p^e}}
\end{align*}
From this, we see that \customref{EDFth}{$(x^2+y^3)^{\frac{a}{p^e}} \not \in \mathfrak{m} R^{\frac{1}{p^e}} $ if and only if} there exists an index $i$ such that: 
\begin{align}
\label{EQ2ipe}
2i < p^e,\quad 3(a-i)< p^e\quad \text{ and }\quad \binom{a}{i}\not \equiv 0\quad (\text{mod }p)
\end{align}
Let a pair  $(a\quotient p^e,i)$ satisfies \myref{condition}{EQ2ipe}. We have:
\begin{align*}
i \leq \frac{p^e-1}{2}\quad \text{ and }\quad a-i \leq \frac{p^e-1}{3}
\end{align*}
which implies 
\begin{align*}
a\leq \frac{5p^e -5}{6}\quad \text{ and moreover }\quad \frac{a}{p^e}< \frac{5}{6}
\end{align*}
We have shown that $FT(f) \leq \frac{5}{6}$. Now, let $p$ be a prime congruent to $1$ modulo  $6$. Clearly,  $a\triangleq \frac{5p^e-5}{6}$ is an integer. Let $i \triangleq  \frac{p^e-1}{2}$. Because in base $p$, we may write:
\begin{align*}
a= \sum \left(\frac{5p-5}{6}  \right)p^j\quad \text{ and } \quad  i= \sum  \left( \frac{p-1}{2} \right)p^j 
\end{align*}
by \customref{THLmbf}{Lucas' modulo binomial formula}, we know that $i=\frac{p^e-1}{2}$ satisfies \myref{condition}{EQ2ipe}. We have shown that for all prime $p$ congruent to $1$ modulo $6$, we have  $FT(f)=\frac{5}{6}$. It now follows from \myref{theorem}{THWHTY} and Dirichlet's theorem that $\operatorname{lct}(f)=\frac{5}{6}$. 
\end{example} 
\begin{example}
Consider $x^2+y^d \in \F_p[x,y]$, where $d$ is an odd positive integer.  By Fermat's little theorem and  \myref{theorem}{THWp} we have 
\begin{align*}
  (x^2+y^d)^{\frac{a}{p^e}} = \left( \sum_{i=0}^a \binom{a}{i}  x^{2i}  y ^{d(a-i)} \right) ^{\frac{1}{p^e}}= \sum_{i=0}^a \binom{a}{i}    x^{\frac{2i}{p^e}}  y^{ \frac{d(a-i)}{p^e}}   
\end{align*}
From this, we see that \customref{EDFth}{$(x^2+y^d)^{\frac{a}{p^e}} \not \in \mathfrak{m} R^{\frac{1}{p^e}} $ if and only if} there exists an index $i$ such that: 
\begin{align}
\label{EQ3ipe}
2i < p^e,\quad d(a-i)< p^e\quad \text{ and }\quad \binom{a}{i}\not \equiv 0\quad (\text{mod }p)
\end{align}
Let a pair  $(a\quotient p^e,i)$ satisfies \myref{condition}{EQ3ipe}. We have:
\begin{align*}
i \leq \frac{p^e-1}{2}\quad \text{ and }\quad a-i \leq \frac{p^e-1}{d}
\end{align*}
which implies 
\begin{align*}
a\leq \frac{(d+2)p^e - (d+2)}{2d}\quad \text{ and moreover }\quad \frac{a}{p^e}<  \frac{d+2}{2d}
\end{align*}
We have shown that $FT(f)\leq  \frac{d+2}{2d}$. Now, let $p$ be a prime congruent to $1$ modulo  $2d$. Clearly, $a \triangleq \frac{(2+d)p^e- (2+d)}{2d}$ is an integer. Let $i\triangleq \frac{p^e-1}{2}$. Because in base  $p$, we may write:
\begin{align*}
a=\sum \left( \frac{(d+2)p-(d+2)}{2d} \right) p^j \text{ and }i= \sum  \left( \frac{p-1}{2} \right) p^j
\end{align*}
by \customref{THLmbf}{Lucas' modulo binomial formula}, we know that $i=\frac{p^e-1}{2}$ satisfies \myref{condition}{EQ3ipe}. We have shown that for all prime $p$ congruent to $1$ modulo $2d$, we have  $FT(f)=\frac{d+2}{2d}$. It now follows from \myref{theorem}{THWHTY} and Dirichlet's theorem that $\operatorname{lct}(f)=\frac{d+2}{2d}$. 



\end{example}
\section{$F$-pure}
Let $R$ be a reduced ring of prime characteristic  $p>0$, $F:R \rightarrow R$ be the Frobenius, and $e\geq 1$. By \textbf{a $p^e$-th root of ring $R$}, we mean a ring extension $R \hookrightarrow  T$ together with a ring isomorphism $T\rightarrow R$ defined by $t \mapsto t^{p^e}$. 


\begin{theorem}
\textbf{(Existence of )}
\end{theorem}


$T$ together with a ring isomorphism $g:R\rightarrow T$     




and for $e\geq 1$, let $R^{1 \quotient p^e}$ denote the set of formal symbols $\set{f^{1 \quotient p^e}: f \in R}$. Clearly, we may make $R^{1\quotient p^e}$ a ring isomorphic to $R$ by defining: 
\begin{align*}
f^{\frac{1}{p^e}} + g^{\frac{1}{p^e}}\triangleq  (f+g)^{\frac{1}{p^e}}\quad \text{ and }\quad  f^{\frac{1}{p^e}}\cdot g^{\frac{1}{p^e}}\triangleq (fg)^{\frac{1}{p^e}}
\end{align*}
Because $R$ is reduced, we have a ring inclusion $R \subseteq R^{\frac{1}{p^e}}$ defined by $f\mapsto (f^{p^e})^{1 \quotient p^e}$. Moreover, we have an infinite chain of ring inclusion: 
\begin{align*}
\cdots \supseteq R^{\frac{1}{p^2}}\supseteq R^{\frac{1}{p}}\supseteq R \supseteq R^p \supseteq R^{p^2} \supseteq \cdots 
\end{align*}
where for all $d\geq 1$, the ring inclusion $R^{1 \quotient p^{e+d}} \supseteq R^{1\quotient p^e}$ is well-defined by: 
\begin{align*}
f^{\frac{1}{p^e}}\mapsto (f^{p^e})^{\frac{1}{p^{e+d}}}
\end{align*}
and the subring $R^{p^d}\subseteq R$ is defined by: 
\begin{align*}
\set{f^{p^d}  \in R: f\in R}
\end{align*}
Because $R$ is reduced, we have a ring isomorphism $R \rightarrow R^{p^d}$ defined by $f\mapsto  f^{p^d}$. \\

Let $R$ be a reduced ring of prime characteristic. 
\begin{theorem}
\textbf{()} Identifying $R$ as an $R$-algebra via the Frobenius $F^e$, which we denote $F^e_* R$, we have an  $R$-algebra isomorphism: 
\begin{align*}
F^e_*R \cong R^{\frac{1}{p^e}}
\end{align*}
defined by: 
 \begin{align*}
 r\mapsto  r^{\frac{1}{p^e}}
\end{align*}
\end{theorem}
\begin{proof}

\end{proof}
Given an inclusion of ring $S \subseteq T$ and an element $t \in T$, we say $t$ \textbf{splits over $S$} if there exists $\theta \in \operatorname{Hom}_S (T,S)$ such that $\theta (t)=1$. Let $R$ be a reduced ring of prime characteristic, we say  $R$ is  \textbf{$F$-pure} if with respect to the inclusion $R \subseteq R^{\frac{1}{p}}$, $1 \in R^{\frac{1}{p^e}}$ splits over $R$. 


\section{Localization of ideals}
Let $I\subseteq A$ be some ideal, clearly its extension is the \textbf{localization of $I$ by $S$} defined by $S^{-1}I= \set{\frac{i}{s}\in S^{-1}A:i \in I}$. We use the notation $S(I)$ to denote the contraction of $S^{-1}I$. For \customref{UoP}{the section on uniqueness of primary decomposition}, we first prove some basic properties of localization of ideals. 
\begin{theorem}
\label{Pol}
\textbf{(Properties of localization of ideals)} Let $A$ be a ring, and let  $S$ be some multiplicatively closed subset of  $A$. 
 \begin{enumerate}[label=(\alph*)]
  \item If $I$ is an ideal in  $A$, then  
    \begin{align*}
    S(I)=\bigcup_{s \in S} (I:s)
    \end{align*} 
    \item If $I$ is an ideal in $A$, then 
\begin{align*}
\sqrt{S^{-1}I}=S^{-1}\sqrt{I}        
\end{align*}
\item If $I_1,\dots ,I_n$ are ideals in $A$, then 
   \begin{align*}
  S^{-1}(I_1 \cap \cdots \cap I_n)= S^{-1}I_1 \cap  \cdots \cap S^{-1} I_n
  \end{align*}
\end{enumerate}
\end{theorem}
\begin{proof}
We first prove part (a). Let $t \in (I:s)$ for some $s$. Because  $\frac{t}{1}= \frac{st}{s} \in S^{-1}I$, we see $t \in I^{ec}$. Let $t \in I^{ec}$, so $\frac{t}{1}= \frac{i}{s}$ for some $i \in I,s \in S$. Observe $ ts s'=is' \in I$ for some $s'$ to conclude $t \in (I:s s')$, and we are done. We now prove part (b). It is clear that $S^{-1}\sqrt{I}\subseteq \sqrt{S^{-1}I}$. Let $\frac{a}{s}\in \sqrt{S^{-1}I}$, so $\frac{a^n}{s^n}=\frac{i}{s'}\in S^{-1}I$ for some $n,i,s'$. Let $s''$ satisfies  $a^n s' s''= is^n s'' \in I$. Observations of $\frac{a}{s}= \frac{a s' s''}{s s' s''}$ and $a s' s'' \in \sqrt{I}$ finish the proof.  We now prove part (c). It is clear that $S^{-1}(I_1 \cap  \cdots \cap I_n)\subseteq S^{-1}I_1 \cap \cdots S^{-1}I_n$. Let $\frac{a}{s}\in S^{-1}I_1 \cap \cdots \cap  S^{-1}I_n$. For each $j\in \set{1,\dots ,n}$, we may find $s_j,s_j'\in S,i_j \in I$ such that  $as_js_j'=s i_j s_j' \in I_j$. Writing 
 \begin{align*}
\frac{a}{s}= \frac{as_1s_1' s_2 s_2' \cdots s_n s_n'}{s s_1 s_1' s_2 s_2' \cdots  s_n s_n'}  \in S^{-1}(I_1\cap  \cdots \cap I_n)
\end{align*}
and we are done. 
\end{proof}
\section{Uniqueness for primary decompositions}
\label{UoP}
Let $A$ be a ring. We say a proper ideal $\mathfrak{q}$ is \textbf{primary} if for each $xy \in \mathfrak{q}$, either $x \in \mathfrak{q}$ or $y^n \in \mathfrak{q}$ for some $n>0$.
\begin{equiv_def}
\textbf{(Primary ideal)} Let $A$ be a ring and  $\mathfrak{q}\subseteq A$ be an ideal. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{q}$ is primary. 
  \item Every zero divisor of $A\quotient \mathfrak{q}$ is nilpotent. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Unroll the definition. 
\end{proof}
Clearly, the radical $\mathfrak{p}=\sqrt{\mathfrak{q}} $ of a primary ideal $\mathfrak{q}$ is prime. In such case, we say $\mathfrak{q}$ is $\mathfrak{p}$\textbf{-primary}. A \textbf{primary decomposition} of an ideal $\mathfrak{a}$ is an expression of $\mathfrak{a}$ as a finite intersection of primary ideals: 
 \begin{align*}
\mathfrak{a}= \bigcap_{i=1}^n \mathfrak{q}_i
\end{align*}
Such primary decomposition is said to be \textbf{irredundant} if $\sqrt{\mathfrak{q}_i}$ are all distinct and no $\mathfrak{q}_i$ is unnecessary in the sense that: 
\begin{align*}
\bigcap_{j\neq i}\mathfrak{q}_j \not \subseteq \mathfrak{q}_i,\quad \text{ for all }i. 
\end{align*}
An ideal $\mathfrak{a}$ is said to be  \textbf{decomposable} if there exists some primary decomposition of $\mathfrak{a}$. Because finite intersection of $\mathfrak{p}$-primary ideals is again  $\mathfrak{p}$-primary\footnote{In general, finite intersection of primary ideals need not be primary. To prove finite intersection of $\mathfrak{p}$-primary ideals are $\mathfrak{p}$-primary, the first step is to prove the radical of the finite intersection is $\mathfrak{p}$.}, every decomposable ideal has an irredundant primary decomposition.  
\begin{theorem}
\label{Fut}
\textbf{(First uniqueness theorem for irredundant primary decomposition)} Given some irredundant primary decomposition $\mathfrak{a}= \bigcap_{i=1}^n \mathfrak{q}_i$, we have 
\begin{align}
\label{QiRa}
\set{\sqrt{\mathfrak{q}_i}:1\leq i\leq n}= \operatorname{Spec}(A) \cap \set{\sqrt{(\mathfrak{a}:x)} \subseteq A: x \in A } 
\end{align}
\end{theorem}
\begin{proof}
Before showing that both sides of \myref{equation}{QiRa} are subsets of each other, we first make the following observation. For all $x \in A$, clearly: 
\begin{align*}
  (\mathfrak{a}:x)= \left(\bigcap \mathfrak{q}_i :x \right) = \bigcap (\mathfrak{q}_i : x)
\end{align*}
Therefore, 
\begin{align}
\label{sIxa}
\sqrt{(\mathfrak{a}:x)}= \bigcap \sqrt{(\mathfrak{q}_i:x)}= \bigcap_{k:x \not\in \mathfrak{q}_k} \sqrt{\mathfrak{q}_k}  
\end{align}
where the last equality is justified by: 
\begin{align*}
x \in \mathfrak{q}_i \implies (\mathfrak{q}_i:x)=A,\quad\text{ and } x \not\in \mathfrak{q}_i \implies  \sqrt{(\mathfrak{q}_i:x)} = \sqrt{\mathfrak{q}_i} 
\end{align*}
We now prove that the left hand side of \myref{equation}{QiRa} is a subset of the right hand side. Fix $i$. By irredundancy of the decomposition, there exists some  $x\in A$ such that $x$ belongs to all $\mathfrak{q}_j$ except  $\mathfrak{q}_i$. This $x$ by \myref{equation}{sIxa} must satisfies:
\begin{align*}
\sqrt{\mathfrak{q}_i}  =  \sqrt{(\mathfrak{a}:x)} 
\end{align*}
Noting that $\sqrt{\mathfrak{q}_i}$ must be prime due to $\mathfrak{q}_i$ being primary, we have shown the left hand side of \myref{equation}{QiRa} is a indeed a subset of the right hand side. \\

Now, suppose for some $x\in A$ that $\sqrt{(\mathfrak{a}:x)}$ is prime. Because prime ideal must be proper, we know there must exists some $k$ such that $x\not \in \mathfrak{q}_k$. By \myref{equation}{sIxa}, to finish the proof, we only need to show $\sqrt{\mathfrak{q}_k}\subseteq \sqrt{(\mathfrak{a}:x)}$ for some $k$ such that $x \not \in \mathfrak{q}_k$. Assume not for a contradiction. Then for all $k$ such that $x \not \in \mathfrak{q}_k$, there exists $y_k \in \sqrt{\mathfrak{q}_k} - \sqrt{(\mathfrak{a}:x)}$. The product of these $y_k$ is an element of  $\bigcap \sqrt{\mathfrak{q}_k}$, thus an element of $\sqrt{(\mathfrak{a}:x)}$. This with $\sqrt{(\mathfrak{a}:x)}$ being prime shows that $y_k \in \sqrt{(\mathfrak{a}:x)}$ for some $k$, a contradiction. 
\end{proof}
Let $\mathfrak{a}\subseteq A$ be an ideal. A \textbf{minimal prime ideal over $\mathfrak{a}$} is a minimal element in the set of prime ideals that contains $\mathfrak{a}$. Note that by \customref{Roi}{definition of radical}, a minimal prime ideal over $\mathfrak{a}$ is also is a minimal prime ideal over $\sqrt{\mathfrak{a}} $. 
\begin{equiv_def}
  \textbf{(Minimal prime ideals over decomposable ideals)} Let $A$ be a ring and  $\mathfrak{a}\subseteq A$ be a decomposable ideal with irredundant primary decomposition $\mathfrak{a}=\mathfrak{q}_1\cap  \cdots \cap \mathfrak{q}_n$. Let $\set{\sqrt{\mathfrak{q}_1},\dots ,\sqrt{\mathfrak{q}_m}}$ be the collection  of minimal elements of $\set{\sqrt{\mathfrak{q}_1} ,\dots ,\sqrt{\mathfrak{q}_n} }$. The followings are equivalent: 
  \begin{enumerate}[label=(\roman*)]
    \item $\mathfrak{p}$ is a minimal prime ideal over $\mathfrak{a}$. 
    \item $\mathfrak{p}\in \set{\sqrt{\mathfrak{q}_1},\dots ,\sqrt{\mathfrak{q}_m}  }$
  \end{enumerate}
\end{equiv_def}
\begin{proof}
  (i)$\implies $(ii): Because $\mathfrak{p}$ contains $\mathfrak{q}_1 \cap \cdots \cap \mathfrak{q}_n$, we know 
\begin{align*}
  \sqrt{\mathfrak{q}_1}\cap  \cdots \cap \sqrt{\mathfrak{q}_n} \subseteq \sqrt{\mathfrak{q}_1 \cap \cdots \cap  \mathfrak{q}_n} \subseteq \sqrt{ \mathfrak{p}}=  \mathfrak{p}  
\end{align*}
If none of $\sqrt{\mathfrak{q}_i}$ is contained by $\mathfrak{p}$, then we can cause a contradiction by considering $\prod y_i$ where $y_i \in \sqrt{\mathfrak{q}_i}-\mathfrak{p}$.\\

(ii)$\implies $(i): Let $1\leq i\leq m$. If $\sqrt{\mathfrak{q}_i}$ is not minimal, then by (i)$\implies $(ii), $\sqrt{\mathfrak{q}_i} \supseteq \sqrt{\mathfrak{q}_j}$ for some $1\leq j\leq m$ that isn't $i$, contradicting to the construction that $\set{\sqrt{\mathfrak{q}_1},\dots ,\sqrt{\mathfrak{q}_m}}$ are minimal among $\set{\sqrt{\mathfrak{q}_1},\dots ,\sqrt{\mathfrak{q}_n}  }$. 
\end{proof}
The followings have not been cleaned yet!!!!

Because of \customref{Fut}{the first uniqueness theorem}, we may well define the \textbf{inner spectrum} of decomposable ideal $I$, independent of choice of irredundant decomposition, to be 
\begin{align*}
\bset{\sqrt{Q_1},\dots ,\sqrt{Q_n}}
\end{align*}
where 
\begin{align*}
I= \bigcap_{i=1}^n Q_i\text{ is some irredundant primary decomposition. }
\end{align*}
Given such irredundant primary decomposition, we say $Q_i$ is an  \textbf{isolated primary component} if $\sqrt{Q_i}$ is minimal in the inner spectrum.  
\begin{lemma}
\label{P48}
\textbf{(preparation lemma for second uniqueness theorem)} Let $S$ be a multiplicatively closed subset of  $A$, and let  $Q$ be a $P$-primary ideal. If $S$ and  $P$ are disjoint, then  $S^{-1}Q$ is $S^{-1}P$-primary and $S(Q)=Q$. If  $S$ and  $P$ meet, then  $S^{-1}Q=S^{-1}A$. 
\end{lemma}
\begin{proof}
Suppose $S$ and $P$  are disjoint. Clearly we have $Q\subseteq S(Q)$, so to show $S(Q)=Q$, we only have to show $S(Q)\subseteq Q$. Let $a \in S(Q)$. The first part of \myref{Theorem}{Pol} states that $a \in (Q:s)$ for some $s \in S$. Because $Q \subseteq P$, this implies $a \in Q$. We have shown $S(Q)=Q$. Note that the second part of \myref{Theorem}{Pol} states that 
\begin{align*}
\sqrt{S^{-1}Q}=S^{-1}\sqrt{Q}=S^{-1}P  
\end{align*}
so for the case when $S$ and  $P$ are disjoint, it only remains to prove  $S^{-1}Q$ is indeed primary, which is routine and even unnecessary for the \customref{Sut}{Second uniqueness theorem below}. \\

Suppose $s \in S \cap P$. Let $s^n \in Q$. The fact that $S^{-1}Q=S^{-1}A$ follows from the fact $\frac{s^n}{1}$ is a unit with inverse $\frac{1}{s^n}$. 
\end{proof}
\begin{theorem}
\label{Sut}
\textbf{(Second uniqueness theorem for isolated primary component)} The isolated primary components of a decomposable ideal $I$ is uniquely determined by $I$, independent of the irredundant decomposition. 
\end{theorem}
\begin{proof}
Let $P$ be a minimal element of the inner spectrum of $I$, and let $I=\bigcap_{i=1}^n Q_i$ be an arbitrary irredundant primary decomposition, where $\sqrt{Q_1}=P$. Clearly $S\triangleq A\setminus P$ is multiplicatively closed. Because the definition of $S$ is independent of the choice of the primary decomposition, we are only required to prove the goal
\begin{align*}
\label{QSI}
Q_1=S(I)
\end{align*}
Because $S$ and  $P$ are disjoint, we may apply \myref{Lemma}{P48} to reduces this goal into 
\begin{align*}
S^{-1}Q_1= S^{-1}I
\end{align*}
Noting that $\sqrt{Q_i}$ meets $S=A \setminus \sqrt{Q_1} $ for every $i>1$ due to the minimality of $\sqrt{Q_1}$, we conclude our proof using \myref{Lemma}{P48} and the third part of \myref{Theorem}{Pol}:
\begin{align*}
S^{-1}I = \bigcap_{i=1}^n S^{-1}Q_i=S^{-1}Q_1
\end{align*}
\end{proof}
\section{Existence of primary decompositions in Noetherian ring}
\label{EoPDiNr}
Let $A$ be a ring, and let  $I\subseteq A$ be some ideal. We say $I$ is  \textbf{irreducible} if whenever $I$ is expressed as an intersection of two ideals, $I$ equals to one of them. Clearly, to show every ideal in Noetherian ring is decomposable, we only need to show the following two lemmas. 
\begin{lemma}
In Noetherian ring $A$, every ideal is a finite intersection of irreducible ideals.  
\end{lemma}
\begin{proof}
Assume not for a contradiction. Let $I$ be a maximal element of the collection $\Sigma$ of all ideals that can not be expressed as finite intersections of irreducible ideals. Clearly, $I$ must be reducible, so there exists some $I=J_1 \cap J_2$ such that $I\subset J_1$ and $I\subset J_2$. Because $J_1,J_2 \not \in \Sigma$, we may express them both as finite intersection of irreducible ideals. This implies that we may express $I$ as a finite intersection of irreducible ideals, a contradiction. 
\end{proof}
\begin{lemma}
In Noetherian ring $A$, every irreducible ideal is primary.   
\end{lemma}
\begin{proof}
Let $I\subseteq A$ be irreducible. Clearly, the zero ideal in  $A\quotient I$ is irreducible, and if the zero ideal in $A \quotient I$ is primary, then $I$ is also primary. Because of such, we may WLOG suppose $I$ is zero.  Let $xy=0$ and $y\neq 0$. We are required to show $x^n=0$. Clearly we have the chain  $\operatorname{Ann}(x)\subseteq \operatorname{Ann}(x^2) \subseteq \cdots $, and by a.c.c., there exists some $n$ such that $\operatorname{Ann}(x^n)=\operatorname{Ann}(x^{n+1})= \cdots $. We now show 
\begin{align}
\label{xny}
  \langle x^n\rangle \cap \langle y\rangle =0
\end{align}
Let $a \in \langle x^n\rangle \cap \langle y\rangle $. Because $a \in \langle y\rangle $ and $xy=0$, we know  $ax=0$. Writing $a=bx^n$, we now see $b \in \operatorname{Ann}(x^{n+1})=\operatorname{Ann}(x^n)$. This implies $a=bx^n=0$. We have shown  \myref{Equation}{xny}.\\

Finally, because the zero ideal is irreducible, we must have $\langle x^n\rangle =0$ or $\langle y\rangle =0$. Because $y\neq 0$, we may conclude $x^n=0$.  
\end{proof}
\section{Artin rings}
\label{AR}
Set theoretically similar to \customref{EDoN}{equivalent definition of Noetherian}, by axiom of choice, we have 
\begin{theorem}
\label{EDoA}
\textbf{(Equivalent Definition of Artinian)} Let $M$ be a module. We have 
 \begin{enumerate}[label=(\alph*)]
  \item $M$ is Artinian.  
  \item Every nonempty collection of submodules of $M$ has a minimal element.  
\end{enumerate}
\end{theorem}
From this definition, we see that Artin ring can only have finite number of maximal ideals. 
\begin{corollary}
\textbf{(Artin ring has only a finite number of maximal ideals)} If $A$ is an Artin ring, then  
\begin{align*}
A\text{ only has a finite number of maximal ideals. }
\end{align*}
\end{corollary}
\begin{proof}
Let $\Sigma$ be the collection of all finite intersection of maximal ideals of $A$, and let  $\mathfrak{m}_1 \cap  \cdots \cap \mathfrak{m}_n \in \Sigma$ be minimal. We claim that $\mathfrak{m}_1,\dots ,\mathfrak{m}_n$ are the only maximal ideals of $A$. To prove this, we only have to prove that for each maximal ideal $\mathfrak{m}$, there exist some $i$ such that $\mathfrak{m}_i \subseteq \mathfrak{m}$, and it will follows that $\mathfrak{m}=\mathfrak{m}_i$.\\

Assume not for a contradiction. Let $x_i \in \mathfrak{m}_i - \mathfrak{m}$ for all $i$. We see $\prod x_i \in \prod \mathfrak{m}_i \subseteq \bigcap \mathfrak{m}_i\subseteq \mathfrak{m}$, where the last set inclusion follows from minimality of $\bigcap \mathfrak{m}_i \in \Sigma$. Because  $\mathfrak{m}$ is prime, we see $x_i \in \mathfrak{m}$ for some $i$, a contradiction to the construction of  $x_i$.  
\end{proof}
\begin{theorem}
\label{Niin}
\textbf{(Nilradical in Artin ring is nilpotent)} If ring $A$ is Artinian, then
\begin{align*}
(\operatorname{Nil}(A))^k=0\text{ for some }k.
\end{align*}
\end{theorem}
\begin{proof}
Let $\mathfrak{a}\triangleq (\operatorname{Nil}(A))^k= (\operatorname{Nil}(A))^{k+1}= \cdots $. Assume for a contradiction that $\mathfrak{a}\neq 0$. Letting $\Sigma$ be the collection of all ideals $\mathfrak{b}$ such that $\mathfrak{a} \mathfrak{b}\neq 0$, we see $\Sigma$ is nonempty since $\mathfrak{a} \in \Sigma$, and therefore by \customref{EDoA}{equivalent definition of Artinian} there exists minimal $\mathfrak{c} \in \Sigma$. Picking $x \in \mathfrak{c}$ such that $x \mathfrak{b}\neq 0$, we see by minimality of $\mathfrak{c}$ that $\mathfrak{c}=\langle x\rangle $. Checking that $(x\mathfrak{a})\mathfrak{a}=x \mathfrak{a}^2 =x \mathfrak{a}\neq 0$ and $x\mathfrak{a}\subseteq \mathfrak{a}$, again by minimality of $\langle x\rangle $, we see $x\mathfrak{a}=\langle x\rangle $. This implies $x=xy$ for some  $y \in \mathfrak{a} \supseteq \operatorname{Nil}(A)$, and therefore $x=xy=xy^2 =\cdots = xy^n =0$ for some large enough $n$, a contradiction to construction of $x$. 
\end{proof}
Given ring $A$, we define its \textbf{Krull dimension} to be the supremum of the length of all chains of prime ideals in $A$. Albeit tempting to treat Artinian a property symmetry to Noetherian, Artin rings is in fact a subclass of Noether rings. 
\begin{theorem}
\label{AcoA}
\textbf{(Actual characterization of Artin Rings)} Given some ring $A$, 
 \begin{align*}
A\text{ is Artin }\iff  A\text{ is Noetherian with }\operatorname{Krudim}(A)=0
\end{align*}
\end{theorem}
\begin{proof}
$(\implies)$: We first prove $\operatorname{Krudim}(A)=0$. Note that $\operatorname{Krudim}(A)=0$ means exactly that all prime ideal of $A$ are maximal. Let $\mathfrak{p}\subseteq A$ be prime, and $x \neq 0\in B \triangleq A\quotient p$. Because $B$ is Artinian, there exists some $n$ such that $\langle x^n\rangle =\langle x^{n+1}\rangle $, which implies 
\begin{align*}
x^n =x^{n+1}y,\quad\text{for some }y \in B
\end{align*}
Because $x \neq 0$ and $B$ is an integral domain, this tell us $xy=1$. We have shown that $B$ is a field, i.e., $\mathfrak{p}$ is indeed maximal. \\

Let $\mathfrak{m}_1,\dots ,\mathfrak{m}_n$ be the maximal ideals of $A$. Because every maximal ideal in Artin ring is prime and $\mathfrak{m}_1,\dots ,\mathfrak{m}_n$ are the only maximal ideal of $A$, we see that \customref{EDfN}{$\prod \mathfrak{m}_i^k\subseteq (\bigcap  \mathfrak{m}_i)^k =(\operatorname{Nil}(A))^k=0$} for some $k$ by  \myref{Theorem}{Niin}. It then follows from \myref{Corollary}{Aiet} that $A$ is indeed Noetherian. \\

$(\impliedby)$:  Because $A$ is Noetherian,  \customref{EoPDiNr}{we know the zero ideal of $A$ has an irredundant  primary decomposition $0= \bigcap_{i=1}^n \mathfrak{q}_i$}. Let $\mathfrak{p}$ be a prime ideal. Because $\bigcap_{i=1}^n \mathfrak{q}_i \subseteq \mathfrak{p}$, we know $\mathfrak{q}_i \subseteq \mathfrak{p}$ for some $i$\footnote{Otherwise you may cause a contradiction by considering $\prod x_i$ where $x_i \in \mathfrak{q}_i - \mathfrak{p}$}, which by  \customref{raed}{definition of radical} implies that $\sqrt{ \mathfrak{p}_i }\subseteq \mathfrak{p}$. We have shown \customref{EDfN}{$\operatorname{Nil}(A)= \bigcap_{i=1}^n \sqrt{\mathfrak{q}_i} $}. Letting $\mathfrak{a}=0$ in \myref{Corollary}{IiN}, we now see
\begin{align*}
\prod_{i=1}^n (\sqrt{\mathfrak{q}_i})^k \subseteq (\bigcap_{i=1}^n \sqrt{\mathfrak{q}_i} )^k= (\operatorname{Nil}(A))^k=0
\end{align*}
Because $\operatorname{Krudim}(A)=0$, we know $\sqrt{\mathfrak{q}_i}$ are all maximal ideals. It then follows from \myref{Corollary}{Aiet} that $A$ is Artinian. 
\end{proof}
Having zero Krull dimension together with being local form a very lethal weapon. A ring $A$ satisfies  $A$ local and  $\operatorname{Kudim}(A)=0$ if and only if $A$ contains exactly one prime ideal, i.e., its nilradical. From this point of view, \myref{Theorem}{AcoA} is very strong, which you can already guess from its long proof. Indeed, \myref{Theorem}{AcoA} give us the following two useful corollaries, which are all later used to establish the \customref{ECoDp1}{equivalent characterization of DVR}.  
\begin{corollary}
\label{Potm}
\textbf{(Powers of the maximal ideal of Noetherian local rings)} Given Noetherian local ring $(A,\mathfrak{m})$, exactly one of the following two statements is true: 
\begin{enumerate}[label=(\alph*)]
  \item $\mathfrak{m}^n \neq \mathfrak{m}^{n+1}$ for all $n$. 
  \item $\mathfrak{m}^n=0$ for some $n$, and  $A$ is an Artin ring. 
\end{enumerate}
\end{corollary}
\begin{proof}
  Suppose $\mathfrak{m}^n=\mathfrak{m}^{n+1}$ for some $n$. Because $A$ is Noetherian and local, we may apply  \customref{Nakayama}{Nakayama Lemma} to see $\mathfrak{m}^{n}=\mathfrak{m}^{n+1}=0$. To show $A$ is indeed Artinian, by  \myref{Theorem}{AcoA}, we only have to prove that $\mathfrak{m}$ is the only prime ideal of $A$. Too see thus, just observe $\mathfrak{m} \subseteq \sqrt{\mathfrak{m}^n}\subseteq \sqrt{ \mathfrak{p}}=\mathfrak{p} $ if $\mathfrak{p}$ is prime. 
\end{proof}

\begin{corollary}
\label{Potm}
\textbf{(Powers of the maximal ideal of Artin local ring)} Consider the Artin local ring $(A,\mathfrak{m},k)$. We have 
\begin{align*}
A\text{ is a PID with every proper nonzero ideal being some power of $\mathfrak{m}$ }\iff \operatorname{dim}_{k}(\mathfrak{m}\quotient \mathfrak{m}^2)\leq 1
\end{align*}
\end{corollary}
\begin{proof}
$(\implies ):$ This follows from noting that if we let $x$ be the generator of  $\mathfrak{m}$, then $[x]$ spans $\mathfrak{m}\quotient \mathfrak{m}^2$ over $k$. \\

$(\impliedby)$: If  $\operatorname{dim}_k(\mathfrak{m}\quotient \mathfrak{m}^2)=0$, then $\mathfrak{m}=\mathfrak{m}^2$, so by \customref{Nakayama}{Nakayama Lemma}\footnote{Because  \customref{AcoA}{$A$ is Noetherian}, we know $\mathfrak{m}$ is finitely generated.}, $\mathfrak{m}=0$, implying $A$ is a field. Suppose $\operatorname{dim}_k(\mathfrak{m}\quotient \mathfrak{m}^2)=1$ and $[x]\in \mathfrak{m}\quotient \mathfrak{m}^2$ spans $\mathfrak{m}\quotient \mathfrak{m}^2$ over $k$. We first show that indeed, $\mathfrak{m}$ as an ideal of $A$ is generated by just $x$.\\

Let $y \in \mathfrak{m}$. Because $[x]\in \mathfrak{m}\quotient \mathfrak{m}^2$ spans $\mathfrak{m}\quotient \mathfrak{m}^2$ over $k$. We know $[y]=[ax] \in \mathfrak{m}\quotient \mathfrak{m}^2$ for some $a \in A$. This implies $y-ax= m_1m_1'+\cdots + m_nm_n'$ for some $m_i,m_i \in \mathfrak{m}$, which implies $[y]=[y-ax] \in \mathfrak{m}\quotient \langle x\rangle $ is also an element of $\mathfrak{m}(\mathfrak{m}\quotient \langle x\rangle )$. We have shown  $\mathfrak{m}(\mathfrak{m}\quotient \langle x\rangle )=\mathfrak{m}\quotient \langle x\rangle $. It now follows from \customref{Nakayama}{Nakayama Lemma}\footnote{$\mathfrak{m}\quotient \langle x\rangle $ is finitely generated because $A$ is  \customref{AcoA}{$A$ is Noetherian}.} that $\mathfrak{m}\quotient \langle x\rangle =0$, i.e., $\mathfrak{m}=\langle x\rangle $ indeed. \\

Now, let $\mathfrak{a}\subset A$ be a proper nonzero ideal.\footnote{If $\mathfrak{a}=A$, then $\mathfrak{a}=\langle 1\rangle $.} \myref{Theorem}{AcoA} tell us that  $\operatorname{Krudim}(A)=0$, and so $\mathfrak{m}^n=\operatorname{Nil}(A)^n=0$ for some $n$ by \myref{Theorem}{Niin}. Let $r$ satisfies $\mathfrak{a}\subseteq \mathfrak{m}^r,\mathfrak{a}\not \subseteq \mathfrak{m}^{r+1}$. By construction, there exist some $y \in \mathfrak{a}$ such that $y=ax^r$ for some $a \in A$ and  $y \not\in \langle x^{r+1}\rangle $. We now see this $a$ satisfies  $a \not \in \langle x\rangle = \mathfrak{m}$, implying $a$ is a unit. This shows $x^r=ya^{-1}\in \mathfrak{a}$. We have shown $\mathfrak{a}=\langle x^r\rangle $, as desired.
\end{proof}
\section{Equivalent characterizations for DVR}
Let $K$ be a field. A \textbf{discrete valuation $\nu :K\rightarrow \Gamma \cup  \set{\infty}$} is a valuation such that $\Gamma \cong  \Z$ as totally ordered abelian group. An integral domain $D$ is a \textbf{discrete valuation ring} if $D=\set{x\in \operatorname{Frac}(D):\nu  (x)\geq 0}$ for some nontrivial discrete valuation $\nu : \operatorname{Frac}(D)\rightarrow \Z \cup  \set{\infty}$. Because every ideal $\mathfrak{a}\subseteq D$ is of the form: \footnote{To see the "$\supseteq$", let $a\in \mathfrak{a}$ satisfies $\nu  (a)= \min  \nu  (\mathfrak{a})$ and observe for all $x \in D$ such that $\nu (x)\geq \nu (a)$, we have $x=(xa^{-1})a\in \mathfrak{a}$ since $\nu (xa^{-1})=\nu (x)-\nu (a)\geq 0 \implies xa^{-1}\in D$}
\begin{align*}
\mathfrak{a}=\set{x \in D: \nu  (x)\geq \min \nu  (\mathfrak{a})}
\end{align*}
We see that the collection of the ideals in DVRs is exactly $\set{\mathfrak{a}_k:k \inn}$ where 
\begin{align}
\label{cDVR}
\mathfrak{a}_k= \set{x \in D : \nu  (x)\geq pk}= \langle x^k\rangle \text{ for any }\nu  (x)=p\triangleq  \min \set{\nu  (d) \inn:d^{-1}\not \in D}
\end{align}
In fact, we can conversely characterize DVRs using these good properties. 
\begin{equiv_def}
\label{ECoDp1}
\textbf{(DVR, under the requirement of being an $1$-Krull-dimensional Noetherian local domain)} Let $(D,\mathfrak{m},k)$ be an $1$-Krull-dimensional Noetherian local domain. The followings are equivalent:
\begin{enumerate}[label=(\roman*)]
  \item $D$ is a DVR.  
  \item $D$ is integrally closed. 
  \item $\mathfrak{m}$ is principal. 
  \item $D$ is regular.
  \item Every proper nonzero ideal of $D$ is a power of $\mathfrak{m}$. 
  \item There exists $x\in D$ such that every nonzero ideal is of the form $\langle x^s\rangle ,s\geq 0$. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Before we start going the rounds, we shall make the following remark 
\begin{enumerate}[label=(\Alph*)]
  \item Because $D$ is an $1$-Krull-dimensional local domain, $D$ has only two prime ideals, i.e., the zero ideal and $\mathfrak{m}$. 
  \item  Because $D$ is Noetherian, by remark (A) and  \myref{Corollary}{IiN}, for every proper nonzero ideal $\mathfrak{a}\subseteq D$, we have some $n$ that satisfies $\mathfrak{m}^n \subseteq \mathfrak{a}$ and $\mathfrak{m}^{n-1}\not \subseteq \mathfrak{a}$. 
  \item Because $\operatorname{Krudim}(D)=1$ and $D$ is Noetherian local, $\mathfrak{m}^n \neq \mathfrak{m}^{n+1}\text{ for all }n\geq 0$ by \myref{Theorem}{Potm}. 
\end{enumerate}
We may now start going rounds. 
(i)$\implies $(ii) follows from the fact  \customref{Vraic}{valuation ring are integrally closed}.\\

(ii)$\implies $(iii): Let $a \neq 0 \in \mathfrak{m}$.  By remark (B), there exists some $n$ such that  $\mathfrak{m}^n \subseteq \langle a\rangle $ and $\mathfrak{m}^{n-1}\not \subseteq  \langle a\rangle $. Picking $b \in \mathfrak{m}^{n-1}-\langle a\rangle $, and defining $x \triangleq  \frac{a}{b} \in \operatorname{Frac}(D)$, clearly we have $x^{-1}\not\in D$, so by premise, $x^{-1}$ is not integral over $D$. Therefore, $x^{-1}\mathfrak{m} \not \subseteq \mathfrak{m}$\footnote{Otherwise, we may set $A\triangleq D$, $\mathfrak{a}\triangleq D$,  $M\triangleq \mathfrak{m}$, and $\pfi (m)\triangleq x^{-1}m$ in   \customref{CHTffgm}{Cayley-Hamilton Theorem for finitely generated module} to deduce $x^{-1}$ is integral over $D$. Note that $\mathfrak{m}\neq 0$ because $\operatorname{Krudim}(D)=1$.}. This, together with the fact that $x^{-1}\mathfrak{m}=a^{-1}(b \mathfrak{m})\subseteq \mathfrak{m}^n \subseteq a^{-1}\langle a\rangle \subseteq A$  by construction, implies $x^{-1}\mathfrak{m}=A$, since $\mathfrak{m}\neq 0$ is the only maximal ideal of $A$. In conclusion, one can now finish the proof by checking, indeed,  $\mathfrak{m}=xA=\langle x\rangle $. \\

(iii)$\implies $(iv): If $\mathfrak{m}$ is generated by $x$ over $D$, then $\mathfrak{m}\quotient \mathfrak{m} $ is spanned by $[x]\in \mathfrak{m}\quotient \mathfrak{m}^2$ over $k$, and so by remark  (C), we have $\operatorname{dim}_k(\mathfrak{m}\quotient \mathfrak{m}^2)=1$. \\

(iv)$\implies $(v): Let $\mathfrak{a}\subset D$ be some proper nonzero ideal. By remark (B), there exists some $n$ that satisfies  $\mathfrak{m}^n \subseteq \mathfrak{a}$. By \customref{ctfr}{ring correspondence theorem} and \myref{theorem}{cpoN}, $A\quotient \mathfrak{m}^n$ is Noetherian local, and thus by \myref{corollary}{Potm} Artin. Now, checking that indeed the square of image of $\mathfrak{m}$ is the image of $\mathfrak{m}^2$ under quotient map $A\longrightarrow A\quotient \mathfrak{m}^n$, and checking that $\operatorname{dim}_{(A\quotient \mathfrak{m}^n)\quotient \mathfrak{m}}(\mathfrak{m}\quotient \mathfrak{m}^2)\leq \operatorname{dim}_k(\mathfrak{m}\quotient \mathfrak{m}^2)=1$, we may apply \myref{corollary}{Potm} to conclude that $\mathfrak{a}$ is a power of $\mathfrak{m}$ in $A\quotient \mathfrak{m}^n$. Now, says $\mathfrak{a}=\mathfrak{m}^r$ in $A\quotient \mathfrak{m}^n$, because the quotient map  $A \longrightarrow A\quotient \mathfrak{m}^n$ maps $\mathfrak{m}^r$ to the $r$-th power of image of $\mathfrak{m}$, we see by \customref{ctfr}{ring correspondence theorem} that indeed $\mathfrak{a}=\mathfrak{m}^r$ in $A$. \\

 (v)$\implies$(vi): By remark (C), there exists $x \in \mathfrak{m}-\mathfrak{m}^2$, and by premise, $\langle x\rangle =\mathfrak{m}^r$ for some $r$. Because if $r>1$, then  $x \in \mathfrak{m}^r \subseteq \mathfrak{m}^2$, we see $r=1$. It is then easy to check $\mathfrak{m}^s=\langle x^s\rangle $  for all $s \inn$.  \\

  (vi)$\implies $(i): Let $\mathfrak{m}\triangleq \langle x\rangle $. For all $y\in D$, one define $\nu (y)\triangleq n$ where $n\geq 0$ is  the smallest nonnegative integer such that $y \not\in \langle x^n\rangle $. To finish the proof one may check $\nu  (yz^{-1})\triangleq \nu (y)-\nu (z)$ well define a discrete valuation on $\operatorname{Frac}(D)$. 
\end{proof}
\section{UFT for ideals in $1$-Krull-dimensional Noetherian domain}
Before the main course, we first develop some basic notion. We say two ideals are \textbf{coprime} if their sum equals to the whole ring. Note that two prime ideals need not be coprime. If $K$ is a field, then $\langle x\rangle ,\langle y\rangle $ are not coprime in $K[x,y]$. 
\begin{proposition}
\label{Poc}
\textbf{(Product of coprime ideals is the intersection)} Let $I_k$ be a finite collection of pairwise coprime ideals. We have  $\prod I_k= \bigcap I_k$. 
\end{proposition}
\begin{proof}
The proof relies on induction of total number of the pairwise coprime ideals. The base case is when there are only two, says, $I$ and  $J$. Clearly  $IJ \subseteq I \cap J$. To prove the converse, observe for $c \in I \cap J$, there exists $1=i+j$ so that  $c=ci+cj$, where $ci,cj \in I \cap J$. 
\end{proof}
\begin{theorem}
\textbf{(UFT for ideals in Noetherian domain of Krull Dimension 1)} If $A$ is a Noetherian domain of Krull dimension $1$, then every nonzero ideal  $I \subseteq A$ can be uniquely expressed as a product of primary ideals whose radicals are all distinct. 
\end{theorem}
\begin{proof}
We first note that 
\begin{enumerate}[label=(\roman*)]
  \item Because $\operatorname{Krudim}(A)=1$, every prime ideal in $A$ is maximal.  
  \item Two distinct maximal ideals are always coprime. 
  \item $\sqrt{J},\sqrt{J'}$ coprime $\implies J,J'$ coprime.\footnote{$x+y=1,x^n \in J,y^k \in J' \implies 1=1^{n+k}=(x+y)^{n+k}\in J+J'$.}
\end{enumerate}
For existence, first observe that   \customref{EoPDiNr}{because $A$ is Noetherian, $I$ has an irredundant primary decomposition $I= \bigcap  Q_i$}. Then, by (i), (ii), (iii), and \myref{Proposition}{Poc}, we have 
\begin{align*}
I=\bigcap Q_i=\prod Q_i
\end{align*}
To see $\sqrt{Q_i}$ are indeed distinct, just note that the primary decomposition  $I= \bigcap Q_i$ is irredundant. For uniqueness, suppose $I= \prod Q_i=\prod Q_i'$, where $\sqrt{Q_i}$, just like $\sqrt{Q_j}$, are distinct and prime. Again, by (i), (ii), (iii), and \myref{Proposition}{Poc}, we have 
\begin{align*}
I = \prod Q_i = \bigcap Q_i = \prod Q_i' = \bigcap Q_i' 
\end{align*}
Because $\sqrt{Q_i}$ are distinct, by \customref{Fut}{first uniqueness theorem for primary decomposition}, we know none of $Q_i$ are redundant, i.e., $I= \bigcap Q_i$ is an irredundant primary decomposition. Same argument shows that $I= \bigcap Q_i'$ is also an irredundant primary decomposition. The fact that these two primary decomposition are identical up to a renewal of index then follows from \customref{Sut}{second uniqueness theorem for primary decomposition} and noting that every $\sqrt{Q_i},\sqrt{Q_i'} $ are isolated because by (i) they are all maximal.    








\end{proof}
\section{Fractional ideal}
Let $A$ be an integral domain, and  $K\triangleq \operatorname{Frac}(A)$. Given two $A$-submodule $N,M\subseteq K$, we define their \textbf{product} and \textbf{quotient} and the same way we define product and quotient\footnote{See \myref{Equation}{IS} and \myref{Equation}{Iq}} for ideals of a ring:   
\begin{align*}
NM\triangleq \set{ \sum_{\text{ finite}}nm \in K: n \in N \text{ and }m \in M}\text{ and }(N:M)\triangleq \set{x\in K : xM \subseteq N}
\end{align*}
Clearly, $A$-submodules of  $K$ are indeed closed under  these two binary operation, and moreover the product for $A$-submodule of  $K$ is associative, commutative, and has a unique identity $A$, forming a commutative monoid\footnote{You may google what is a monoid.}.   \\

A \textbf{fractional ideal} of $A$ is an  $A$-submodule  $M \subseteq K$ such that $xM \subseteq A$ for some $x\neq 0 \in A$. Clearly, fractional ideals need not be subsets of $A$, so fractional ideals are not always ideals of $A$\footnote{However unfortunate, the naming is "justified" in the sense that fractional ideals "act like" ordinary ideals with the twist that denominators are allowed, and moreover, if $xM\subseteq A$ for some $x$, then $xM$ is indeed an ideal.}. If there is need to talk about fractional ideal, some people use the term \textbf{integral ideal} to refer to an ordinary ideal. Clearly the set of fractional ideal is closed under product and contains $A$, so the set of fractional ideals of $A$ is a sub-monoid of the commutative monoid of  $A$-submodules of  $K$.\\ 

An \textbf{invertible ideal} of $A$ is an $A$-submodule of  $M \subseteq A$ such that $NM=A$ for some $A$-submodule $N\subseteq K$. In other words, it is the set of all elements of the commutative monoid of $A$-submodule of  $K$ that has an inverse. From this point of view, it is clear that the set of invertible ideal is closed under product, and thus forms a group\footnote{which automatically implies the uniqueness of inverses of invertible ideals}.\begin{proposition}
\label{Foti}
\textbf{(Form of the inverse of invertible ideal)} Let $A$ be an integral domain, and $K\triangleq \operatorname{Frac}(A)$. If  $M$ is invertible with inverse $N$, then  $N= (A:M)$.  
\end{proposition}
\begin{proof}
Because $MN=A$ and the product is associative, we know  $(A:M)\subseteq (A:M)A= (A:M)MN$, which give us the desired inequality: 
\begin{align*}
N \subseteq (A:M)\subseteq (A:M)MN\subseteq AN\subseteq N
\end{align*}
finishing the proof.
\end{proof}
Let $M$ be an element of the group invertible ideals of  $A$. From \customref{Foti}{$M^{-1}=(A:M)$}, we see that $M$ as an  $A$-module is finitely generated\footnote{$\sum x_iy_i =1$ for some $x_i \in (A:M),y_i \in M\implies M= \langle y_i\rangle $} and thus a fractional ideal of $A$\footnote{$(x_1\cdots x_n)\langle \frac{y_1}{x_1},\dots ,\frac{y_n}{x_n}\rangle \subseteq A$.}. We have shown that the group of invertible ideals is a sub-monoid of the monoid of  fractional ideals of $A$. \\ 

For next theorem, note that given any $A$-submodule $N\subseteq K$ and prime $\mathfrak{p}\subseteq A$, we can and will identify $N_\mathfrak{p}$ as an $A_\mathfrak{p}$-submodule of $\operatorname{Frac}(A)$. This is because by universal property, we have the diagram  
% https://q.uiver.app/#q=WzAsNixbMiwwLCJBIl0sWzQsMCwiQV9cXG1hdGhmcmFre3B9Il0sWzIsMiwiXFxvcGVyYXRvcm5hbWV7RnJhY30oQSkiXSxbNCwyLCJcXG9wZXJhdG9ybmFtZXtGcmFjfShBX1xcbWF0aGZyYWt7cH0pIl0sWzAsMCwiTSJdLFswLDIsIk1fXFxtYXRoZnJha3twfSJdLFs0LDIsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzQsNV0sWzUsMiwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbMCwyXSxbMCwxXSxbMSwzXSxbMiwzLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJhcnJvd2hlYWQifX19XV0=
\[\begin{tikzcd}
	N && A && {A_\mathfrak{p}} \\
	\\
	{N_\mathfrak{p}} && {\operatorname{Frac}(A)} && {\operatorname{Frac}(A_\mathfrak{p})}
	\arrow[from=1-1, to=3-1]
	\arrow[hook, from=1-1, to=3-3]
	\arrow[from=1-3, to=1-5]
	\arrow[from=1-3, to=3-3]
	\arrow[from=1-5, to=3-5]
	\arrow[hook, from=3-1, to=3-3]
	\arrow[double_arrow   ,  from=3-3, to=3-5]
\end{tikzcd}\]
\begin{theorem}
\label{Iialp}
\textbf{(Invertibility is a local property)} Let $A$ be an integral domain, $K\triangleq \operatorname{Frac}(A)$, and $M\subseteq K$ a fractional ideal of $A$. We have 
\begin{align*}
  M \text{ is invertible } \iff M\text{  is finitely generated and  $M_\mathfrak{p}$ invertible of $A_\mathfrak{p}$ for all prime $\mathfrak{p}\subseteq A$. }
\end{align*}
\end{theorem}
\begin{proof}
For the only if part, since we already know that $M_\mathfrak{p}$ is finitely generated, we only have to perform a routine check of: 
\begin{align*}
M_\mathfrak{p}(A:M)_\mathfrak{p}=A_\mathfrak{p}.
\end{align*}
For the if part, first observe that $M(A:M)$ is an integral ideal. Let $\mathfrak{m}$ be an maximal integral ideal, and denote the integral ideal $M(A:M)$ by $\mathfrak{a}$. Check that 
\begin{align*}
\mathfrak{a}_\mathfrak{m}= M_\mathfrak{m}(A:M)_\mathfrak{m}= M_\mathfrak{m} (A_\mathfrak{m}:M_\mathfrak{m})=A_\mathfrak{m} 
\end{align*}
\footnote{$(A:M)_\mathfrak{m}=(A_\mathfrak{m}:M_\mathfrak{m})$ depends on the fact that $M$ is finitely generated. }
Let $x \in A - \mathfrak{m}$. Because $x \in A \subseteq A_\mathfrak{m}=\mathfrak{a}_\mathfrak{m}$, we know there exists $a \in \mathfrak{a}$ and $s \in A - \mathfrak{m}$ such that $x=as^{-1}$. Because maximal ideal is prime, we now see $a=xs \not\in \mathfrak{m}$. In other words, $\mathfrak{a}\not \subseteq \mathfrak{m}$. This with maximality of $\mathfrak{m}$ implies $\mathfrak{a}=A$, i.e., $M$ is invertible. 
\end{proof}
\section{Dedekind domain}
\begin{theorem}
\label{LdiD}
\textbf{(Local domain $D$ is DVR if and only if every nonzero fractional ideal of $D$ is invertible)} Let $D$ be a local domain. 
 \begin{align*}
D\text{ is a DVR } \iff  \text{ every nonzero fractional ideal of $D$ is invertible. }
\end{align*}
\end{theorem}
\begin{proof}
We first prove $(\implies )$. Let $ \mathfrak{a}_1 = \langle x\rangle $ in \myref{Equation}{cDVR}, and let $M$ be a nonzero fractional ideal. Let $y \in D$ satisfies $yM \subseteq D$, so $yM= \langle x^k\rangle $ for some $k\inn$. This implies $M$ is a fractional principal ideal $M= \langle x^{k- \frac{\nu  (y)}{p}}\rangle $, thus invertible.  \\ 

We now prove $(\impliedby)$. Because every integral ideal of $D$ is invertible and \customref{EDoN}{therefore finitely generated, we know $D$ is Noetherian}. Let $\mathfrak{m}$ be the unique maximal ideal of $D$. If every nonzero proper integral ideal is a power of $\mathfrak{m}$, then no nonzero proper ideal integral ideal that isn't $\mathfrak{m}$ can be prime, since, says $0\neq \mathfrak{m}^k \subset \mathfrak{m}$, we would have some $m_1,\dots ,m_k \not\in \mathfrak{m}^k$ that satisfy $m_1\cdots m_k \in \mathfrak{m}^k$. Therefore, if we can prove that every nonzero proper integral ideal is a power of $\mathfrak{m}$, we can conclude $\operatorname{Krudim}(D)=1$ and use \myref{Theorem}{ECoDp1} to  conclude $D$ is a DVR. \\

We have reduced the problem into proving every nonzero proper integral ideal is a power of $\mathfrak{m}$. Assume for a contradiction that this isn't true. Let $\Sigma$ be the collection of nonzero ideals that are not powers of $\mathfrak{m}$. \customref{EDoN}{Because $D$ is Noetherian, there exists some maximal element $\mathfrak{a} \in \Sigma$}. We know $\mathfrak{a} \subset \mathfrak{m}$ from $\mathfrak{a}\neq \mathfrak{m}^1$. Let $\mathfrak{m}^{-1}$ be the inverse of $\mathfrak{m}$ in the group of invertible ideals. Because $\mathfrak{a}\neq \mathfrak{m}^1$, we know $\mathfrak{a}\subset \mathfrak{m}$, which implies $\mathfrak{m}^{-1}\mathfrak{a}\subset \mathfrak{m}^{-1}\mathfrak{m}=D$. We have shown that $\mathfrak{m}^{-1}\mathfrak{a}$ is a proper integral ideal. Also, note that $\mathfrak{m}^{-1}\mathfrak{a}\supseteq \mathfrak{a}$ because by \myref{Proposition}{Foti} $1 \in \mathfrak{m}^{-1}$.\\

We shall cause a contradiction using the fact $\mathfrak{a}\subseteq \mathfrak{m}^{-1}\mathfrak{a}\subset D$, which we have just proved. Clearly, there are only two possibilities: either $\mathfrak{m}^{-1}\mathfrak{a}$ strictly include $\mathfrak{a}$ or not. If $\mathfrak{m}^{-1}\mathfrak{a}$ strictly include $\mathfrak{a}$, then $\mathfrak{m}^{-1}\mathfrak{a}$ is a power of $\mathfrak{m}$ by maximality of $\mathfrak{a}$, which implies that $\mathfrak{a}$ is a power of $\mathfrak{m}$, a contradiction. If not, then we may deduce $\mathfrak{a}=\mathfrak{m}\mathfrak{a}$, and use \customref{Nakayama}{Nakayama's Lemma}\footnote{ To see $\mathfrak{a}$ is finitely generated, observe that $\mathfrak{a}$ is an $D$-submodule of the Noetherian $D$-module and use  \myref{Theorem}{EDoN}. To see $\mathfrak{m}\subseteq \operatorname{Jacob}(D)$, just note that by definition  $\mathfrak{m}$ is the only maximal ideal of $D$.} to deduce $\mathfrak{a}=0$, also a contradiction.   



\end{proof}
A \textbf{Dedekind domain} is an integral domain $D$ whose localizations at nonzero prime are always DVR.
\begin{theorem}
\textbf{(An equivalent definition of Dedekind Domain)} Let $D$ be an integral domain. 
 \begin{align*}
D\text{ is a Dedekind domain }\iff \text{ every nonzero fractional ideal of $D$ is invertible. }
\end{align*}
\end{theorem}
\begin{proof}
  We first prove $(\implies )$. Let $M\neq 0$ be a fractional ideal. $\operatorname{Frac}(D)$ is Noetherian because $D$ is Noetherian. \customref{EDoN}{This implies $M$ is finitely generated}. Clearly for any prime $\mathfrak{p}\subseteq D$, $M_\mathfrak{p}$ is always nonzero fractional ideal of $D_\mathfrak{p}$. We have shown $M$ is finitely generated and  $M_\mathfrak{p}$ is always invertible ideal of $D_\mathfrak{p}$. Then because  \customref{Iialp}{invertibility is a local property},  $M$ is also invertible. \\

  We now prove $(\impliedby)$. Fix nonzero prime $\mathfrak{p}\subseteq D$. By \myref{Theorem}{LdiD}, we only have to prove every nonzero fractional ideal of $D_\mathfrak{p}$ is invertible. Let $M$ be a nonzero fractional ideal of $D_\mathfrak{p}$, and $x\neq 0\in \operatorname{Frac}(D)$ satisfies $xM \subseteq D_\mathfrak{p}$. To prove $M$ is invertible of  $D_\mathfrak{p}$, we must first note that if there exists some fractional ideal $N$ of $D_\mathfrak{p}$ such that  $(xM)N=D_\mathfrak{p}$, then we will have  $M(xN)=D_\mathfrak{p}$. Because $xM$ is a nonzero integral ideal of  $D_\mathfrak{p}$, this allow us to reduce the problem into proving all nonzero integral ideal of $D_\mathfrak{p}$ is invertible of $D_\mathfrak{p}$. \\

Let $\mathfrak{b}$ be an integral ideal of $D_\mathfrak{p}$, and define $\mathfrak{a}\triangleq \mathfrak{b}\cap D$. Clearly $\mathfrak{a}$ is an integral ideal of $D$, so by premise, $\mathfrak{a}$ is invertible. It now follows from $\mathfrak{b}=\mathfrak{a}_\mathfrak{p}$\footnote{You may check this.} and the fact \customref{Iialp}{invertibility is a local property} that $\mathfrak{b}$ is invertible of $D_\mathfrak{p}$. 
\end{proof}
\section{Completion}
Let $G$ be simultaneously a group and a topological space. We say $G$ is a \textbf{topological group} if addition $(x,y)\mapsto x+y$ and negation $x\mapsto -x$ are both continuous. 
\begin{equiv_def}
\textbf{(Topological Group)} Let $G$ be simultaneously a group and a topological space. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $G$ is a topological group. 
  \item $G\times G\rightarrow G;(x,y)\mapsto x-y$ is continuous.  
\end{enumerate}
\end{equiv_def}
\begin{proof}
  (i)$\implies $(ii): Because subtraction is the composition:  
\begin{align*}
G\times G\xrightarrow{(x,y)\mapsto (x,-y)} G\times G \xrightarrow{(x,y)\mapsto x+y} G
\end{align*}
To see the first map is continuous, just observe both components of $(x,y)\mapsto (x,-y)$ are continuous.\footnote{The universal property of product topology implies that $f:X\rightarrow \prod Y_i$ is continuous if and only if $f_i$ are all continuous.}\\

(ii)$\implies $(i): Note that negation is the composition: 
\begin{align*}
G \xrightarrow{x\mapsto (0,x)} G\times G \xrightarrow{(x,y)\mapsto (x-y)}  G
\end{align*}
Again to see the first map is continuous, just observe that both components of $x\mapsto (0,x)$ are continuous. Note that addition is the composition: 
\begin{align*}
G \times G \xrightarrow{(x,y)\mapsto (x,-y)} G\times G \xrightarrow{(x,y)\mapsto x-y} G 
\end{align*}
The fact that the second components of the first map is continuous follows from the fact that negation is continuous. 
\end{proof}
Recall that given topological space $X$ and sequence  $\set{x_n}$ in $X$, we say $x_n \rightarrow y$ if for all neighborhood $U$ of  $y$, there exists some  $s(U)$ such that $x_n \in U$ for all $n\geq s(U)$. Let $G$ be an abelian topological group\footnote{We must require $G$ to be abelian here, so that we don't have to talk about notions like "left converge", "right converge", "left Cauchy," and "right Cauchy". For more information, see comments of this MO post: https://mathoverflow.net/questions/150703/completion-of-abelian-topological-groups# that give a reference to Bourbaki.}. Because $U+x$ are open for any open  $U\subseteq G$ and $x \in G$,\footnote{You may check that the translation $z\mapsto z-x$ is continuous.} we see that in $G$, 
\begin{align*}
x_n \rightarrow y \iff (x_n-y) \rightarrow 0. 
\end{align*}
Let $G$ be an abelian topological group. We say a sequence $\set{x_n}$ in  $G$ is a \textbf{Cauchy sequence} if for all neighborhood  $U$ of $0$, there exists some integer $s(U)$ such that 
\begin{align*}
x_n-x_m \in U \text{ for all }n,m\geq s(U)
\end{align*}
Clearly,  we may define on the collection of Cauchy sequences in $G$ an equivalence relation by saying two Cauchy sequences $\set{x_n},\set{y_n}$ are equivalent if and only if $x_n-y_n \rightarrow 0$.\footnote{Fix $U$, and let $f:G\rightarrow G$ be the negation. There exists $N$ such that $x_n-y_n \in f^{-1}(U)$ for all $n\geq N$. Such $N$ suffices to prove symmetry. Let  $g:G\times G\rightarrow G$ be the addition. There exists open $O_1,O_2\subseteq G$ such that $O_1 \times O_2 \subseteq g^{-1}(U)$, and there exists $N$ such that  $x_n-y_n \in O_1$ and $y_n-z_n \in O_2$. Such $N$ suffices to prove transitivity.} We denote the equivalence class of Cauchy sequences in $G$ by  $\widehat{G}$. Clearly we may well-define the obvious group structure on $\widehat{G}$.\footnote{The argument for well-definedness of group structure is the same as that for well-definedness of equivalence class.} \\

Let $G$ be an abelian topological group, and let $N$ be a neighborhood of  $0$. We denote $\widehat{N}\subseteq \widehat{G}$ the collection of equivalence class $[x_n]$ such that for every $\set{y_n}\in [x_n]$, there exists integer $M$ such that $y_n \in N$ for all $n\geq M$. Clearly, the collection of $U\subseteq \widehat{G}$ such that: 
\begin{align*}
\text{ For all $[x_n]\in U$ there exists neighborhood $N\subseteq G$ of $0$ such that  $[x_n]+ \widehat{N}\subseteq U$  }
\end{align*}
forms a topology on $\widehat{G}$.\footnote{To see that this topology is indeed closed under finite intersection, show $\widehat{N_1 \cap N_2}\subseteq \widehat{N_1}\cap \widehat{N_2}$} \\

Suppose moreover that $G$ has a \textbf{local basis} at  $0$ with the form: 
\begin{align*}
G=G_0 \supseteq G_1 \supseteq G_2 \supseteq \cdots,\quad \text{ where }G_i\text{ are all subgroups of $G$. }
\end{align*}
In other words, we have a descending chain of subgroups $G_i$ such that $G_i$ are all open and every neighborhood of  $0$ contains some $G_i$.  
\section{Filtrations}
\section{Graded rings and modules}
Given some ring $A$, a \textbf{grading on} $A$ is an assignment of each $n\inz$ a subgroup $A_n \subseteq A$ such that $A= \bigoplus A_n$ and $A_nA_t \subseteq A_{n+t}$\footnote{You may interpret $A_tA_n$ as  $\set{a_ta_n \in A:a_t \in A_t,a_n \in A_n}$ here.} for all $n,t\inz$. If we say graded ring $A$ is  \textbf{$\N$-graded}, we mean that  $A_{n}=0$ for all $n<0$. Fix $a \in A$. If $a=a_{n_1}+ \cdots + a_{n_s}$ for $a_{n_i} \in A_{n_i}$, we say $a_{n_i}$ are the \textbf{homogeneous components of $a$}, and if $s=1$ we say $a$ is a \textbf{homogeneous element}. Note that there is  ambiguity whether $0$ should be considered homogeneous. If one consider $0$  homogeneous, then $0$ should have arbitrary degree. 
\begin{theorem}
\textbf{(Properties of graded rings)} If $A$ is a graded ring, then:
 \begin{enumerate}[label=(\roman*)]
  \item $A_0$ forms a subring of  $A$.  
  \item For each $n\inz$, $A_n$ forms a $A_0$-modules where the scalar product is the multiplication of  $A_0$. 
\end{enumerate}
\end{theorem}
\begin{proof}
(i): $A_0$ is clearly closed under addition and multiplication. To see $1 \in A$, consider the highest graded component of $1$ and  $1=1 \cdot 1$. (ii) is clear. 
\end{proof}
An ideal $\mathfrak{a} \subseteq A$ is \textbf{homogeneous} if $\mathfrak{a}$ have a set of generators that are all homogeneous. 
\begin{equiv_def}
\textbf{(Homogeneous ideals)} Given a graded ring $A$ and an ideal $\mathfrak{a}$ in $A$, the followings are equivalent:
 \begin{enumerate}[label=(\roman*)]
  \item $\mathfrak{a}$ is homogeneous. 
  \item $\mathfrak{a}= \bigoplus \mathfrak{a}\cap A_n$ 
\end{enumerate}
\end{equiv_def}
\begin{proof}
  (i)$\implies $(ii):  The sum $\sum (\mathfrak{a}\cap A_n)$ is clearly direct. We only have to prove $\sum (\mathfrak{a}\cap A_n)=\mathfrak{a}$. Fix $a \in \mathfrak{a}$. By premise, there exists some $a_1,\dots ,a_s,x_1,\dots ,x_s \in A$ such that: 
\begin{enumerate}[label=(\alph*)]
  \item $a=\sum x_ia_i$. 
  \item  For all $i$,  $a_i\in \mathfrak{a}\cap A_{j_i}$ for some $j_i\inz$. 
\end{enumerate}
The proof then follows from expressing $x_i$ as the sum of its homogeneous components. Note that (ii)$\implies $(i) is clear.
\end{proof}
\begin{theorem}
\textbf{(Homogeneous ideals are closed under common operations)}  Given a graded ring $A$ and two homogeneous ideals  $\mathfrak{a},\mathfrak{b}$ in $A$, the sum, the product, and the intersection of $\mathfrak{a},\mathfrak{b}$ all remain homogeneous. The radical of $\mathfrak{a}$ is also homogeneous.  
\end{theorem}
\begin{proof}
Let $S_a,S_b$ contain only homogeneous elements and generate $\mathfrak{a},\mathfrak{b}$. The sum $\mathfrak{a}+\mathfrak{b}$ is then generated by $S_a\cup S_b$.\\



If $(x_1+\cdots +x_r)^l \in I$ with $x_r$ highest grade and $I$ homogeneous, then since the highest grade term of $(x_1+\cdots +x_r)^l$ is $x_r^l$, we have  $x_r \in \sqrt{I}$, which implies $x_1+\cdots + x_{r-1} \in \sqrt{I}$.
\end{proof}




Given graded ring $A$ and homogeneous ideal  $I$, one may check that  $(A\quotient I)_d\triangleq \pi  (A_d)$ for all $d$ where  $\pi :A \twoheadrightarrow A\quotient I$ is the quotient map forms a grading and satisfies the universal property of quotient in the category of graded rings. \\







Given a graded ring $A$ and an  $A$-module  $M$, a  \textbf{grading on $M$} is an assignment of each  $n\inz$ a submodule  $M_n\subseteq M$ such that $M=\bigoplus M_n$ and $A_nM_t \subseteq M_{n+t}$ for all $n,t\inz$. \textbf{Twisted module}  $M(l)$ as an $A$-module is the same as $M$, but its grading are shifted by $M(l)_d\triangleq M_{d+l}$. Given some map $f:M\rightarrow N$ between two graded $A$-modules, we say $f$ is a \textbf{graded $A$-module homomorphism} if $f$ is a $A$-module homomorphism and $f$ respect the grading in the sense that $f(M_n)\subseteq N_n$ for all $n\inz$. Let $N\subseteq M$ be an $A$-submodule. We say  $N$ is a \textbf{graded  $A$-submodule  of $M$} if the inclusion map is an graded $A$-module homomorphism. 
\begin{equiv_def}
\textbf{(Graded submodules)} Let $A$ be a graded ring, $M$ a graded $A$-module, and $N\subseteq M$ a $A$-submodule. The followings are equivalent:
\begin{enumerate}[label=(\roman*)]
  \item $N$ is a graded  $A$-submodule of  $M$.  
  \item $N= \bigoplus (N\cap M_n)$. 
  \item $N$ have a set of generator consisting of homogeneous elements.\footnote{You haven't define homogeneous elements for graded modules yet.}  
\end{enumerate}
\end{equiv_def}
\begin{proof}

\end{proof}

\section{Dimension}

\begin{theorem}
\textbf{(Krull dimension of polynomial rings)} Let $A$ be a Noetherian ring, and let $A[x_1,\dots,x_n]$ be the formal polynomial ring. Then:
\begin{align*}
\operatorname{Krudim}(A[x_1,\dots ,x_n])=\operatorname{Krudim}A+ n
\end{align*}
\end{theorem}
\begin{proof}
Because of \customref{HBT}{Hilbert basis theorem}, it is enough to rove the case $n=1$.  Let $\mathfrak{p}$ be a prime ideal in $A$ and  $P$ a prime ideal in  $A[x]$ that  makes $\operatorname{ht}(P\quotient \mathfrak{p})$
\end{proof}
\begin{theorem}
\label{Kpit}
\textbf{(Krull's principal ideal theorem)} Given Noetherian  $A$, if  $x \in A$ is neither a unit nor a zero-divisor, then the minimal prime ideals over $\langle x\rangle $ all has height $1$. 
\end{theorem}
\begin{theorem}
\label{sdt}
\textbf{(Dimension Theorem)} Let $k$ be a field, $B$ a finitely generated  $k$-algebra and also an integral domain, and $\mathfrak{p}\subseteq B$ be prime. We have: 
\begin{enumerate}[label=(\roman*)]
  \item $\operatorname{Krudim}(B)=\operatorname{trdeg}_k \operatorname{Frac}(B)$. 
  \item $\operatorname{height}\mathfrak{p}+\operatorname{Krudim}(B\quotient \mathfrak{p})=\operatorname{Krudim}(B)$. 
\end{enumerate}
\end{theorem}
\section{Hilbert function}
\chapter{Varieties}
\section{Topology of Zariski}
Let $X$ be a topological space. We say $X$ is \textbf{irreducible} if $X$ can not be written as union of two proper closed subset of $X$. If we say a subset of some topological space is \textbf{irreducible}, we mean that that subset when given the subspace topology is irreducible. Let $X$ be some arbitrary topological space. In other words, $Y\subseteq X$ is irreducible if and only if $Y$ can not be written as  $Y=(F_1 \cap Y)\cup  (F_2\cap Y)$ where $F_1,F_2 \subseteq X$ are closed and don't contain $Y$. 
\begin{theorem}
\label{IaC}
\textbf{(Irreducibility and closure)} Given topological spaces $Y \subseteq X$, the topological space $Y$ is irreducible if and only if  $\overline{Y}$ is irreducible.   
\end{theorem}
\begin{proof}
Just observe that given any two closed sets $F_1,F_2 \subseteq X$, the statement that $\overline{Y}=(F_1 \cap \overline{Y})\cup  (F_2 \cap \overline{Y})$ where $F_1\cup F_2$ doesn't cover $\overline{Y}$ is equivalent to the statement that $Y=(F_1 \cap Y)\cup (F_2 \cap Y)$ where $F_1 \cup F_2$ doesn't cover $Y$. 
\end{proof}
\begin{equiv_def}
\label{irrtop}
\textbf{(Irreducible topology)} Given topological space $X$, the followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $X$ is irreducible. 
  \item Every nonempty open subset of $X$ is dense. 
  \item Every two nonempty open subset of $X$ have nonempty intersection.  
  \item Every open subspace of $X$ is irreducible. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
(i)$\implies $(ii): If nonempty open $Y\subseteq X$ is not dense, then $\overline{Y}$ is proper closed and $X=\overline{Y}\cup (X-Y)$. \\

(ii)$\implies $(iii): Assume for a contradiction $Y_1,Y_2\subseteq X$ are nonempty open that have empty intersection. One get a contradiction from  $\overline{Y_1}=X$ and $Y_1\subseteq X-Y_2$. \\

(iii)$\implies $(i): Assume for a contradiction $X$ is reducible, says, $X=Y_1\cup Y_2$. One get a contradiction from noting $X-Y_1$ and $X-Y_2$ have empty intersection.  \\

(i)$\implies $(iv) follows from (i)$\implies $(ii) and \myref{Theorem}{IaC}. 
\end{proof}
\begin{theorem}
\textbf{(Continuity preserves irreducibility)} Let $X$ be an irreducible topological space and $f:X\rightarrow Y$ a continuous map. Then, the image $f(X)$ is irreducible. 
\end{theorem}
\begin{proof}
Use the \customref{irrtop}{first definition of irreducibility}. 
\end{proof}
By Zorn's Lemma\footnote{Clearly $\set{x}$ is irreducible. Let $E_n$ be an ascending chain of irreducible set containing  $x$. To see its upper bound is also irreducible, assume it isn't and cause a contradiction by showing  $E_n$ are reducible for large  $n$.}, every $x \in X$ has some not necessarily unique maximal irreducible set $Y$ containing $x$. We call these maximal irreducible sets  \textbf{irreducible components of $X$}. Because \customref{IaC}{closure of an irreducible set is also irreducible}, irreducible components are closed. For ease in \customref{Morphism}{future section on quasi variety morphism}, we note that: 
\begin{equiv_def}
\label{Qv}
\textbf{(Quasi variety)} If $V \subseteq X$ is irreducible closed and $Y \subseteq V$ is open in $V$, then  $\overline{Y}=V$.  
\end{equiv_def}
\begin{proof}
Clearly $\overline{Y}\subseteq V$. The converse $V \subseteq \overline{Y}$ follows from $\overline{Y}\cap V=\operatorname{cl}_V(Y)=V$, where the last equality holds true due to  \customref{irrtop}{equivalent definition of irreducibility}. 
\end{proof}
Let $X$ be a topological space and $Z\subseteq X$ an nonempty irreducible closed subset. A \textbf{generic point} for $Z$ is a point  $P \in Z$ such that $Z= \overline{\set{P}}$. A \textbf{closed point $P \in X$} is a point that makes $\overline{\set{P}}=\set{P}$. \\



Let $X$ be a topological space. We say $X$ is  \textbf{Noetherian} if its closed sets satisfy descending chain condition. Clearly, subspace $Y$ of Noetherian space $X$ is also Noetherian\footnote{Given $X_1\cap Y \supseteq X_2 \cap Y \supseteq\cdots $, we have $X_n \cap Y=X_1 \cap  \cdots \cap X_n\cap Y$, and the descending chain $X_1\supseteq X_1 \cap X_2 \supseteq \cdots$ must stop.}.  
\begin{equiv_def}
\label{Nt}
\textbf{(Noetherian topology)} Given topological space $X$, the followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $X$ is Noetherian 
  \item Open sets of $X$ satisfy ascending chain condition. 
  \item Every subset of $X$ is compact. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
  (i)$\implies $(ii) is clear.\\

  (ii)$\implies $(iii):  Assume for a contradiction $Y\subseteq X$ has an open cover $\mathcal{U}$ that has no finite subcover. Fix $E_1 \in \mathcal{U}$. Because $\mathcal{U}$ has no finite subcover, there exists $E_2 \in \mathcal{U}$ such that $E_2\cap Y-(E_1\cap Y)$ is nonempty, i.e., $E_1\cup E_2$ strictly contain $E_1$. Again, because $\mathcal{U}$ has no finite subcover, there exists $E_3 \in \mathcal{U}$ such that $E_3\cap Y - ((E_1 \cup  E_2) \cap Y)$ is nonempty. Repeating the same process, we construct a non-stopping ascending chain of open sets: $E_1 \subset E_1\cup E_2 \subset E_1 \cup  E_2 \cup E_3 \subset \cdots $, a contradiction. \\

  (iii)$\implies $(i): Let $F_n$ be a descending chain of closed subsets of  $X$. Clearly $X-F_n$ is an ascending chain and forms an open cover of $X- \bigcap F_n$. It follows from compactness of $X- \bigcap F_n$ that descending chain $F_n$ must stops permanently at some point.
\end{proof}
As we shall see, most of the topologies studied in this note are Noetherian, and indeed they have nice relationship with irreducibility. 
\begin{theorem}
\label{TfoL}
\textbf{(Topological form of Lasker-Noether Theorem)} If topological space $X$ is Noetherian, then for every nonempty closed $V\subseteq X$,  there always exists unique irreducible closed $V_1,\dots ,V_m \subseteq X$ such that 
\begin{gather}
V= V_1 \cup  \cdots \cup  V_m 
\end{gather}
and every $V_i$ is necessary in the sense that $\bigcup_{j\neq i}V_j\neq V$. 
\end{theorem}
\begin{proof}
Note that if $V$ can be written as some finite union of irreducible closed subsets, then we may delete the unnecessary terms so that every term in the union is necessary. We now prove that every $V$ can be written as a finite union of irreducible closed subset.\\  

Let $\mathscr{S}$ be the collection of nonempty closed subset of $X$ that can not be written as finite union of irreducible closed subsets. Assume for a contradiction that $\mathscr{S}$ is nonempty. Because $X$ is Noetherian, $\mathscr{S}$ have some minimal element, say $Y$. Because $Y$ is reducible, we may write $Y=Y_1\cup Y_2$, where $Y_1$ and $Y_2$ are both closed and contained strictly by $Y$. By minimality of $Y \in \mathscr{S}$, $Y_1$ and  $Y_2$ can both be written as finite union of irreducible closed subset, a contradiction\footnote{Because $Y=Y_1 \cup  Y_2$.}. \\

It remains to prove the uniqueness of expression of $V$, so suppose 
\begin{align*}
V= V_1 \cup  \cdots \cup  V_m = W_1 \cup  \cdots \cup  W_r
\end{align*}
where $V_i,W_j$ are all irreducible closed and "necessary". For each $i$, because $V_i$ is irreducible and $V_i = \bigcup (W_j \cap V_i)$, we have $V_i \subseteq W_j$ for some fixed $j$. The same argument yields $W_j\subseteq V_p$ for some fixed $p$. It then follows from the "necessity" that $V_i=W_j$. This implies uniqueness. 
\end{proof}
Let $X$ be a Noetherian topological space. \customref{TfoL}{Topological form of Lasker-Noether Theorem} tell us that $X$, uniquely, can be written as  $X=V_1\cup  \cdots \cup V_m$ where $V_i$ are all irreducible closed and necessary in this union. One may conjecture that these $V_i$ are exactly the irreducible components of $X$. This is true indeed. Fix $j$. To see  $V_j$ is an irreducible component, let $W$ be some irreducible component containing  $V_j$. We are required to show $W=V_j$. Because $W= \bigcup (W\cap V_i)$ and $W$ is an irreducible component\footnote{So $W\cap V_i$ are all closed. Recall that irreducible components are closed, since closure of irreducible set is also irreducible.}, we must have $W\subseteq V_l$ for some $l$. It then follows from the "necessity: that $j=l$ and  $V_j=W$. Conversely, let $W$ be some irreducible component of  $X$. We are required to show $W$ is one of $V_i$. Because $W$ is irreducible and  $W=\bigcup (W\cap V_i)$, we have $W \subseteq V_i$ for some $i$,which by maximality of $W$ implies  $W=V_i$.\\

We close this section by introducing the idea of variety dimension in a purely topological setting. Let $X$ be a topological space. We define the \textbf{dimension of $X$} to be the supremum of all integers $n$ such that there exists a chain $\varnothing =Z_0 \subset Z_1 \subset \cdots \subset Z_n$ of distinct irreducible closed subsets of $X$. Immediately we see same wanted property of our definition for dimension: Given subspace $Z\subseteq X$, we have $\operatorname{topdim}(Z)\leq \operatorname{topdim}(X)$.\footnote{To prove this, you will need: $Y_i$ closed in  $Y\implies Y_i=\overline{Y_i}\cap Y$.}. If $Z$ is moreover irreducible closed, we define the \textbf{topological codimension} $\operatorname{Cotopdim}(Z,X)$ to be the supremum of the length of chains of distinct irreducible subsets of $X$: 
\begin{align*}
Z\triangleq Z_0 \subset Z_1 \subset \cdots \subset Z_n \subseteq X
\end{align*}
If $Y$ is a closed subset of  $X$, we define: 
 \begin{align*}
\operatorname{Cotopdim}(Y,X)\triangleq \inf_{Z \subseteq Y} \operatorname{Cotopdim}  (Z,X)
\end{align*}
\begin{theorem}
\label{THcdim}
\textbf{(Properties of codimension)} Let $X$ be a topological space, $Y\subseteq X$ an irreducible closed subset, and $U \subseteq X$ open such that $U \cap Y$ nonempty. Then: 
\begin{align*}
\operatorname{Cotopdim}(Y,X)= \operatorname{Cotopdim}(Y \cap U,U)
\end{align*}
\end{theorem}
\begin{proof}
https://stacks.math.columbia.edu/tag/02I4
\end{proof}
\section{Affine variety}
Let $k$ be some field. We use  $\A^n$ to denote the \textbf{affine $n$-space} over $k$, the Cartesian product $k^n$. Given some collection $S \subseteq k[x_1,\dots ,x_n]$ of polynomials, we use $V(S)= \set{a \in \A^n:F(a)=0\text{ for all }F \in S}$ to denote its \textbf{vanishing set}, and given $X \subseteq \A^n$, we use notation $I(X)$ to denote the ideal of polynomials that vanish on $X$. If $X \subseteq \A^n$ is the vanishing set of some $S \subseteq k[x_1,\dots ,x_n]$, we say $X$ is \textbf{algebraic}. Clearly this give rise to a topology on $\A^n$, the  \textbf{Zariski topology}, in which $X\subseteq \A^n$ is closed if and only if $X$ is algebraic\footnote{Note that $V(S_1)\cup V(S_2)=V(\set{f_1f_2:f_1 \in S_1,f_2\in S_2})$ and $\bigcap V(S_\alpha )=V (\bigcup S_\alpha )$}. We call irreducible closed subset of $\A^n$  \textbf{affine variety}. Clearly, we have: 
\begin{align}
\label{ovlX}
 \overline{X}=V(I(X)),\quad \text{ for all }X \subseteq \A^n
\end{align}
and 
\begin{align*}
I(X)=I(\overline{X}),\quad \text{ for all }X \subseteq \A^n
\end{align*}
Even without putting any restriction on the ground fields, we see from \customref{HBT}{Hilbert Basis Theorem} and \myref{Equation}{ovlX} that $\A^n$ are always Noetherian, and we have the prime-irreducibility correspondence: 
\begin{theorem}
\label{Pic}
\textbf{(Prime-irreducibility correspondence)} For all  $X\subseteq \A^n$, 
\begin{align}
\label{XIX}
X\text{ is irreducible }\iff  I(X)\text{ is prime  }
\end{align}
\end{theorem}
\begin{proof}
Before the proof, we first make the remark that clearly for all $F,G \in k[x_1,\dots ,x_n]$, we have: 
\begin{align}
\label{FGI}
FG \in I(X)\iff  X= (X\cap V(F))\cup  (X\cap V(G))
\end{align}
$(\implies )$ in \myref{Equation}{XIX} is then an immediate consequence of $(\implies )$ in \myref{Equation}{FGI}.  \\

We now prove $(\impliedby)$ in \myref{Equation}{XIX}. Assume for a contradiction that $X=(X\cap V_1)\cup (X\cap V_2)$ for some $V_1,V_2$ such that neither of them covers $X$. Clearly, there exists some $F \in I(V_1)$ that doesn't vanish on the whole $X$. This $F$ satisfies $I(V_1)-I(X)$. Similar argument gives us some $G \in I(V_2)-I(X)$, but $FG \in I(X)$, a contradiction to $I(X)$ being prime. 
\end{proof}
Because  \customref{HBT}{Hilbert's Basis Theorem} only require the underlying ring of polynomials to be Noetherian, which all fields are, we can already deduce some important properties from the hypothesis (as weak as this hypothesis is) that $k$ is a field. For example, one may show $\A^n$ as a topological space is Noetherian\footnote{Given descending chain of closed subset $X_0\supset X_1 \supset \cdots \supset X_m$ of $\A^n$, we must have $I(X_0)\subset I(X_1)\subset \cdots \subset I(X_m)$ where the inequalities hold true because of \myref{Equation}{ovlX}. Now recall that \customref{HBT}{Hilbert's Basis Theorem} guarantees $k[x_1,\dots ,x_n]$ is Noetherian.}, every closed $X\subseteq \A^n$ is of the form $X=V(F_1,\dots ,F_m)$ for some $F_1,\dots ,F_m \in k[x_1,\dots ,x_n]$,\footnote{For its reason, consider \customref{EDoN}{the third equivalent definition of Noetherian module}.}  and $\A^n$ is irreducible if, moreover,  $k$ is infinite: 
\begin{theorem}
\label{PIP}
\textbf{(Polynomial Identity Principal)} Let $k$ be an infinite field and $F\neq 0 \in k[x_1,\dots ,x_n]$. There exists some nonzero $\textbf{a}\in \A^n$ such that $F(\textbf{a})\neq 0$.  
\end{theorem}
\begin{proof}
We prove by induction on $n$. Base case $n=1$ follows from fundamental theorem of algebra and taking algebraic closure  $\overline{k}$. Suppose the assertion hold true for $n-1$, and write 
 \begin{align*}
F(x_1,\dots ,x_n)= \sum_{i=0}^{d} G_i(x_1,\dots ,x_{n-1})x_n^i,\quad \text{ where }d=\operatorname{deg}_{x_n}F
\end{align*}
By inductive hypothesis, there exists some nonzero $(a_1,\dots ,a_{n-1})\in \A^{n-1}$ such that
\begin{align*}
G_d(a_1,\dots ,a_{n-1})\neq 0
\end{align*}
It then follows from the base case that there exists some nonzero $x_n \in k$ such that $F(x_1,\dots ,x_n)\neq 0$.  
\end{proof}
\begin{corollary}
\label{Asii}
\textbf{(Affine space is irreducible if the underlying field is infinite)} If field $k$ is infinite, then $\A^n$ as a topological space is irreducible. 
\end{corollary}
\begin{proof}
Suppose $\A^n=V(F_1,\dots ,F_r)\cup V(G_1,\dots ,G_m)$. Clearly  $F_1\cdots F_rG_1\cdots G_m$ vanishes on $\A^n$. This implies $F_1\cdots F_rG_1\cdots G_m=0 \in k[x_1,\dots ,x_n]$, which implies one of them is zero. Says, $F_1=0$. In such case, we see $V(F_1,\dots ,F_r)=V(F_2,\dots ,F_r)$ and 
 \begin{align*}
\A^n=V(F_2,\dots F_r)\cup  V(G_1,\dots ,G_m)
\end{align*}
Repeating the same argument, we see that either $F_1,\dots ,F_r$ are all zeros or  $G_1,\dots ,G_m$ are all zeros. 
\end{proof}
\myref{Corollary}{Asii} proves that affine spaces over infinite field are irreducible, and their every of its open set is a quasi variety. The situation of affine spaces over finite field is in fact even simpler: If $k$ is finite and nontrivial, then  $\A^n$ all have discrete topology\footnote{Every singleton is closed. $\set{\textbf{a}}$ is the vanishing set of $\set{x_1-a_1,\dots ,x_n-a_n}$.}, thus reducible. Therefore, whenever we use the term variety, its ground field must be infinite.
\begin{theorem}
\textbf{(Relationship between topological form and algebraic form of Lasker-Noether Theorem)} Let $X\subseteq \A^n$ be nonempty closed, $C_1,\dots ,C_t$ be its irreducible components and $\mathfrak{p}_1,\dots ,\mathfrak{p}_r\subseteq k[\textbf{x}]$ minimal prime ideals over $I(X)$. We have $r=t$ and by switching order,  $C_i=V(\mathfrak{p}_i)$. 
\end{theorem}
\begin{proof}
Observing that the ideal of any irreducible closed subsets of $X$ is a prime ideal over $I(X)$, we see that the 


Clearly, $V(\mathfrak{p}_i)$ are irreducible closed subset of $X$. 
\end{proof}


If $k$ is closed, we have the powerful \customref{HN}{ Nullstellensatz}:
\begin{align*}
I(V(I))=\sqrt{I},\quad \text{ for all ideal }I \subseteq k[x_1,\dots, x_n]
\end{align*}
As \myref{Equation}{ovlX} have already shown, functor: 
\begin{align*}
\set{X \subseteq \A^n : X\text{ is a variety.}}\xlongrightarrow{I} \operatorname{Spec}(k[x_1,\dots,x_n])
\end{align*}
is injective. \customref{HN}{Nullstellensatz} moreover shows that this functor is surjective. In particular, $I$ forms a bijection between points in $\A^n$ with  $\operatorname{Max}(k[x_1,\dots ,x_n])$\footnote{Using \customref{WfoN}{the weak form of Nullstellensatz}, if $\mathfrak{m}\subseteq k[x_1,\dots ,x_n]$ is maximal, then one construct isomorphism $\pfi: k[x_1,\dots ,x_n]\quotient \mathfrak{m}\to k$ and set $a_i\triangleq x_i$ to see $\pfi([f])=f(a)$ and $\set{a}=V(\mathfrak{m})$}. \\
\begin{theorem}
\textbf{(Hypersurface of affine space must be cutout by a single polynomial)} Let $k$ be closed. $X\subseteq \A^n$ has dimension $n-1$ if and only if  $X=V(F)$ for some nonconstant irreducible $F\in k[\textbf{x}]$. 
\end{theorem}
\begin{proof}

\end{proof}
\section{Projective variety}








Let $k$ be some field. Clearly, we may define on $k^{n+1} - \set{0}$ an equivalence relation by setting
\begin{align*}
a \sim  b \overset{\triangle}{\iff } a = \ld  b,\quad \text{ for some }\ld \in k
\end{align*}
Similar to the affine $n$-space, we use the notation $\P^n$  to represent the set of equivalence classes, and we use the notation $[x_0:\cdots :x_n]$ to denote the equivalence class that contains $(x_0,\dots ,x_n)$. Clearly, we may give the polynomial ring $k[x_0,\dots ,x_n]$ the obvious grading. Let $F \in k[x_0,\dots ,x_n]$ be homogeneous. Even though the value of $F$ on $\P^n$ is not well-defined, if $F$ is homogeneous then indeed it is well-defined whether $F(p)=0$ for fixed $p \in \P^n$, so it make sense for us to talk about the \textbf{(projective) algebraic set} $V(S)= \set{p \in \P^n: F(p)=0\text{ for all }F\in S}$ for every collection $S\subseteq k[x_1,\dots ,x_{n+1}]$ of homogeneous polynomial.  Again this give rise to \textbf{Zariski topology} on $\P^n$ where $E \subseteq \P^n$ is closed if and only if $E$ is algebraic, and again we say $X \subseteq \P^n$ is a \textbf{projective variety} if $X$ is irreducible closed.\\

Let $S_1$ and  $S_2\subseteq k[x_0,\dots ,x_n]$ be two collections of homogeneous polynomials that generate the same ideal. Clearly we have $V(S_1)=V(S_2)$. Therefore, given some homogeneous ideal $J \subseteq k[x_0,\dots ,x_n]$, we may well define algebraic $V(J)$. Trivially, for each $X \subseteq \P^n$,  the ideal generated by homogeneous $F \in k[x_0,\dots ,x_n]$ that vanishes on $X$ is homogeneous. We denote such ideal $I(X)$ and call it  \textbf{defining ideal of $X$} if $X$ is closed. \\

Immediately, we see that projective space have lots of similar property with affine space. For example, $\P^n$ is Noetherian, and similar to  \myref{Equation}{ovlX}, we have: 
\begin{align*}
\overline{X}=V(I(X)),\quad \text{ for all }X\subseteq \P^n
\end{align*}
And similar to the \customref{Asii}{fact that if the underlying filed is infinite, the affine space is irreducible}, we have:
\begin{theorem}
\label{Psii}
\textbf{(Projective space is irreducible if the underlying field is infinite)} If filed $k$ is infinite, then $\P^n$ is irreducible. 
\end{theorem}
\begin{proof}
  Suppose $\P^n=V(F_1,\dots ,F_r)\cup  V(G_1,\dots, G_m)$. Clearly $F_1\cdots F_rG_1\cdots G_m$ vanishes on $\P^n$. This implies  $F_1\cdots F_rG_1\cdots G_m$ vanishes on $\A^{n+1}- \set{\textbf{0}}$. Now, if we were able to prove $F_1\cdots F_rG_1\cdots G_m$ also vanishes  $\textbf{0}$, thus whole $\A^{n+1}$, then we may use the same argument in \myref{Corollary}{Asii}. To see that $F_1\cdots F_rG_1\cdots G_m$ also vanishes at $\textbf{0}$, just observe that because $F_1\cdots F_rG_1\cdots G_m$ is homogeneous, if it doesn't vanish at $\textbf{0}$, then $F_1,\dots ,F_r,G_1,\dots ,G_m$ are all nonzero constant, which is clearly impossible.
\end{proof}
Also we have the prime-irreducibility correspondence, whose proof in the projective setting requires some more algebraic effort. 
\begin{theorem}
\label{Ppic}
\textbf{(Projective prime-irreducibility correspondence)} For all $X\subseteq \P^n$, 
\begin{align*}
X\text{ is irreducible }\iff I(X)\text{ is prime }
\end{align*}
\end{theorem}
\begin{proof}
$(\implies )$: Let $F,G \in k[x_0,\dots ,x_n]$ satisfy $FG \in I(X)$. We are required to prove one of them belongs to $I(X)$. Let $F_1,\dots ,F_{d}$ and $G_1,\dots ,G_r$ be the (nonzero) homogeneous component of $F$ and $G$ with $\operatorname{deg}(F_i)<\operatorname{deg}(F_{i+1}),\operatorname{deg}(G_i)<\operatorname{deg}(G_{i+1})$ for all $i$. Because $F_dG_r$ is exactly the highest degree term  of $FG \in I(X)$ and because $I(X)$ is homogeneous, we know $F_dG_d \in I(X)$. Because $X$ is irreducible and because  $X=(X\cap V(F_d))\cup  (X\cap V(G_r))$, we now see $F_d \in I(X)$ or $G_r \in I(X)$. \\

WLOG, let $F_d \in I(X)$. There are two cases: either $G_r$ is in $I(X)$ or not. We first prove the case when $G_r$ isn't in $I(X)$. \\

Because $F_{d-1}G_r +F_dG_{r-1}$ is either zero or the second higher degree term of $FG \in I(X)$, we know $F_{d-1}G_r +F_dG_{r-1}\in I(X)$. This together with $F_d \in I(X)$ implies $F_{d-1}G_r \in I(X)$. It then follows from the  irreducibility of $X$ and $X=(X\cap V(F_{d-1}))\cup (X\cap V(G_r))$ that $F_{d-1}\in I(X)$. Similar arguments applies to show in order that $F_{d-2},\dots ,F_1 \in I(X)$, finishing the proof of the case $G_r \not \in  I(X)$. \\

For the case of $G_r \in I(X)$, just observe that $G_r \in I(X)\implies (F-F_d)(G-G_r)\in I(X)$, and repeat the arguments all over again.\\










$(\impliedby)$: Assume for a contradiction that $X=(X\cap V_1)\cup (X\cap V_2)$ for some $V_1,V_2$ such that neither of them covers $X$. Clearly, there exists some homogeneous $F \in I(V_1)$ that doesn't vanish on the whole $X$. This $F$ satisfies $I(V_1)-I(X)$. Similar argument gives us some homogeneous $G \in I(V_2)-I(X)$, but $FG \in I(X)$, a contradiction to $I(X)$ being prime. 
\end{proof}
Let $S\subseteq k[x_0,\dots ,x_n]$ be some homogeneous ideal or collection of homogeneous polynomials.  If necessary, we often distinguish the two vanishing sets in affine and projective setting by writing: 
\begin{align*}
V_\P(S)\triangleq  \big\{[x_0:\cdots :x_n] \in \P^n : F(x_0,\dots ,x_n)=0\text{ for all }F\in S\big\}
\end{align*}
and writing:
\begin{align*}
  V_\A(S) \triangleq  \set{(x_0,\dots ,x_n) \in \A^{n+1} : F(x_0,\dots ,x_n)=0\text{ for all }F \in S}. 
\end{align*}
\begin{theorem}
\label{Vso}
  \textbf{(Vanishing sets of collections of homogeneous polynomials are cones)} Let $\pi  :(\A^{n+1}-\set{\textbf{0}})\rightarrow \P^n$  be the quotient map. Given any collection $S\subseteq k[x_0,\dots ,x_n]$ of homogeneous polynomials, $V_\A(S)$ equals to either $\pi ^{-1}(V_\P(S))$ or  $\pi ^{-1}(V_\P(S))\cup  \set{\textbf{0}}$. 
\end{theorem}
\begin{proof}
It is trivial to check: 
\begin{align}
\label{pva}
\pi  (V_\A(S))= V_\P(S)
\end{align}
\myref{Equation}{pva} finishes the proof because it implies $V_\A(S)-\set{\textbf{0}}\subseteq \pi ^{-1}(V_\P(S))$ and implies $\pi ^{-1}(V_\P(S))\subseteq V_\A(S)$.
\end{proof}
Let $S\subseteq k[x_0,\dots ,x_n]$ be a collection of homogeneous polynomials. We often call $V_\A(S)$ \textbf{cone}. This notion helps us prove the following result. 
\begin{theorem}
\textbf{(Zariski topology on projective space is the quotient topology)} The quotient map $\pi :(\A^{n+1}-\set{\textbf{0}})\rightarrow \P^n$ is a topological quotient map. 
\end{theorem}
\begin{proof}
To prove that $\pi $ is a topological quotient, we need to show that $\pi $ is surjective, continuous, and every subset of $\P^n$ that has closed preimage is closed. Clearly $\pi $ is surjective. To see $\pi $ is continuous, just observe for every collection $S$ of homogeneous polynomials, we have 
\begin{align}
\label{pvs}
\pi (V_{\A}(S))= V_{\P}(S)
\end{align}
Note that if the underlying field is finite, then the Zariski topologies are discrete so the assertion holds trivially. We from now suppose the underlying field $k$ is infinite. Suppose $E\subseteq \P^n$ have closed preimage $\pi ^{-1}(E)=V_\A(T)- \set{\textbf{0}}$, where $T \subseteq k[x_0,\dots ,x_n]$. We show 
\begin{align*}
E= V_\P(\set{F_i \in k[x_0,\dots ,x_n]: F_i\text{ is the homogeneous component of some $F \in T$.}})
\end{align*}
The "$\supseteq$" holds true trivially. We now show the "$\subseteq$". Fix $F \in T$ with homogeneous decomposition $F= \sum F_i$. We are required to prove $F_i$ all vanish on  $E$. Fix $[x_0:\cdots :x_n] \in E$. We are required to prove all $F_i$ vanish at  $[x_0:\cdots :x_n]$. Define formal polynomial $p(y) \in  k[y]$ by: 
\begin{align*}
  p(y)\triangleq \sum F_i(x_0,\dots, x_n)y^i= \sum F_i (yx_0,\dots ,yx_n)
\end{align*}
Assume for a contradiction that there exists some  $F_i$ such that $F_i (x_0,\dots ,x_n)\neq 0$. Because $k$ is infinite, by \customref{PIP}{polynomial identity principal}, there exists nonzero $y' \in k$ such that $p(y')\neq 0$. However, because by definition $(y'x_0,\dots ,y'x_n)  \in \pi ^{-1}(E)$ and because $F$ vanish on  $\pi ^{-1}(E)$, we also have: 
\begin{align*}
 0= F(y'x_0,\dots ,y'x_n)= \sum F_i(y'x_0,\dots ,y'x_n)= p(y')
\end{align*}
a contradiction.
\end{proof}
We now enter the better behaved and smaller category: when the underlying field is algebraically closed. In particular, we prove the famous \textbf{projective Nullstellensatz}: 
\begin{theorem}
\textbf{(Homogeneous or Projective Nullstellensatz)} Given algebraically closed field $k$ and homogeneous ideal $\mathfrak{a} \subseteq k[x_0,\dots ,x_n]$, if $V(\mathfrak{a})$ is nonempty\footnote{This implies $\mathfrak{a}$ contains no nonzero constant.}, then 
\begin{align*}
I(V(\mathfrak{a}))=\sqrt{\mathfrak{a}} 
\end{align*}
\end{theorem}
\begin{proof}
Clearly we have: 
\begin{align*}
\sqrt{\mathfrak{a}}\subseteq I(V(\mathfrak{a}))
\end{align*}
We now prove $I(V(\mathfrak{a}))\subseteq \sqrt{\mathfrak{a}} $. Because \customref{HN}{affine Nullstellensatz} said that $\sqrt{\mathfrak{a}}=I(V_\A(\mathfrak{a}))$, we only have to prove $I(V_\P(\mathfrak{a}))\subseteq I(V_\A(\mathfrak{a})) $. Fixing homogeneous $F \in I(V_{\P}(\mathfrak{a}))$ and $\textbf{x}\in V_\A(\mathfrak{a})$, we are required to prove $F$ vanishes at $\textbf{x}$. If $F$ is zero, there is nothing to prove, so we from now on suppose $F$ is nonzero. Because by premise $V_\P(\mathfrak{a})$ is nonempty, we know $F$ can not be nonzero constant. In other words, homogeneous $F$ have positive degree. \myref{Theorem}{Vso} said that $V_\A(\mathfrak{a})$ either equals to $\pi^{-1}(V_\P(\mathfrak{a}))$ or $\pi ^{-1}(V_\P(\mathfrak{a}))\cup \set{0}$. If $\textbf{x}=\textbf{0}$, then $F$ vanishes at  $\textbf{x}$ because $F$ is homogeneous with positive degree. If  $\textbf{x}\in \pi ^{-1}(V_\P( \mathfrak{a}))$, then $F$ vanishes at $\textbf{x}$ because it vanishes at $\pi (\textbf{x})$. 
\end{proof}
\begin{theorem}
\textbf{(Special case of projective Nullstellensatz)} Given algebraically closed field $k$ and homogeneous ideal $\mathfrak{a}\subseteq k[x_0,\dots ,x_n]$, the followings are equivalents: 
\begin{enumerate}[label=(\roman*)]
  \item $V_\P(\mathfrak{a})$ is empty. 
  \item $\sqrt{\mathfrak{a}}=k[x_0,\dots ,x_n]$ or $\sqrt{\mathfrak{a}}=\set{F \in k[x_0,\dots ,x_n]:F(0)=0}$. 
\end{enumerate}
\end{theorem}
\begin{proof}
(i)$\implies $(ii):  \myref{Theorem}{Vso} implies $V_\A(\mathfrak{a})$ either is empty or contains only the origin. This together with \customref{HN}{affine Nullstellensatz} proves (ii).\\

(ii)$\implies $(i): \customref{HN}{Affine Nullstellensatz} said that $I(V_\A(\mathfrak{a}))=\sqrt{\mathfrak{a}}$. No matter which one  $\sqrt{\mathfrak{a}}$ actually is, it must contains $\set{x_0,\dots ,x_n}$. This implies $V_\A(\mathfrak{a})\subseteq \set{0}$, which proves (i) by \myref{Theorem}{Vso}. 
\end{proof}
\section{Quasi variety morphism}
\label{Morphism}
By a \textbf{quasi affine (or projective) variety} $X\subseteq \A^n$ (resp. $\P^n$), we mean  $X$ is a subset of some variety $V \subseteq \A^n$ (resp. $\P^n$) and $X$ is open in $V$, or equivalently\footnote{See \myref{Equivalent Definition}{Qv} and \myref{Corollary}{IaC}} that $X$ is irreducible and open in its closure.   \\

A \textbf{normal variety} is a variety whose local ring at each point is regular. Because regular local rings are integrally closed domain\footnote{This is highly nontrivial.}, smooth varieties are normal.     
\begin{equiv_def}
\textbf{(Normal variety in $\C\P^n$)} Let $X\subseteq \C \P^n$ be a variety. $X$ is normal if and only if  there exists some collection of open $U_{\alpha }\subseteq X$ such that:
\begin{enumerate}[label=(\roman*)]
  \item $X= \bigcup U_\alpha $. 
  \item $U_\alpha $ are quasi-variety isomorphic to some affine variety. 
  \item Coordinate rings  $A(U_\alpha )$ of $U_\alpha $ are integrally closed domain.  
\end{enumerate}
\end{equiv_def}
\begin{proof}

\end{proof}
\begin{equiv_def}
\textbf{(Serre's criteria for normality)} Let $A$ be an Noetherian ring. $A$ is integrally closed domain if and only if for each $\mathfrak{p}\in \operatorname{Spec}(A)$, we have $\operatorname{ht}(\mathfrak{p})\leq 1$, $A_{\mathfrak{p}}$ is regular, and $\operatorname{depth}(A_{\mathfrak{p}})\geq \operatorname{inf} \set{2,\operatorname{ht}(\mathfrak{p})}$. 
\end{equiv_def}
\begin{proof}

\end{proof}

Given some quasi affine variety $X\subseteq \A^n$ and $f:X \rightarrow  k$, we say $f$ is \textbf{regular at $p \in X$} if there exist $U\subseteq X$ open in $X$ containing $p$ and exist $G,H \in k[x_1,\dots ,x_n]$ such that $H$ nonzero on $U$ and  $f=G\quotient H$ on $U$. In the projective setting, says $X \subseteq \P^n$ is a quasi projective variety and $f$ maps $X$ into  $k$, we say $f$ is \textbf{regular at $p \in X$} if there exists $U \subseteq X$ containing $p$ and open in $X$ such that there exists homogeneous $G,H \in k[x_0,\dots,x_n]$ such that $H$ nonzero on $U$, $f=G\quotient H$ on $U$, and $G,H$ have same degree. Given a quasi variety $X$, we say  $f:X\rightarrow k$ is \textbf{regular} if it is regular at each points of $X$. Here, we make the important remark that the set of regular functions $f:X\rightarrow k$ always form a ring. \label{rorf} 
\footnote{It is IMPORTANT to deduce that regular functions indeed forms a ring here, since it is impossible to later check transitivity of \myref{equivalence}{UCO} purely topologically, without using the algebraic result of one regular functions minus another is still regular, thus continuous. I guess the moral of the story here is that one must remember  $\A^1$ is a field, and thus have a field structure, which shall be used when topological method doesn't work; or that if something forms an algebraic structure, then utilize that structure as much as possible.  Indeed, we are talking about ALGEBRAIC geometry here.}
\begin{theorem}
\label{Rfac}
\textbf{(Regular functions are continuous)} Given quasi variety $X\subseteq \A^n$ (or $\P^n$), if $f:X\rightarrow k$ is regular, then $f$ is continuous.  
\end{theorem}
\begin{proof}
Because every closed set in $k$ is either finite or the whole space\footnote{To see such, consider \customref{HBT}{Hilbert Basis Theorem} and fundamental theorem of algebra.}, we only have to show $f^{-1}(a)$ is closed for fixed $a \in k$. Let $(U_i,G_i,H_i)_{i \in I}$ cover $X$, where $H_i$ nonzero and $f=G_i\quotient H_i$ on $U_i$. Because $X$ is coherent\footnote{You may Google what does \textbf{coherent topology} mean. To see that every topological space $X$ and any of its open cover $U_i$ are always coherent, just observe for any $Z\subseteq X$, we have $Z = \bigcup (U_i\cap Z) $ and $X-Z= \bigcup (U_i -Z)$.} with  $(U_i)_I$, we only have to show $U_i\cap f^{-1}(a)$ is closed in $U_i$ for fixed $i\in I$, which follows from noting $U_i\cap f^{-1}(a)=V(G_i-aH_i)\cap U_i$. 
\end{proof}

Let $X$ be a quasi variety with $p \in X$. Consider the collection of all $(U\subseteq X,f:U\rightarrow k)$, where $U$ is nonempty open and  $f$ is regular, because \customref{Rfac}{regular functions are continuous} and \customref{irrtop}{nonempty open subset of irreducible space is always dense}, we may well define an equivalence relation by: 
\begin{align}
(U,f)\sim (O,g)\overset{\triangle}{\iff }f=g\text{ on }U \cap O \label{UCO}
\end{align}
to form the \textbf{function field} $K(X)$ of $X$. The germ-based (equivalence class) approach to defining function fields provides a way to collect all possible regular "functions" on a variety \( X \). These regular functions need not be defined on all of \( X \), but only on some nonempty open subset of it.  Given any $[(U,f)]\in K(X)$, there exists a unique representative \( (U_{\max}, f_{\max}) \) such that \( f_{\max} \) is defined on the largest open subset of \( X \) where all representatives agree. We refer to this representative when writing \( f \in K(X) \), implicitly identifying the element of the function field with its maximal domain. We say that a function \( f \in K(X) \) is \textbf{defined at} a point \( x \in X \) if the maximal representative of \( f \) is defined at \( x \). \\


Let $f\in K(X)$. If $f$ is defined and doesn't vanish at at $p$, then clearly there exists $g \in K(X)$ such that $fg=1$ on some neighborhood of  $p$. This implies that indeed $K(X)$ is a field. Clearly, the collection of all $f \in K(X)$ that are defined at $p$ forms a ring, which we denote as $\mathscr{O}_{p,X}$. Moreover, clearly the units of $\mathscr{O}_{p,X}$ are exactly those who doesn't vanish at $p$, which implies the non-units, those vanish at  $p$, forms an ideal of $\mathscr{O}_{p,X}$, justifying the convention of calling $\mathscr{O}_{p,X}$ the \textbf{local ring of $X$ at $p$}\footnote{Recall that if the set of non-units forms an ideal, then the ring is local.}. Moreover, clearly the collection of all $f \in K(X)$ that are globally defined also forms a ring, which we denote by $\mathscr{O}(X)$. Note that the three structures are all $k$-algebras.  \\

Let $X$ be some quasi variety, and let $U \subseteq X$ be open nonempty. Given $u \in U$, we identify  $K(U)=K(X)$ and $\mathscr{O}_{u,U}=\mathscr{O}_{u,X}$ as $k$-algebras the obvious way\footnote{Every element of $K(U)$ is a subset of some unique element of $K(X)$.}. Let $Y$ be another quasi variety. We say $\phi : U\rightarrow Y$ is a \textbf{quasi variety morphism} if $\phi$ is continuous and for every $f\in K(Y)$, the function $f \circ \phi:\phi^{-1}(\operatorname{Dom}f)\rightarrow k$ is regular. Clearly, this induces a $k$-algebra homomorphism  $\phi^*:K(Y)\rightarrow K(U)=K(X)$ defined by 
\begin{align*}
[(W,f)] \mapsto [(\phi^{-1}(W),f \circ \phi)]
\end{align*}
which we call \textbf{the dual map of $\phi$}, and clearly it always map  $\mathscr{O}_{y,Y}$ into $\bigcap_{x \in \phi^{-1}(y)}\mathscr{O}_{x,X}$.\\

If we say  $\phi : X\rightarrow Y$ is a \textbf{quasi variety isomorphism}, we mean that $\phi$ is bijective with its inverse being also a quasi variety morphism. Clearly, if $X,Y$ are quasi variety isomorphic, then we have three pairs of isomorphic $k$-algebras. Because of such, we often say $\mathscr{O}(X),\mathscr{O}_{p,X}$, and $K(X)$ are \textbf{invariant up to quasi variety isomorphisms}. As we shall show later in \customref{Rm}{the section on rational map}, unlike ring of globally defined regular function, $K(X)$ is in fact invariant up to a even weaker condition if we consider only varieties. 
\begin{theorem}
\label{Iaoi}
\textbf{(If and only if test for quasi variety mapping whose target is affine)} Given quasi variety mapping $\phi :X\rightarrow Y \subseteq \A^n$, 
\begin{align*}
\phi \text{ is a quasi variety morphism. }\iff  x_i\circ \phi:X\rightarrow k\text{ are all regular. }
\end{align*}
\end{theorem}
\begin{proof}
$(\implies )$ follows from definition. We now prove  $(\impliedby)$. Clearly, because regular function on $X$ is closed under addition and multiplication  \customref{rorf}{as noted before}, for all $F\in k[x_1,\dots ,x_n]$, the function $F\circ \phi$ must be regular. It then follows from \customref{Rfac}{continuity of regular functions} and 
\begin{align*}
\phi^{-1}(V(S)\cap Y)= \bigcap_{F \in S} (F\circ \phi)^{-1}(0),\quad \text{ for any }S \subseteq k[x_1,\dots ,x_n]
\end{align*}
that $\phi$ is continuous. Fix $(U,g)\in K(Y)$ and $p \in \phi^{-1}(U)$. It remains to prove $g \circ \phi:\phi^{-1}(U)\rightarrow k$ is regular at $p$. Because $U\xrightarrow{g}k$ is regular, there exists open $O\subseteq U$ containing $\phi (p)$ such that $g=\frac{H_1}{H_2}$ on $O$ for some  $H_1,H_2 \in k[x_1,\dots ,x_n]$ where $H_2$ nonzero on whole $O$ and degree of them being the same if $X$ is projective. Clearly, 
\begin{align*}
g\circ \phi = \frac{H_1 \circ \phi}{H_2 \circ \phi},\quad \text{ on }\phi^{-1}(O).
\end{align*}
Because $H_1 \circ \phi$ and $H_2 \circ \phi$ are regular as function from $X$ to $k$ as we proved in the first paragraph of this proof, we know there exists open $V \subseteq \phi^{-1}(O)$ containing $p$ such that 
\begin{align*}
H_1\circ \phi= \frac{F_1}{F_2} \text{ and }H_2 \circ \phi= \frac{F_3}{F_4},\quad \text{ on }V
\end{align*}
for some polynomials $F_1,F_2,F_3,F_4$, with $F_2,F_4$ nonzero on $V$ and the pairs having the same degree if  $X$ projective. This give us 
\begin{align*}
g\circ \phi = \frac{F_1F_4}{F_2
F_3},\quad \text{ on }V
\end{align*}
where $\operatorname{deg}(F_1F_4)=\operatorname{deg}(F_2F_3)$ if $X$ is projective. We have shown that indeed $g \circ \phi$ is regular at $p$. 
\end{proof}
\begin{corollary}
\label{Qve}
  \textbf{(Quasi variety embedding of complement of hypersurface in infinite affine space into one-higher dimensional affine space as a hypersurface)} Let $k$ be infinite and $F \in k[x_1,\dots ,x_n]$. The projection $\pi :\A^{n+1}\rightarrow \A^n$ 
\begin{align*}
  (x_1,\dots ,x_{n+1})\rightarrow (x_1,\dots ,x_n)  
\end{align*}
when restricted onto $V(x_{n+1}F-1)$ is a quasi variety isomorphism from $V(x_{n+1}F-1)$ to $\A^n-V(F)$. 
\end{corollary}
\begin{proof}
It is easy to check that $\pi$ restrict to a bijection between $V(x_{n+1}F-1)$ and $\A^n-V(F)$ with the inverse being $(\textbf{a})\mapsto (\textbf{a},F^{-1}(\textbf{a}))$. It then follows from  \myref{Theorem}{Iaoi} that indeed the restriction of $\pi $ forms a quasi variety isomorphism. 
\end{proof}
One particular key observation on \myref{Theorem}{Iaoi} is that it proves the continuity of a given map WITHOUT constructing pullbacks of polynomials, but simply claim the preimage of vanishing set is closed via \customref{Rfac}{continuity of regular functions}. A nontrivial technique indeed, go on to show the importance of \customref{Rfac}{continuity of regular functions}. 
We close this section by proving \myref{Theorem}{Ste}, which will prove pivotal in later development, as it reduce lots of argument in the projective setting back to affine space. For ease in its proof, we first introduce two notions. Let $S$ be the collection of homogeneous elements of $k[x_0,\dots ,x_n]$. Clearly, we may well-define mappings  $\alpha :S \to k[x_1,\dots ,x_n]$ and $\beta :k[x_1,\dots ,x_n]\to S$ by 
\begin{align*}
\alpha (F)\triangleq F(1,x_1,\dots ,x_n)\text{ and }\beta (G)\triangleq x_0^{\operatorname{deg}(G)} G\left(\frac{x_1}{x_0},\dots ,\frac{x_n}{x_0}\right)
\end{align*}
Let $F \in S$ and $G \in k[x_1,\dots ,x_n]$. We refer to $\alpha (F)$ as the \textbf{dehomogenization} of $F$, and we refer to $\beta (G)$ as the \textbf{homogenization} of $G$. Actions of homogenization are actually easy to memorize. For example, homogenization send $x_2-x_1^2$ to  $x_0x_2-x_1^2$, and send  $x_2-x_1^3$ to  $x_2x_0^2-x_1^3$. Dehomogenization sends $x_0x_2^2+x_1^3$ to  $x_2^2+x_1^3$. 
\begin{theorem}
\label{Ste}
\textbf{(Standard embedding of $\A^n$ into  $\P^n$)} Let  $U\triangleq \P^n - V(x_0)$. The map $\phi: U\rightarrow \A^n$  defined by 
\begin{align*}
\phi \left([x_0:\cdots :x_n]\right)\triangleq \left(\frac{x_1}{x_0},\dots ,\frac{x_n}{x_0}\right)
\end{align*}
is a well-defined homeomorphism, and moreover a quasi variety isomorphism if the underlying field $k$ is infinite.  
\end{theorem}
\begin{proof}
It is routine to check $\phi$ is well-defined and bijective. We now prove it is indeed bicontinuous. Let $Y\subseteq U$ be closed in $U$, and let $\overline{Y}$ be the closure of $Y$ in $\P^n$. By definition, there exists some collection  $T$ of homogeneous polynomials $F \in k[x_0,\dots ,x_n]$ whose locus is exactly $\overline{Y}$. To see $\phi (Y)$ is closed, just check $\phi (Y)$ is the locus of the dehomogenizations of $T$. Conversely, given closed $W \subseteq \A^n$, we know there exists $T\subseteq k[x_1,\dots ,x_n]$ whose  locus is exactly $W$. To see $\phi ^{-1}(W)$ is closed, just check that $\phi^{-1}(W)$ is the intersection between $U$ and the locus of the homogenization of $T$. We have shown $\phi$ is indeed a homeomorphism.\\

From now on suppose $k$ is infinite, and we wish to prove $\phi$ is moreover a quasi-variety isomorphism. To see $U$ is indeed a quasi variety, note that  \customref{Psii}{ projective space is irreducible when underlying field is infinite} and that \customref{irrtop}{nonempty subset of irreducible space is dense}.\\

Fix $(O,f) \in K(\A^n)$, where, WLOG, $f=F\quotient G$ on $O$ for some  $F,G \in k[x_1,\dots ,x_n]$ such that $G$ nonzero on  $O$. To see $\phi$ is indeed a morphism, just check $f \circ \phi|_{\phi^{-1}(O)}=(x_0^{\operatorname{deg}(G)}\tilde{F} )\quotient (x_0^{\operatorname{deg}(F)}\tilde{G} )$, where $\tilde{F}$ and $\tilde{G}$ are the homogenization of $F$ and  $G$. Fix $(O,f) \in K(U)$, where, WLOG, $f=F\quotient G$ on $O$ for some same degree homogeneous $F,G \in k[x_0,\dots ,x_n]$ such that $G$ nonzero on $O$. To see $\phi^{-1}$ is indeed a morphism, just check $f \circ \phi^{-1}|_{\phi (O)}=F_0\quotient G_0$, where $F_0$ and  $G_0$ are the dehomogenization of $F$ and  $G$.  
\end{proof}
\section{Coordinate ring and function field}
Given an affine quasi variety $X\subseteq \A^n$, its \textbf{coordinate ring}  $A(X)$ is $A\quotient I(X)$, which is clearly isomorphic to the ring of function $f:X\rightarrow k$ such that $f=F|_X$ for some $F \in k[x_1,\dots ,x_n]$\footnote{We call these functions \textbf{polynomial functions}.}. Because of the \customref{Pic}{prime-irreducibility correspondence in affine setting}, the coordinate of affine quasi variety is an integral domain. Later we will see more usage of the realization of  $\Gamma (X)$ as ring of polynomial functions in the proof of \myref{Theorem}{Asog}. 
\begin{theorem}
\label{Asog}
\textbf{(Algebraic structure of global ring, local ring, and function field of affine quasi variety)} If $X \subseteq \A^n$ is an affine quasi variety, then 
\begin{enumerate}[label=(\roman*)]
  \item $\mathscr{O}(X)\cong \Gamma (X)$. 
  \item For all $p \in X$, if we let $\mathfrak{m}_p\subseteq \Gamma (X)$ be the maximal ideal corresponding to $p$, then  $\mathscr{O}_{p,X}\cong \Gamma (X)_{\mathfrak{m}_p}$.
  \item $K(X)\cong  \operatorname{Frac}(\Gamma X)$.  
\end{enumerate}
\end{theorem}
\begin{proof}
Before the proof, we first remark that: If we fix $p$, regarding $\Gamma (X)$ either as the ring of polynomial function $f:X\rightarrow  k$ or as the quotient  $k[x_1,\dots ,x_n]\quotient I(X)$ makes no mathematical differences. In the former, $I(p)\subseteq \Gamma (X)$ is the ring of polynomial functions that vanishes at $p$, and in the latter,  $I(p)\subseteq \Gamma (X)$ is the image of $I(p)\subseteq k[x_1,\dots ,x_n]$  under the quotient map $k[x_1,\dots ,x_n] \twoheadrightarrow k[x_1,\dots ,x_n]\quotient I(X)$. Either way, the  $I(p)\subseteq \Gamma (X)$ is what we meant by $\mathfrak{m}_p$ in (ii), and using the latter point of view with the bijection between $\A^n$ and $\operatorname{Max}(k[x_1,\dots,x_n])$, we have a bijection between $X$ and $\operatorname{Max}(\Gamma X)$: $p\leftrightarrow \mathfrak{m}_p=I(p)$. \\


Fix $p$. Let $\beta  :\Gamma (X)_{\mathfrak{m}_p}\rightarrow \mathscr{O}_{p,X}$ be the obvious mapping\footnote{From $\beta $ you can see that the done localization $\Gamma (X)_{\mathfrak{m}_p}$ is of geometrical nature, not algebraic.}: $F\quotient G\mapsto [(U,F\quotient G)]$ where $F,G:X\rightarrow k$ are polynomial function and $U=\set{x \in X:G(x)\neq 0}$. Clearly $\beta $ is an injective ring homomorphism\footnote{Note that $[(U,f)]=0 \in \mathscr{O}_{p,X}$ if and only if $f=0$ on  $U$, since if $f\neq 0$ on $U$, then  $f+f\neq f$. This implies injectivity of $\beta $ since $f^{-1}(0)\subseteq X$ is closed in $X$, containing  $g^{-1}(k^\times) \subseteq X$, whose closure in $X$ are  $X$.  ($\because Z \subseteq Y \subseteq X \implies \operatorname{cl}_Z(Y)=\operatorname{cl}_X(X)\cap Y$) }. To see $\beta $ is surjective, just recall the definition of regular function. We have constructed isomorphism  $\beta :\Gamma (X)_{\mathfrak{m}_p}\rightarrow \mathscr{O}_{p,X}$, proving (ii). The same argument works for constructing isomorphism $\operatorname{Frac}(\Gamma X)\cong  K(X)$, proving (iii).\\

  Let $\alpha :\Gamma (X)\rightarrow \mathscr{O}(X)$ be the obvious mapping, which is clearly an injective ring homomorphism. It remains to prove $\alpha $ is surjective, which follows from checking the diagram: 
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXEdhbW1hKFgpIl0sWzAsMiwiXFxiaWdjYXBfe30iXSxbMiwwLCJcXGJ1bGxldCJdLFsyLDIsIlxcYnVsbGV0Il0sWzAsMl0sWzAsMSwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiYXJyb3doZWFkIn19fV0sWzEsMywiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiYXJyb3doZWFkIn19fV0sWzIsM11d
\[\begin{tikzcd}
	\Gamma(X) && \mathscr{O}(X) \\
	\\
  \bigcap \limits_{\mathfrak m\in\operatorname{Max}(\Gamma X)}(\Gamma X)_\mathfrak{m} && \bigcap \limits_{p \in X}\mathscr{O}_{p,X}
	\arrow["\alpha" ,from=1-1, to=1-3]
	\arrow[double_arrow , from=1-1, to=3-1]
	\arrow[hook,from=1-3, to=3-3]
	\arrow[double_arrow , from=3-1, to=3-3]
\end{tikzcd}\]
\footnote{The left isomorphism is explained in \customref{sam}{this paragraph} of  \myref{Section}{Lalr}, the bottom isomorphism is from (ii), and the right injective homomorphism is from \customref{sam2}{this paragraph} of this section.}is indeed commutative, where the left and right sides are, respectively, subrings of $\operatorname{Frac}(\Gamma X)$ and $K(X)$. 
\end{proof}
It may seem surprising that $\mathscr{O}(X) \cong \Gamma(X)$, since one might expect the former to be a localization of the latter, given that regular functions are defined locally as quotients of global polynomial functions. However, this apparent tension is actually a valuable opportunity to distinguish between the local and global perspectives: regularity is inherently a local notion. Indeed, by definition, a function $f : X \to k$ is regular if, locally, it can be written as a fraction $G/H$ with $G, H \in \Gamma(X)$.\\

In fact, if one attempts to show that $\mathscr{O}_{p,X}$ is the localization $({f \in \mathscr{O}(X) : f(p) \neq 0})^{-1} \mathscr{O}(X)$ that is, to verify that the obvious map $\mathscr{O}(X) \to \mathscr{O}_{p,X}$ satisfies the universal propertywithout invoking \myref{Theorem}{Asog}, one quickly encounters difficulties and will be forced to use isomorphism $\mathscr{O}(X) \cong \Gamma(X)$\footnote{As the action of isomorphism $\alpha $ in \myref{Theorem}{Asog} suggest, one can really just write $\mathscr{O}(X)=\Gamma (X)$ }.  \\

Now, let $X,Y$ be two quasi varieties  with $Y$ affine. It is clear that the three structures $\mathscr{O}(X),\mathscr{O}_{p,X},$ and $K(X)$ all admit obvious $k$-algebra structures, and from the proof of \myref{Theorem}{Asog}, the ring isomorphism $\mathscr{O}(Y)\cong \Gamma (Y)$ is also a $k$-algebra isomorphism.
\begin{theorem}
\label{If}
\textbf{(Induction forms a bijection between set of quasi varieties of morphism and set of $k$-algebra homomorphism from target's coordinate ring to source's global ring if target is affine)} Let $X,Y$ be two quasi varieties  with $Y\subseteq \A^n$. Denoting the collection of quasi variety morphisms $X \rightarrow Y$ by $\operatorname{Hom}(X,Y)$ and the collection of  $k$-algebra homomorphism $\Gamma (Y)\rightarrow \mathscr{O}(X)$ by $\operatorname{Hom}(\mathscr{O}(X),\Gamma (Y))$, clearly we can well define a map  $\operatorname{Hom}(X,Y)\xrightarrow{\alpha }  \operatorname{Hom}(\Gamma (Y),\mathscr{O}(X))$ by 
\begin{align*}
\phi \mapsto  (\tilde{\phi}:\Gamma (Y)\rightarrow \mathscr{O}(X)),\quad \text{ where }\tilde{\phi} (F)\triangleq  F \circ \phi. 
\end{align*}
Such $\alpha $ is bijective. 
\end{theorem}
\begin{proof}
Fix $h\in \operatorname{Hom}(\Gamma (Y),\mathscr{O}(X))$. Consider $x_i \in \Gamma (Y),\xi_i\triangleq h(x_i) \in \mathscr{O}(X)$, and $\psi: X\rightarrow \A^n$ defined by $\psi(p)\triangleq (\xi_1(p),\dots ,\xi_n(p))$. Because $\alpha $ is clearly injective\footnote{A direct proof suffices. It is easy to construct $F \in k[x_1,\dots ,x_n]$ for arbitrary $p_1 \neq p_2 \in \A^n$ that satisfies $F(p_1)\neq F(p_2)$.}, our end goal here is to show that $\psi \in \operatorname{Hom}(X,Y)$ and $h= \tilde{\psi}$. \\

Because $Y=V(I(Y))$, to show that $\psi$ at least forms a map from $X$ to $Y$, we only have to show  $F\circ \psi=0 $ for any fixed $F \in I(Y)$. Because $h$ is a $k$-algebra homomorphism and  $F$ in $k$-algebra  $\Gamma (Y)$ can be appropriately (See footnote) generated by $x_i$, we have $h(F)=F(h(x_1),\dots ,h(x_n))$\footnote{For example, $h(x_1^2+x_2)=(h(x_1))^2+h(x_2)$. Note that the $F$ on the left hand side is an element of $\Gamma (Y)$, and that the $F$ on the right hand side is an actual polynomial.}. This by definition of $\xi$ and $\psi$ give us
\begin{align}
\label{hFF}
h(F)=F(\xi_1,\dots ,\xi_n)= F \circ \psi
\end{align}
This together with the fact  $F$ as an element of $\Gamma (Y)$ is zero implies, indeed, $F \circ \psi=0$. \\

Noticing that \myref{Equation}{hFF} also holds true for any $F \in \Gamma (Y)$\footnote{Perhaps here it will be better to write $ k[x_1,\dots ,x_n]$ in place of $\Gamma (Y)$.} that's not in $I(Y)$, we conclude that if $\psi$ really is a morphism, then we will have $h=\tilde{\psi}$. Therefore, it only remains to show $\psi$ is indeed a morphism, which follows from $x_i \circ \psi = \xi_i \in \mathscr{O}(X)$ for all $x_i \in k[x_1,\dots ,x_n]$ and \myref{Test}{Iaoi}.
\end{proof}
\begin{corollary}
\textbf{(Quasi affine varieties are isomorphic if and only if their coordinate ring are isomorphic as $k$-algebra)} Let $X,Y$ be two quasi affine variety. We have 
 \begin{align*}
X,Y\text{ isomorphic as quasi variety }\iff \Gamma (Y),\Gamma (X)\text{ isomorphic as $k$-algebra. }
\end{align*}
\end{corollary}
\begin{proof}
If $\phi:X\rightarrow Y$ is a quasi variety isomorphism, then  $\tilde{\phi}:\Gamma (Y)\rightarrow \Gamma (X)$ is a $k$-algebra isomorphism with inverse $\tilde{\phi^{-1}}:\Gamma (X)\rightarrow \Gamma (Y)$. If $\pfi: \Gamma (Y)\rightarrow \Gamma (X)$ is a $k$-algebra isomorphism, then the unique morphism  $\phi: X\rightarrow Y $ that satisfies $\tilde{\phi}=\pfi$ is an isomorphism with the obvious inverse.  
\end{proof}
Given a projective quasi variety $X \subseteq \P^n$, we also use notation $\Gamma (X)$ to denote its \textbf{homogeneous coordinate ring} $k[x_0,\dots ,x_n]\quotient I(X)$, where $I(X)$ are the defining ideal of $X$, the ideal generated by homogeneous polynomials vanishing on  $X$. We have shown that coordinate rings of affine quasi varieties are invariant up to isomorphisms, and we are going to show coordinate rings of projective quasi varieties are not.  
\begin{theorem}
\label{Ogot}
  \textbf{(Obvious grading of the quotient of graded ring)} Given $\Z_0^+$-graded ring $A$, homogeneous ideal $I \subseteq A$, and quotient ring $\pi :A \twoheadrightarrow A\quotient I $, we have a well defined $\Z_0^+$-grading on $A\quotient I$:
\begin{align*}
A\quotient I = \bigoplus_{n\geq 0} \pi  (A_n)
\end{align*}
\end{theorem}
\begin{proof}
Clearly $\pi (A_n)$ all form groups, and $A\quotient I = \sum \pi  (A_n)$. It remains to show the sum is direct. Suppose 
 \begin{align*}
\pi (a_{n_{r}})= \sum_{i=1}^{r-1} \pi (a_{n_i}),\quad \text{ where $n_i$ distinct and } a_{n_i} \in A_{n_i}
\end{align*}
We are required to show $a_{n_r} \in I$. Clearly, we have $n_r>n_i$ for all $i<r$ and 
\begin{align*}
a_{n_r}- \sum_{i=1}^{r-1}a_{n_i} \in I
\end{align*}
This implies 
\begin{align*}
a_{n_r}= \sum_{i=1}^{r-1} a_{n_i} + b,\quad \text{ for some }b \in I
\end{align*}
Note that $I$ is homogeneous, so there exists unique decomposition of $b=a_{n_r}-\sum_{i=1}^{r-1}a_{n_i}$ as elements of $A_n \cap I$. By comparing the degrees of the elements of the unique decomposition of $b$ and $a_{n_r}-\sum_{i=1}^{r-1}a_{n_i}$, we see that the unique decomposition of $b$ is exactly $a_{n_r}-\sum_{i=1}^{r-1}a_{n_i}$, i.e., $a_{n_i} \in I$ for all $i\leq r$. 
\end{proof}
Let $X$ be a projective quasi variety. From now on, we regard $\Gamma (X)$ as a $\Z_0^+$-graded ring, whose grading come from \myref{Theorem}{Ogot}. \\

Let $A$ be a graded ring, and $\mathfrak{p}\subseteq A$ a homogeneous prime ideal. Clearly the set $S$ of homogeneous elements not in $\mathfrak{p}$ forms a multiplicatively closed subset.  
\begin{theorem}
\label{Ogoh}
\textbf{(Obvious grading on homogeneous localizations: What we mean by $A_{(\mathfrak{p})}$)} Given a $\Z_0^+$-graded ring $A$, if  $\mathfrak{p}\subseteq A$ is homogeneous prime and we denote $S$ the set of homogeneous element not in $\mathfrak{p}$, then we may well define a $\Z$-grading on $S^{-1}A$ by letting  
\begin{align*}
  (S^{-1}A)_n\triangleq \set{f\quotient g \in S^{-1}A:f\text{ homogeneous and }n=\operatorname{deg}f-\operatorname{deg}g}\cup \set{0}
\end{align*}
\end{theorem}
\begin{proof}
To check that $(S^{-1}A)_n$ are well-defined as sets, we are required to show 
\begin{align*}
  \frac{a_1}{s_1}= \frac{a_2}{s_2} \in S^{-1}A\text{ and }a_1\text{ homo }\implies a_2\text{ homo and }\operatorname{deg}a_1-\operatorname{deg}s_1=\operatorname{deg}a_2- \operatorname{deg}s_2
\end{align*}
Because $a_1\quotient s_1=a_2\quotient s_2 \in S^{-1}A$, we know $a_1s_2u=a_2s_1u$ for some  $u \in S$. By definition and premise, $a_1,s_2,s_2$, and  $u$ are all homogeneous, which with $a_1s_2u=a_2s_1u$ implies  $a_2$ is indeed homogeneous with $\operatorname{deg}a_1-\operatorname{deg}s_1=\operatorname{deg}a_2- \operatorname{deg}s_2$. Clearly $(S^{-1}A)_n$ all form groups, $S^{-1}A= \sum (S^{-1}A)_n$, and $(S^{-1}A)_n(S^{-1}A)_m \subseteq (S^{-1}A)_{n+m}$. It remains to prove the sum is direct. Suppose 
\begin{align*}
\frac{a}{s}= \frac{a_0}{s_0}+\cdots + \frac{a_n}{s_n}
\end{align*}
where  $a\quotient s \in (S^{-1}A)_m$ and $a_i \quotient s_i \in (S^{-1}A)_{n_i}$ such that $n_i$ all distinct and not equal to  $m$. We are required to show $\frac{a}{s}=0$. From  
\begin{align*}
\frac{a}{s}= \frac{a_0s_1\cdots s_n+\cdots + a_ns_0\cdots s_{n-1}}{s_0\cdots s_n}
\end{align*}
We know that either 
\begin{align*}
\frac{a_0s_1\cdots s_n + \cdots + a_ns_0\cdots s_{n-1}}{s_0\cdots s_n}=0
\end{align*}
or $(a_0s_1\cdots s_n+ \cdots +a_ns_0\cdots s_{n-1})$ homogeneous with
\begin{align*}
\operatorname{deg}(a)+\operatorname{deg}(s_0\cdots s_n)= \operatorname{deg}(a_0s_1 \cdots s_n + \cdots + a_ns_0\cdots s_{n-1})+ \operatorname{deg}(s). 
\end{align*}
Assume for a contradiction that $a_0s_1\cdots s_n + \cdots + a_ns_0\cdots s_{n-1}$ is homogeneous. WLOG, we have 
\begin{align*}
\operatorname{deg}(a)+\operatorname{deg}(s_0\cdots s_n)= \operatorname{deg}(a_0s_1 \cdots s_n)+ \operatorname{deg}(s). 
\end{align*}
which implies 
\begin{align*}
\operatorname{deg}(a)+\operatorname{deg}(s_0)=\operatorname{deg}(a_0)+\operatorname{deg}(s)
\end{align*}
a contradiction to the definition of $a_0\quotient s_0$. 
\end{proof}
We use the notation $A_{(\mathfrak{p})}$ to denote the $(S^{-1}A)_0$ in \myref{Theorem}{Ogoh}. Clearly $A_{(\mathfrak{p})}$ is also a local ring with maximal ideal $\set{a \quotient s \in A_{(\mathfrak{p})}: a \in \mathfrak{p}}$\footnote{This set is clearly the set of non units of $A_{(\mathfrak{p})}$, and it clearly forms an ideal of $A_{(\mathfrak{p})}$}. In particular, this local ring becomes a field when $\mathfrak{p}=0$, and in such case we write $A_{(\mathfrak{p})}=A_{(\langle 0\rangle )}$. 
\begin{theorem}
\label{Ogoh2}
\textbf{(Obvious grading on homogeneous localizations: What we mean by $A_{(f)}$)} Given some $\Z_0^+$-graded ring  $A$ and homogeneous $f \in A$, we may well define a $\Z$-grading on  $A_f$ by letting 
 \begin{align*}
   (A_f)_n\triangleq \set{\frac{g}{f^l} \in A_f:g\text{ homogeneous and }n=\operatorname{deg}(g)-l\operatorname{deg}(f)}\cup \set{0}
\end{align*}
\end{theorem}
\begin{proof}
To check that $(A_f)_n$ are well defined as sets, we are required to show 
\begin{align*}
\frac{g_1}{f^{l_1}}=\frac{g_2}{f^{l_2}}\in A_f\text{ and }g_1\text{ homo }\implies g_2\text{ homo and }\operatorname{deg}(g_1)-\operatorname{deg}(f^{l_1})=\operatorname{deg}(g_2)-\operatorname{deg}(f^{l_2})
\end{align*}
whose proof is similar to the one in \myref{Theorem}{Ogoh}. Again, clearly $(A_f)_n$ all form groups, $A_f = \sum (A_f)_n$, and $(A_f)_n(A_f)_m \subseteq (A_f)_{n+m}$. It remains to prove the sum is direct. Suppose 
\begin{align*}
\frac{g_0}{f^{l_0}}= \frac{g_1}{f^{l_1}}+ \cdots + \frac{g_n}{f^{l_n}}
\end{align*}
where $g_i\quotient f^{l_i}\in (A_f)_{r_i}$ and $r_i$ are all distinct. We are required to  show $\frac{g_0}{f^{l_0}}=0$. From 
\begin{align*}
\frac{g_0}{f^{l_0}}= \frac{g_1f^{l_2 + \cdots + l_n}+\cdots + g_n f^{l_1 + \cdots + l_{n-1}}}{f^{l_1+\cdots + l_n}}
\end{align*}
We know that either 
\begin{align*}
\frac{g_1f^{l_2 + \cdots + l_n}+\cdots + g_n f^{l_1 + \cdots + l_{n-1}}}{f^{l_1+\cdots + l_n}}=0
\end{align*}
or $(g_1f^{l_2 + \cdots + l_n}+\cdots + g_n f^{l_1 + \cdots + l_{n-1}})$ homogeneous with 
\begin{align*}
\operatorname{deg}(g_0) -\operatorname{deg}(f^{l_0})= \operatorname{deg}(g_1f^{l_2 + \cdots + l_n}+\cdots + g_n f^{l_1 + \cdots + l_{n-1}}) - \operatorname{deg}(f^{l_1+ \cdots +l_n})
\end{align*}
Assume for a contradiction that $g_1f^{l_2 + \cdots + l_n}+\cdots + g_n f^{l_1 + \cdots + l_{n-1}}$ is homogeneous. WLOG, we have 
\begin{align*}
\operatorname{deg}(g_0) -\operatorname{deg}(f^{l_0})= \operatorname{deg}(g_1f^{l_2 + \cdots + l_n}) - \operatorname{deg}(f^{l_1+ \cdots +l_n})
\end{align*}
which implies 
\begin{align*}
\operatorname{deg}(g_0)-\operatorname{deg}(f^{l_0})= \operatorname{deg}(g_1)-\operatorname{deg}(f^{l_1})
\end{align*}
a contradiction to the premise  $r_0\neq r_1$. 
\end{proof}
Again, we use the notation $A_{(f)}$ to denote the $(A_f)_0$ in \myref{Theorem}{Ogoh2}. \\
\section{Segre embedding}
\label{SE}
\begin{theorem}
\textbf{()}
\end{theorem}
Fix $n$ and $m$. In this section, the underlying field $k$ is always infinite, and we express elements of $\P^{(n+1)(m+1)-1}$ (not uniquely, of course) as matrices:  
\begin{align*}
\begin{bmatrix}
  z_{0,0} & \cdots & z_{0,m} \\
  \vdots & \ddots & \vdots \\
  z_{n,0} & \cdots & z_{n,m} 
\end{bmatrix}
\end{align*}
and use $k[z_{i,j}]$ to denote "the" polynomial ring. Now, consider the \textbf{Segre embedding} $\psi: \P^n \times \P^m \rightarrow \P^{(n+1)(m+1)-1}$ defined by 
\begin{align*}
[x_0:\cdots : x_n] \times [y_0 : \cdots :y_m] \mapsto  \begin{bmatrix}
  x_0y_0 & \cdots & x_0y_m \\
  \vdots & \ddots & \vdots \\
  x_ny_0 & \cdots & x_ny_m 
\end{bmatrix}
\end{align*}
It is clear that $\psi$ is well-defined and injective. We shall show that the image of $\psi$ is indeed irreducible closed to justify calling $\psi$ an embedding.\begin{theorem}
\textbf{(Image of Segre embedding is closed)} Let $\psi:\P^n\times \P^m\rightarrow \P^{(n+1)(m+1)-1}$ be the Segre embedding, and consider  
\begin{align*}
S\triangleq \bset{z_{i,j}z_{p,l}-z_{p,j}z_{i,l}\in k[z_{i,j}]:i,p \in \set{0,\dots ,n}\text{ and }j,l \in \set{0,\dots ,m}}. 
\end{align*}
We have 
\begin{align*}
\operatorname{Im}(\psi)= V(S)
\end{align*}
\end{theorem}
\begin{proof}
Clearly, we have $\operatorname{Im}(\psi) \subseteq V(S)$. Suppose 
\begin{align*}
\alpha \triangleq \begin{bmatrix}
  z_{0,0} & \cdots & z_{0,m} \\
  \vdots & \ddots & \vdots \\
  z_{n,0} & \cdots & z_{n,m} 
\end{bmatrix} \in V(S)
\end{align*}
By definition, there exists some column of $\alpha $ that is nonzero. WLOG, let that column be the first one. To show $\alpha  \in \operatorname{Im}(\psi)$, we are required to show there exists some $\ld _1,\dots ,\ld _m \in k$ such that 
\begin{align*}
z_{i,j}=\ld _j z_{i,0},\quad \text{ for all }i,j
\end{align*}
then the proof will follows from noting $\alpha $ is the image of $[z_{0,0}:\cdots : z_{n,0}]\times [1:\ld_1:\cdots :\ld _m]$. WLOG, let $z_{0,0}\neq 0$. One may now check $\ld_j\triangleq z_{0,j}z_{0,0}^{-1}$ suffices, using the premise $\alpha  \in V(S)$. 
\end{proof}
\begin{theorem}
\textbf{(Basic Property)} Identifying $\P^n \times \P^m$ as a subspace of $\P^{(n+1)(m+1)-1}$ via Segre embedding $\psi$. If $C_1\subseteq \P^n,C_2\subseteq \P^m$ are closed, then $C_1 \times C_2 \subseteq \P^n \times \P^m$ is also closed.   
\end{theorem}
\begin{proof}
Let $C_1\triangleq V(P_1,\dots ,P_r)$ and $C_2 \triangleq V(Q_1,\dots ,Q_l)$. The proof follows from checking that the image of $C_1 \times C_2\subseteq \P^{(n+1)(m+1)-1}$ is the intersection of image of $\P^n \times \P^m$ with:
\begin{align*}
\bigcap_{i,j} V(P_1(z_{0j},\dots ,z_{mj}),\dots ,P_r (z_{0j},\dots,z_{mj}),Q_1(z_{i0},\dots ,z_{i n}),\dots ,Q_l(z_{i0},\dots ,z_{i n}))
\end{align*}
\end{proof}
\begin{theorem}
\textbf{(Projection is indeed a close map)} Identifying $\P^n \times \P^m$ as a subspace of $\P^{(n+1)(m+1)-1}$, the projection $\pi :\P^n \times \P^m\rightarrow \P^m$ is a closed map. 
\end{theorem}
\begin{proof}
  Let $C \subseteq \P^n \times \P^m$ be closed. We are required to prove $\pi  (C)$ is closed. Let $\phi_i: \P^m_{(i)}\rightarrow \A^m$ be the \customref{Ste}{standard open affine covering}  of $\P^m$, where $i$ runs through  $\set{0,\dots ,m}$. Because the topology of $\P^m$ is coherent with the topologies of $\P^m_{(i)}$, to prove $\pi  (C)$ is closed, we only have to prove $\pi (C)\cap \P^m_{(i)}$ are closed in $\P^m_{(i)}$. In other words, we wish to show $\phi_i \circ \pi (C)$ is closed in $\A^m$. \\



  Let $u_i:\A^n \rightarrow \P^n_{(i)}$ be the \customref{Ste}{standard quasi variety isomorphisms}. 
\end{proof}
\begin{theorem}
\textbf{(Image of Segre embedding is irreducible)} The image of the Segre embedding  $\psi:\P^n \times \P^m\rightarrow \P^{(n+1)(m+1)-1}$ is irreducible. 
\end{theorem}
\begin{proof}
Suppose $\P^n\times \P^m=A \cup  B$ where $A,B$ are closed. We are required to show $\P^n \times \P^m$ is covered either by $A$ or by $B$. For each $[\textbf{x}] \in \P^n$, let $X_{[\textbf{x}]}\triangleq \set{[\textbf{x}]}\times \P^m$. Because $X_{[\textbf{x}]}$ is a subset of $\P^n \times \P^m$, we have: 
\begin{align*}
  X_{[\textbf{x}]}= (A \cap X_{[\textbf{x}]} )\cup  (B \cap X_{[\textbf{x}]})
\end{align*}
This implies by irreducibility of $X_{[\textbf{x}]}$ that either  $A$ or  $B$ covers $X_{[\textbf{x}]}$. Define $X_A$ to be the collection of  $[\textbf{x}] \in \P^n$ that makes $A$ cover $X_{[\textbf{x}]}$, and define $X_B$ similarly. By construction, if $X_A=\P^n$, then $A$ cover $\P^n \times \P^m$. A routine check shows that: 
\begin{align*}
X_A= \bigcap_{[\textbf{y}]\in \P^m} \pi_1 ( (\P^n \times \set{[\textbf{y}]}) \cap A)
\end{align*}

Because $\P^n$ is irreducible and we have shown $\P^n = X_A \cup X_B$, the proof moreover boils downs to proving $X_A$ and $X_B$ are closed. \\

So it remains to show projection $\pi_1: \P^n \times \P^m\rightarrow \P^n$ is a closed map.  
\end{proof}



Consider formal polynomial $F \in k[x_0,\dots ,x_n,y_0,\dots ,y_m]$, and write $F = F_1+ \cdots +F_r$ where $F_i$ are all monomials of the forms $cx_0^{e_0}\cdots x_n^{e_n}y_0^{e_{n+1}}y_m^{e_{n+m}}$. If for all $i$, \textbf{the degree of $F_i$ in  $x$}, the numbers $e_0+\cdots +e_n$, are the same, then we say $F$ is \textbf{$\textbf{x}$-homogeneous}. We say $F$ is \textbf{bi-homogeneous} if $F$ is both  $\textbf{x}$-homogeneous and  $\textbf{y}$-homogeneous. \\

Clearly, if $F \in k[x_0,\dots ,x_n,y_0,\dots ,y_m]$ is bi-homogeneous, then we may well define its \textbf{vanishing set} on $\P^n \times \P^m$ the obvious way. 
\begin{theorem}
\textbf{(Zariski Topology on $\P^n \times \P^m$)} Identifying $\P^n \times \P^m$ as a closed subset of $\P^{(n+1)(m+1)-1}$ via Segre embedding, not only every closed set $X \subseteq \P^n \times \P^m$ have the form  
\begin{align}
\label{FiS}
\set{\left([x_0:\cdots :x_n],[y_0:\cdots :y_m]\right) \in \P^n\times \P^m: F (\textbf{x},\textbf{y})=0\text{ for all }F  \in S }
\end{align}
for some collection $S$ of bi-homogeneous polynomials whose $\textbf{x}$-degree equals to its  $\textbf{y}$-degree, but also for any collection $S$ of bi-homogeneous polynomial, \myref{Set}{FiS} is closed. 
 

Nontrivial. $F(\textbf{y})\mapsto \textbf{x}F(\textbf{y})$ won't work. 
\end{theorem}
\begin{proof}
The "not only" part follows from checking given any $V(F_1,\dots ,F_r)\subseteq \P^{(n+1)(m+1)-1}$, its preimage under Segre embedding equals to $V(\tilde{F_1},\dots ,\tilde{F_r})$, where each $\tilde{F_i}\in k[\textbf{x},\textbf{y}]$  comes from substituting the $z_{i,j}$ in $F_i$ with $x_iy_j$. \\ 


\end{proof}


A routine check shows that every closed subset of $\P^n \times \P^m$ have the form  
where $S \subseteq k[x_0,\dots ,x_n,y_0,\dots ,y_m]$ is some collection of bi-homogeneous polynomials. Moreover, for each closed $X\subseteq \P^n \times \P^m$, there always exists bi-homogeneous polynomial collection  $S$ such that $X$ equal to  \myref{Set}{FiS} and such that for each $F \in S$, the degree of  $F$ in  $x$ equals to the degree of  $F$ in  $y$. 
\begin{lemma}
\textbf{(Expected Behavior of Product)} Identifying $\P^n \times \P^m$ as a closed subset of $\P^{(n+1)(m+1)-1}$ via Segre embedding, for all fixed $[x_0':\cdots :x_n']\in \P^n$, the set $[x_0':\cdots :x_n']\times \P^m$ is homeomorphic to $\P^m$.
\end{lemma}
\begin{proof}
Define $\phi: \P^m \rightarrow [x_0':\cdots :x_n']\times \P^m$ by 
\begin{align*}
[y_0:\cdots :y_m]\mapsto [x_0':\cdots :x_n'] \times [y_0:\cdots :y_m]
\end{align*}
We first prove that $\phi$ is a closed map. Fix $V(F_1,\dots ,F_l)\in \P^m$. Define 
\begin{align*}
  \tilde{S}\triangleq \set{x_j^{\operatorname{deg}(F_i)}F_i: 0\leq j\leq n,1\leq i\leq l} 
\end{align*}
Observe 
\begin{align*}
\phi (V(F_1,\dots ,F_l))= V(\tilde{S}) |_{[x_0': \cdots :x_n']\times \P^m}
\end{align*}
We now prove that $\phi$ is continuous. Let $\set{F_1,\dots ,F_t}\subseteq k[\textbf{x},\textbf{y}]$ be some collection of bi-homogeneous polynomials whose $\textbf{x}$-degree equal to its $\textbf{y}$-degree. Observe 
\begin{align*}
\phi^{-1}(V(F_1,\dots ,F_t)|_{[x_0':\cdots :x_n']\times \P^m})= V(\tilde{F_1} ,\dots ,\tilde{F_t} ),\quad \text{ where }\tilde{F_i}(\textbf{y})\triangleq F_i(x_0',\dots ,x_n',\textbf{y})
\end{align*}

\end{proof}
\begin{theorem}
\textbf{(Image of Segre embedding is irreducible)} 
\end{theorem}


As it turned out, to prove the image of Segre embedding is irreducible is extremely nontrivial and is often overlooked by people who are not careful enough\footnote{See these two MSE post: 

https://math.stackexchange.com/questions/984340/the-ideal-for-image-of-segre-embedding?noredirect=1&lq=1 

https://math.stackexchange.com/questions/139531/is-this-quotient-ring-mathbbcz-ij-ker-phi-integrally-closed 

for an outline of the proof. It is by nature combinatorial.}.
\begin{theorem}
\textbf{(Closed set of Segre embedding)} Identifying the Cartesian product $\P^n \times \P^m$ as a subvariety of $\P^{(n+1)(m+1)-1}$ using Segre embedding, \end{theorem}
\begin{proof}
Let $S\subseteq k[z_{i,j}]$ be some collection of homogeneous polynomial. For each homogeneous $F\in k[z_{i,j}]$, define $\tilde{F}$ by replacing $z_{i,j}$ with $x_iy_j$. Clearly, 
\begin{align*}
\tilde{S}\triangleq \set{\tilde{F} \in k[x_0,\dots ,x_n,y_0,\dots ,y_m] : F \in S}
\end{align*}
is a collection of bi-homogeneous polynomial. Let $\psi: \P^n\times \P^m \rightarrow \P^{(n+1)(m+1)-1}$ be the Segre embedding. We claim preimage of  $V(S)\cap \operatorname{Im}(\psi)$ under Segre embedding indeed has the form  \myref{Set}{FiS}. 
\end{proof}
\begin{theorem}
\label{Apou}
\textbf{(A part of universal property)} If $\phi:X\rightarrow \P^n,\psi:X\rightarrow \P^m$ are two quasi variety morphism, then $\phi \times \psi: X\rightarrow \P^n \times \P^m$ defined in the obvious way is also a quasi variety morphism.     
\end{theorem}
\section{Rational map}
\label{Rm}
\begin{theorem}
\label{Rmi}
\textbf{(Rational map is well-defined)} Let $X$ and  $Y$ be two quasi varieties, and let $\phi$ and $\psi$ be two quasi varieties from $X$ to $Y$. If there exists non empty open subset $U \subseteq X$ on which $\phi$ and $\psi$ agree, them $\phi = \psi$. 
\end{theorem}
\begin{proof}
WLOG\footnote{
If $Y$ is affine, by \myref{Theorem}{Ste}, there exists quasi variety isomorphism $Y\xrightarrow{\pfi} Y' \subseteq \P^n$. If $\pfi \circ \phi :X\rightarrow Y'$ and $\pfi \circ \psi:X\rightarrow Y'$ agree, then $\phi=\pfi ^{-1}\circ \pfi  \circ \phi$ and $\psi= \pfi ^{-1}\circ \pfi \circ \psi$ also agree. In other words, we may WLOG let $Y$ be projective. Let $j:Y\rightarrow \P^n$ be the inclusion. Because $j$ is injective,  if $j\circ \phi$ and $j\circ \psi $ agree, then $\phi$ and $\psi$ must agree. This allow us to WLOG suppose $Y=\P^n$.}, let $Y=\P^n$. By \customref{Apou}{universal property}, $\phi \times \psi : X\rightarrow \P^n \times \P^n$ is a quasi variety morphism. Clearly, the diagonal set $\Delta\triangleq \set{[\textbf{x}]\times [\textbf{x}]\in \P^n \times \P^n: [\textbf{x}]\in \P^n}$ equals to the vanishing set $V(\set{x_iy_j-x_iy_j: 0 \leq i,j\leq n})$, and is thus closed. By premise, $\phi \times \psi (U)\subseteq \Delta$. It then follows form continuity\footnote{Recall that one of the equivalent definition for function between two topological space to be continuous is that the functions maps closure of any subset $A$ of domain into the closure of image of  $A$.} of $\phi \times \psi$, $U$ being dense in $X$, and $\Delta$ being closed that  $\phi \times \psi (X)\subseteq \Delta $, which implies $\phi = \psi$. 
\end{proof}
Let $X$ and  $Y$ be two varieties. Because of \myref{Theorem}{Rmi}, we may well-define \textbf{rational map} $\phi: X \DashedArrow  Y$ to be equivalence\footnote{The relation is that two quasi varieties morphism agrees on the intersection on their domains.} class of pairs $(U,\phi_U)$ where $U$ is a nonempty open subset of $X$ and  $\phi_U:U\rightarrow Y$ is a quasi variety morphism.  Again, this equivalence-class-based approach to defining rational map provides a way to collect all possible quasi varieties morphisms from nonempty open subset of $X$ to  $Y$. Given any $\phi : X\DashedArrow Y $, there exists a unique representative \( (U_{\max}, \phi_{U_{\max }}) \in \phi \) such that \( \phi_{\max} \) is defined on the largest open subset of \( X \) where all representatives agree.\footnote{To see such, note that $X$ must be Noetherian \customref{Nt}{so any subspace is compact},"union" of these morphism is continuous then follows from paste lemma, and the finite "union" of these morphism clearly pullback regular functions.} Therefore, it make sense for us to say whether $\phi :X \DashedArrow Y $ is \textbf{defined at} $x \in X$.    \\




Given a rational map $\phi:X\DashedArrow Y$, we say $\phi$ is \textbf{dominant} if for some and hence every\footnote{Let $U,V \subseteq X$ be open, and $\phi (U)$ be dense in $Y$. Because $U$ is irreducible, we know $U=\operatorname{cl}_U(U \cap V)$, and because $\phi:U\rightarrow Y$ is continuous, we know $\phi (\operatorname{cl}_U(U \cap V))\subseteq \overline{\phi (U\cap V)}$. Together, we have $Y=\overline{\phi (U)}= \overline{\phi (\operatorname{cl}_U(U\cap V))}\subseteq \overline{\phi (U\cap V)}\subseteq \overline{\phi (V)}$.} pair $(U,\phi_U)$, the image of $\phi_U$ is dense in $Y$. We care much more about dominant rational map that non dominant rational map for following reasons:
\begin{enumerate}[label=(\roman*)]
  \item We may well define composition of dominant rational maps. 
  \item The composition of dominant rational is also dominant.\footnote{Let $W \subseteq Z$ be open. We are required to show $W$ intersect with $\psi_V(V \cap \phi_U (U))$. Because $\psi_V(V)\subseteq Z$ is dense and $\psi_V$ is continuous, we know $\psi_V^{-1}(W)\subseteq Y$ is nonempty and open. It then follows from dominance of $\phi$ that $\phi_U^{-1} (\psi^{-1}_V (W))$ is nonempty.} 
  \item Because for each open $U \subseteq X$, we have the identification $K(U)=K(X)$, we can well define dual map $\phi^*:K(Y)\rightarrow K(X)$.  
\end{enumerate}
Moreover, the dual map of dominant rational map behave the way we all wish: 
\begin{align*}
  (\psi \circ \phi)^* = \phi^* \circ \psi^* 
\end{align*}
If we say $\phi : X\DashedArrow Y$ is a \textbf{birational map}, we mean $\phi$ is dominant and there exists some dominant  $\psi:Y \DashedArrow X$ such that $\psi \circ \phi:X\DashedArrow X$ contains $(X,\id )$ and $\phi \circ \psi: Y \DashedArrow Y$ contains $(Y,\id )$. Clearly, inverse of any birational map is unique and also a birational map. Two quasi varieties are said to be \textbf{birational equivalent} if there exists a birational map between them. Quasi varieties  are always birational equivalent to their open subsets.\\



The reason we care about birational equivalence stemmed from that we care about the function field on varieties: One always study first about the functions on the object to make interesting conclusion of the object. As we have promise earlier, see the almighty \customref{BE}{equivalent definition for birational equivalence}. 
\begin{theorem}
\label{Bcoa}
\textbf{(Basis consisting of "affine" variety)} Each variety $X$ has a basis whose elements are all quasi variety isomorphic to some affine variety. 
\end{theorem}
\begin{proof}
Fix $p \in X$ and open $U\subseteq X$ containing $p$. We are required to find open $W \subseteq U$ containing  $p$ and quasi variety isomorphic to some affine variety.\\ 

For the affine case $X\subseteq \A^n$, first observe that because $\A^n-U$ is closed, there exists $F\in I(\A^n-U)$ such that $p \not \in V(F)$. Clearly $W \triangleq X \cap (\A^n-V(F))$ is open in $X$, contains  $p$, and is contained by $U$. It remains to show that $W$ is quasi variety isomorphic to some affine variety. \\

 By \myref{Theorem}{Qve}, there exists a quasi variety isomorphism $\psi :\A^n-V(F) \rightarrow  V(x_{n+1}F-1)\subseteq \A^{n+1}$. To show such $\psi$ when restricted onto  $W$ suffices, we only have to show $\psi (W)$ is closed, which follows from $W$ being closed in  $\A^n- V(F)$, which follows form $X$ being closed in  $\A^n$.  \\


Let $X \subseteq \P^n$, let $p \in \A_{(0)}\triangleq \set{[\textbf{x}]\in \P^n : x_0 \neq 0}$, and let $\phi:\A_{(0)}\rightarrow \A^n$ be the \customref{Ste}{standard quasi variety isomorphism}. Because $X$ is closed, we know $\phi (X \cap \A_{(0)})\subseteq \A^n$ is closed. Clearly, $U \cap \A_{(0)}$ is open in $X\cap  \A_{(0)}$. It then follows from the affine case that there exists some $W'$, containing $\phi (p)$, contained by  $\phi (U \cap \A_{(0)})$, open in $\phi (X \cap \A_{(0)})$, and quasi variety isomorphic to some affine variety. By construction, $W\triangleq \phi^{-1}(W')$ suffices. 
\end{proof}
\begin{theorem}
\label{Cov}
\textbf{(Category of varieties and dominant rational map is "equivalent" to the finitely generated field extension)} Let $X,Y$ be two varieties. The map $\phi \mapsto \phi^*$ forms a bijection between 
\begin{enumerate}[label=(\roman*)]
  \item the set of dominant rational maps from $X$ to  $Y$. 
  \item the set of $k$-algebra homomorphism from  $K(Y)$ to $K(X)$. 
\end{enumerate}
\end{theorem}
\begin{proof}
 Let $\theta: K(Y)\rightarrow K(X)$ be a $k$-algebra homomorphism. We are required to show the existence and uniqueness of dominant $\phi :X \DashedArrow Y $ that satisfies $\phi^* =\theta$. Suppose for now $Y$ is projective. By  \myref{Theorem}{Bcoa}, there exists some nonempty open $U \subseteq Y$ and quasi variety isomorphism $\pfi : U \rightarrow Z\subseteq \A^n$ where $Z$ is closed. Let $\beta :U \DashedArrow Y,\pfi :Z\DashedArrow U  $ be the obvious birational maps.  
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJYIl0sWzMsMCwiWSJdLFszLDIsIloiXSxbMywxLCJVIl0sWzAsMSwiIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV0sWzEsMywiXFxiZXRhIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiYXJyb3doZWFkIn0sImJvZHkiOnsibmFtZSI6ImRvdHRlZCJ9fX1dLFswLDIsIiIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRvdHRlZCJ9fX1dLFszLDIsIlxcdmFycGhpIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiYXJyb3doZWFkIn0sImJvZHkiOnsibmFtZSI6ImRvdHRlZCJ9fX1dXQ==
\[\begin{tikzcd}
	X &&& Y \\
	&&& U \\
	&&& Z
	\arrow[dotted, from=1-1, to=1-4]
	\arrow[dotted, from=1-1, to=3-4]
	\arrow["\beta", broken double arrow, from=1-4, to=2-4]
	\arrow["\pfi", broken double arrow, from=2-4, to=3-4]
\end{tikzcd}\]

Clearly, the unique existence of $\psi: X \DashedArrow Z $  that satisfies $\psi^*= \theta \circ (\beta ^{-1}) ^* \circ (\pfi ^{-1}) ^*$ implies the unique existence of $\alpha :X \DashedArrow Y $ that satisfies $\alpha ^* = \theta$. This allows us to suppose $Y$ is affine.  \\

Let $\set{y_1,\dots ,y_n}$ generate $\Gamma (Y)$ as $k$-algebra. Because $X$ is irreducible, we know the intersection of domains of $\theta (y_i)$ is nonempty open. Denoting that intersection by $U$, clearly $\theta $ maps $\Gamma (Y)$ into $\mathscr{O}(U)$. By \myref{Theorem}{If}, there exists a unique quasi variety morphism $\phi_U:U\rightarrow Y$ such that $\theta (F)=F \circ \phi_U $ for all $F \in \Gamma (Y)$. Let $\phi:X\DashedArrow Y$ be the rational map induced by $\phi_U$. It remains to show that 
\begin{enumerate}[label=(\roman*)]
  \item $\phi$ is dominant with $\phi^*=\theta$. 
  \item $\phi$ is the only dominant rational map from $X$ to  $Y$ whose dual map is $\theta$.  
\end{enumerate}
To see that $\phi$ is dominant,  observe that if $\phi_U(U)\subseteq V(F_1,\dots ,F_m)$, then $\theta (F_i)=0$, which by injectivity of the field homomorphism $\theta$ implies $F_i=0$. \\

We now show $\phi^*=\theta$. Let $f \in K(Y)$ and $x \in \phi_U^{-1}(\operatorname{Dom}f)$.  Because by denseness, $\phi_U^{-1}(\operatorname{Dom}f)$ is nonempty open, to show $\theta (f)=\phi^*(f)$, we only have to show $\theta (f)(x)=\phi^*(f)(x)$, which is done by verifying the computation:
\begin{align*}
\phi^*(f)(x)=\phi^*(F\quotient G)(x)= \frac{\phi^*(F)(x)}{\phi^*(G)(x)}= \frac{\theta(F)(x)}{\theta(G)(x)}=\theta (f)(x)
\end{align*}
where $f=F\quotient G$.\footnote{Such $F,G$ are not only guaranteed to exists so that locally $f=F\quotient G$, but also globally $f=F\quotient G$. See \myref{Theorem}{Asog}.} Note that $\phi^*(f)$ is defined at $x$ because  $x\in \phi_U^{-1}(\operatorname{Dom}f)$, that $\phi^*(F)=\theta (F)$ are defined at $x$ by construction of $U$, and that $\theta (G)(x)=\phi^*(G)(x)\neq 0$ by definition. \\



Lastly, let $\psi: X\DashedArrow   Y$ be another dominant rational map such that $\psi^*=\theta$. We are required to show $\psi=\phi$. By irreducibility, there exists some open $V \subseteq U$ on which $\psi$ is defined.  By construction, $F \circ \psi_V=\theta (F)$ for all $F \in \Gamma (Y)$. \myref{Theorem}{If} states that such $\psi_V$ is unique. On the other hands, $\phi_V$  also satisfies $F \circ \phi_V= \theta (F)$. We have shown $\phi,\psi$ agree on $V$, which implies $\phi=\psi$.   
\end{proof}
\begin{equiv_def}
\label{BE}
\textbf{(Birational Equivalence)} Let $X,Y$ be two varieties. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $X$ and  $Y$ are birationally equivalent. 
  \item There exists  $U \subseteq X$ and $V \subseteq Y$ such that  $U$ is open in  $X$,  $V$ is open in  $Y$, and  $U,V$ are quasi variety isomorphic. 
  \item $K(X)$ and $K(Y)$ are isomorphic as $k$-algebras. 
\end{enumerate} 
\end{equiv_def}
\begin{proof}

  (i)$\implies $(ii): Consider  birational map  $\phi:X\DashedArrow  Y$ with inverse $\psi:Y\DashedArrow W$. Let $W\triangleq \operatorname{Dom}(\phi)$ and $O\triangleq \operatorname{Dom}(\psi)$. The proof then follows from checking $U\triangleq \phi_W^{-1}(\psi_O^{-1}(W))$ and $V\triangleq \psi_O^{-1}(\phi_W^{-1}(O))$ suffices.\\




(ii)$\implies $(iii): This follows from $K(X)\cong  K(U)\cong  K(V)\cong  K(Y)$ as $k$-algebras. \\


(iii)$\implies $(i): This follows from \myref{Theorem}{Cov}. 
\end{proof}

\section{Singularity}
Let $X$ be a quasi variety. We say $X$ is  \textbf{nonsingular at} $\textbf{a} \in X$ if the local ring $\mathcal{O}_{\textbf{a},X}$ is moreover regular, and we say $X$ is  \textbf{smooth} or \textbf{nonsingular} if $X$ contains no singular point. 
\begin{equiv_def}
\label{Jcfs}
  \textbf{(Jacobian criteria for singularities of affine varieties)} Given algebraically closed field $k$, affine variety $X \subseteq \A^n_k$, $\textbf{a} \in X$, and some set $\set{F_1,\dots ,F_t}\subseteq k[x_1,\dots ,x_n]$ of generators of $I(X)$, the followings are equivalent: 
  \begin{enumerate}[label=(\roman*)]
    \item $X$ is nonsingular at $\textbf{a}$.  
    \item  The rank of the $t \times n$ \textbf{Jacobian matrix}  $(\partial F_i \quotient \partial x_j)|_\textbf{a}$, equals to $n-\operatorname{topdim}(X)$. 
  \end{enumerate}
Note that basic linear algebra told us the rank of the Jacobian matrix $(\partial F_i \quotient \partial x_j)$ is invariant under the choice of generators and $t$. 
\end{equiv_def}
\begin{proof}
Define $k$-linear map $\theta: A\triangleq k[x_1,\dots ,x_n]\rightarrow k^n$ by 
\begin{align*}
\theta (G)\triangleq \left(\frac{\partial G}{\partial x_1}\Bigg|_\textbf{a},\dots , \frac{\partial G}{\partial x_n}\Bigg|_\textbf{a} \right)
\end{align*}
Let $\mathfrak{a}\triangleq \langle x_1-a_1,\dots,x_n-a_n\rangle\subseteq A$ be the maximal ideal correspond to $\textbf{a}$. Unrolling the definitions shows that: 
\begin{enumerate}[label=(\roman*)]
  \item $\theta$ is surjective because $\theta (x_i-a_i)$ forms a basis for $k^$.  
  \item $\mathfrak{a}^2 \subseteq  \operatorname{Ker}\theta \cap \mathfrak{a}$ 
  \item Fix $F \in \operatorname{Ker}\theta \cap \mathfrak{a}^2$. Because $F \in \mathfrak{a}$, we may write $F=G_1(x_1-a_1)+ \cdots + G_n (x_n-a_n)$. Because  $\theta (F)=0$, we know by computation that $G_i (a)=0$ for all $i$, that is, $G_i \in \mathfrak{a}$ and $F \in \mathfrak{a}^2$. Together with (ii), we have shown $\mathfrak{a}^2= \operatorname{Ker}\theta \cap \mathfrak{a}$. 
\end{enumerate}
Therefore, $\theta$ induces a $k$-linear isomorphism  $\theta' : \mathfrak{a}\quotient \mathfrak{a}^2 \rightarrow k^n$. Again, unrolling the definitions shows that dimension of $\theta (I(X))$ equals to the rank $r$ of the  Jacobian matrix. Now, because we have the commutative diagram:  
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXG1hdGhmcmFre2F9Il0sWzAsMiwiXFxtYXRoZnJha3thfV4yIl0sWzIsMCwia15uIl0sWzAsMiwiXFx0aGV0YSB8X3tcXG1hdGhmcmFre2F9fSJdLFswLDEsIiIsMix7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6ImVwaSJ9fX1dLFsxLDIsIlxcdGhldGEgJyIsMl1d
\[\begin{tikzcd}
	{\mathfrak{a}} && {k^n} \\
	\\
	{\mathfrak{a}\quotient \mathfrak{a}^2}
	\arrow["{\theta |_{\mathfrak{a}}}", from=1-1, to=1-3]
	\arrow[two heads, from=1-1, to=3-1]
	\arrow["{\theta '}"', from=3-1, to=1-3]
\end{tikzcd}\]
we see that $\theta':\mathfrak{a}\quotient \mathfrak{a}^2 \rightarrow k^n$ forms a $k$-vector space isomorphism between  $\mathfrak{a}^2+I(X)\quotient \mathfrak{a}^2$ and $\theta (I(X))$, which implies $\mathfrak{a}^2 + I(X)\quotient \mathfrak{a}^2$ have dimension $r$ as a $k$-vectors space. \\










 Let $\mathfrak{m}\subseteq \mathcal{O}_\textbf{a}$ be the maximal ideal. \myref{Theorem}{Asog} stated that $\mathcal{O}_\textbf{a} \cong (A \quotient  I(X))_{\mathfrak{a}}$. Because  the set $\mathfrak{m}$ of non-units in $\mathcal{O}_\textbf{a}$ are exactly rational functions whose nominator vanish at $\textbf{a}$, we know  $\mathfrak{m}= (\mathfrak{a}\quotient I(X))_{\mathfrak{a}}$, which implies $\mathfrak{m}^2= (\mathfrak{a}^2 + I(X)\quotient I(X))_{\mathfrak{a}}$, which moreover implies\footnote{Note that Hartshorne never really proved that his way of defining local ring indeed makes residue field isomorphic to ground field. Such hold true because of the assumption that the ground field $k$ is algebraically closed. Here we give a proof: Because the image of usual embedding $k \hookrightarrow \mathcal{O}_{\textbf{a}}$ clearly has element lying outside of $\mathfrak{m}$, we know the field homomorphism $k \rightarrow \mathcal{O}_{\textbf{a}}\quotient \mathfrak{m}$ obtained by composing $k \hookrightarrow \mathcal{O}_\textbf{a}$ and $\mathcal{O}_\textbf{a} \twoheadrightarrow \mathcal{O}_{\textbf{a}}\quotient \mathfrak{m}$ is nonzero. In other words, the residue field $\mathcal{O}_\textbf{a}\quotient \mathfrak{m} $ is an extension of $k$. Now, because $\mathcal{O}_{\textbf{a}}\quotient \mathfrak{m}$ is clearly a finitely generated $k$-algebra, we may conclude using Zariski's Lemma that that $\mathcal{O}_{\textbf{a}}\quotient \mathfrak{m}$ is a finite extension of $k$, which by algebraically closedness of $k$ implies  $k\cong  \mathcal{O}_{\textbf{a}}\quotient \mathfrak{m}$ as field, as desired.}:
 \begin{align*}
   \mathfrak{m}\quotient \mathfrak{m}^2 \cong  (\mathfrak{a} \quotient \mathfrak{a}^2+I (X))_{\mathfrak{a}}  \cong  \mathfrak{a} \quotient  \mathfrak{a}^2 + I(X),\quad\text{ as }k\text{-vector space}
 \end{align*}
Now, because $\operatorname{dim}_k (\mathfrak{a}\quotient \mathfrak{a}^2)=n$, we know: 
\begin{align*}
\operatorname{dim}_k (\mathfrak{m}\quotient \mathfrak{m}^2) = \operatorname{dim}_k (\mathfrak{a}\quotient \mathfrak{a}^2+ I(X))=n- \operatorname{dim}_k (\mathfrak{a}^2+ I(X) \quotient \mathfrak{a}^2)=n-r
\end{align*}
\footnote{You may think about this later.}
As desired, we now see:
\begin{align*}
\operatorname{dim}_k (\mathfrak{m}\quotient \mathfrak{m}^2)= \operatorname{Topdim}(X)\iff r= n- \operatorname{Topdim} (X)
\end{align*}
\end{proof}
\begin{theorem}
\label{RoJ}
  \textbf{(Rank of Jacobian matrix is invariant under choice of homogeneous coordinate)} Let field $k$ be algebraically closed, $F_1, \dots ,F_t \in k[x_0,\dots ,x_n]$ each be homogeneous with degree $d_i$, for each $\ld \neq 0\in k$ and $\textbf{x}\neq \textbf{0}\in \A^{n+1}$, the rank of the two $(n+1)\times t$-matrices: 
\begin{align*}
  \begin{pmatrix} 
    \frac{\partial F_1}{\partial x_0}(\textbf{x}) &  \cdots & \frac{\partial F_1}{\partial x_n}(\textbf{x}) \\
    \vdots & \ddots & \vdots \\
    \frac{\partial F_t}{\partial x_0}(\textbf{x}) & \cdots & \frac{\partial F_t}{\partial x_n} (\textbf{x})
\end{pmatrix}\text{ and }\begin{pmatrix} 
    \frac{\partial F_1}{\partial x_0}(\ld \textbf{x}) &  \cdots & \frac{\partial F_1}{\partial x_n}(\ld \textbf{x}) \\
    \vdots & \ddots & \vdots \\
    \frac{\partial F_t}{\partial x_0}(\ld  \textbf{x}) & \cdots & \frac{\partial F_t}{\partial x_n} (\ld  \textbf{x})
  \end{pmatrix} 
\end{align*}
are the same. 
\end{theorem}
\begin{proof}
Note that $\frac{\partial F_i}{\partial x_j} \in k[x_0,\dots ,x_n]$ is either $0$ or homogeneous with degree $d_i-1$. Therefore, 
\begin{align*}
\begin{pmatrix} 
  \frac{\partial F_i}{\partial x_0}(\ld \textbf{x}) & \cdots & \frac{\partial F_i}{\partial x_n} (\ld  \textbf{x})
\end{pmatrix}= \ld ^{d_i-1} \begin{pmatrix} 
  \frac{\partial F_i}{\partial x_0}(\textbf{x}) &\cdots & \frac{\partial F_i}{\partial x_n} (\textbf{x})
\end{pmatrix}
\end{align*}
This renders the desired result an easy consequences of basic linear algebra.
\end{proof}
\begin{equiv_def}
\textbf{(Jacobian criteria for singularities of projective varieties)} Let field $k$ be algebraically closed, $X \subseteq \P^n$ a projective variety, $[\textbf{y}] \in X$, and homogeneous $\set{F_1,\dots ,F_t}\subseteq k[x_0,\dots ,x_n]$ generate $I(X)$. The followings are equivalent:\footnote{Note that the rank of the Jacobian matrix is well-defined up to choices of generators and homogeneous coordinates. We have discussed them in \customref{Jcfs}{Jacobian criteria for singularities of affine varieties} and \myref{theorem}{RoJ}.} 
\begin{enumerate}[label=(\roman*)]
  \item $X$ is nonsingular at $[\textbf{y}]$. 
    \item  The rank of the $ t \times (n+1)$ Jacobian matrix  $(\partial F_i \quotient \partial x_j)|_{[\textbf{y}]}$, equals to $n-\operatorname{topdim}(X)$. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Let $0\leq l \leq n$. Recall that the map: 
\begin{align*}
X \cap \set{[\textbf{x}] \in \P^n : x_l \neq 0 }\rightarrow \A^n;\quad [\textbf{x}]\mapsto \left(\frac{x_0}{x_l},\dots ,\frac{x_{l-1}}{x_l}, \frac{x_{l+1}}{x_l},\dots ,\frac{x_n}{x_l}\right)
\end{align*}
forms a quasi variety isomorphism from the projective quasi variety $X \cap \set{[\textbf{x}]\in \P^n :x_l \neq 0 }$ to the affine variety $V(f_1,\dots ,f_t)\subseteq \A^n$, where $f_i \in k[x_0,\dots ,\widehat{x_l},\dots ,x_n]$ are the dehomogenizations of $F_i\in k[x_0,\dots ,x_n]$. \\

Because both quasi variety isomorphism and talking closure preserves both topological dimension and local rings, to finish the proof, we only have to establish the existence of an $l \in \set{0,\dots ,n}$ that makes: 
\begin{enumerate}[label=(\roman*)]
  \item $y_l\neq 0$. 
  \item the rank of the  $t \times n$ Jacobian matrix $(\partial f_i \quotient \partial x_j)|_{(\frac{y_0}{y_l},\dots ,\frac{y_{l-1}}{y_l}, \frac{y_{l+1}}{y_l},\dots , \frac{y_n}{y_l})}$ equals to that of the $t \times (n+1)$ Jacobian matrix $(\partial F_i \quotient \partial x_j)|_{\textbf{y}}$. 
\end{enumerate}
and then the rest will follow from \customref{Jcfs}{Jacobian criteria for singularities of affine varieties}.\\

We now establish such $l$. Using \textbf{Euler's Lemma}, one may compute:\footnote{\textbf{Euler's Lemma} stated that if $F \in k[x_0,\dots ,x_n]$  is homogeneous, then  $\sum x_i (\frac{\partial F}{\partial x_i})= F \cdot \operatorname{deg}(F)$.}
\begin{align}
\label{Fx0}
\begin{bmatrix} 
  \frac{\partial F_1}{\partial x_0} (\textbf{y}) & \cdots & \frac{\partial F_1}{\partial x_n}(\textbf{y})  \\
  \vdots & \ddots & \vdots \\
  \frac{\partial F_t}{\partial x_0}(\textbf{y}) & \cdots & \frac{\partial F_t}{\partial x_n} (\textbf{y}) 
\end{bmatrix} \begin{bmatrix}
y_0 \\
\vdots \\
y_n
\end{bmatrix}= \begin{bmatrix}
F_1 (\textbf{y}) \cdot \operatorname{deg}F_1 \\
\vdots \\
F_t (\textbf{y}) \cdot \operatorname{deg}F_t
\end{bmatrix}  = \begin{bmatrix}
 0 \\
 \vdots \\
 0
\end{bmatrix}
\end{align}
where the second inequality hold true by construction of $\textbf{y}$ and $F_i$. For each $j \in \set{0,\dots ,n}$, let $v_j$ be the $j$-th column of the $t \times (n+1)$ matrix $(\partial F_i \quotient \partial x_j)|_{\textbf{y}}$. In other words: 
\begin{align*}
v_j = \begin{bmatrix}
\frac{\partial F_1}{\partial x_j}(\textbf{y}) \\
\vdots \\
\frac{\partial F_t}{\partial x_j}(\textbf{y})
\end{bmatrix},\quad \text{ for all }0 \leq  j \leq n
\end{align*}
Because $(y_0,\dots ,y_n)\in k^{n+1}$ is nonzero, \myref{equation}{Fx0} implies that, after rearranging the indexes of coordinates, we may let: 
\begin{enumerate}[label=(\roman*)]
  \item $m\leq n$. 
  \item $\set{v_1,\dots ,v_m}$ be a basis for the columns space: $\operatorname{span}(v_0,\dots ,v_n)$. 
  \item $y_0 \neq 0$.\footnote{If $y_j=0$ for all  $j\in \set{0,\dots ,m+1,\dots ,n}$, then the  linearly independence of $\set{v_1,\dots ,v_{m}}$ together with \myref{equation}{Fx0} implies $\textbf{y}=0$, which is impossible.}
\end{enumerate}
Finally, we claim $l\triangleq 0$ suffice, which follows from noting: 
\begin{align}
\label{fox}
\left \begin{pmatrix} 
  \frac{\partial f_1}{\partial x_1} & \cdots & \frac{\partial f_1}{\partial x_n}  \\
  \vdots & \ddots & \vdots \\
  \frac{\partial f_t}{\partial  x_1} &\cdots & \frac{\partial f_t}{\partial x_n}
\end{pmatrix} \right|_{\left(\frac{y_1}{y_0},\dots , \frac{y_n}{y_0}\right)} =  
 \begin{bmatrix} 
 y_0^{\operatorname{deg}(F_1)-1} \frac{\partial F_1}{\partial x_1} (\textbf{y}) & \cdots & y_0^{\operatorname{deg}(F_1)-1}\frac{\partial F_1}{\partial x_n}(\textbf{y})  \\
  \vdots & \ddots & \vdots \\
  y_0^{\operatorname{deg}(F_t)-1}\frac{\partial F_t}{\partial x_1}(\textbf{y}) & \cdots & y_0 ^{\operatorname{deg}(F_t)-1}\frac{\partial F_t}{\partial x_n} (\textbf{y}) 
\end{bmatrix}  
\end{align}


\end{proof}
\section{Blowing up}
Recall that $\A^n \times \P^{n-1}$ is a quasi-projective variety such that whose coordinate ring are:
\begin{align*}
\set{f \in k[x_1,\dots ,x_n,y_1,\dots ,y_n]: f\text{ is homogeneous in }\textbf{y}.}
\end{align*}
The \textbf{blowing up of $\A^n$ at the origin  $O \in \A^n$} is defined to be the closed subset 
\begin{align*}
X \triangleq Z(x_iy_j-x_jy_i)
\end{align*}
\begin{theorem}
\textbf{(Properties of blowing up)} Let $X\subseteq \A^n \times \P^{n-1}$ be the blowing up of $\A^n$ at the origin  $O \in \A^n$, and let $\phi: X\rightarrow \A^n$ be the projection map. Then: 
\begin{enumerate}[label=(\roman*)]
  \item If $\textbf{x}\neq \textbf{0}\in \A^n$, then $\phi^{-1}(\textbf{x})= \set{(\textbf{x}, [\textbf{x}])}$ consists of a single point. 
  \item  $\phi^{-1}(\textbf{0})=\textbf{0} \times \P^{n-1}$ 
  \item For any direction $[\textbf{y}]\in \P^{n-1}$, the point $(\textbf{0},[\textbf{y}]) \in X$ lies in the closure of:\footnote{Note that the closures of the \myref{set}{tty} are the same in either $X$ or  $\A^n \times \P^{n-1}$. }
\begin{align}
\label{tty}
    \set{(t\textbf{y},[\textbf{y}])\in X: t \in k^{\times}}\text{ in }X. 
\end{align}
\item $X$ is irreducible.
\end{enumerate}
\end{theorem}
\begin{proof}
(i): $\set{\textbf{x} \times [\textbf{x}]} \subseteq \phi^{-1}(\textbf{x})$ is clear. Let $\textbf{x} \times [\textbf{y}] \in \phi^{-1}(\textbf{x})$. To see $[\textbf{y}]=[\textbf{x}]$, WLOG suppose $x_1\neq 0$, and observe from definition of $X$ that  $y_i= \frac{x_i}{x_1}y_1$ for all $i$. (ii) is clear. To see (iii), just observe $\set{(t\textbf{y},[\textbf{y}]): t\in k}$ is closed in $\A^n \times \P^{n-1}$. \\

(iv): Note that $\phi^{-1}(\A^n - O)$ is irreducible since it is quasi variety isomorphic to $\A^n - O$. To see $\phi^{-1}(\A^n - O)$ is irreducible, just use (iii) to deduce that  $\phi^{-1}(\A^n-O)$ is dense in $X$.  
\end{proof}
\begin{definition}
\textbf{(Blowing up of an affine variety)} Let $Y\subseteq \A^n$ be a variety passing through $O$. Its \textbf{blowing up} at $O$ is the set $\tilde{Y}\triangleq  \overline{ \phi^{-1}(Y-O)}$ together with the restriction map $\phi: \tilde{Y} \rightarrow Y $. 
\end{definition}
\section{Intersection}
\begin{theorem}
\textbf{(Affine Dimension Theorem)} Let $k$ be closed, $Y,Z$ be two varieties of dimensions  $r,s$ in  $\A^n$. Every irreducible component  of  $Y \cap Z$ has dimension $\geq r+s-n$. 
\end{theorem}
\begin{proof}
We first prove the case when $Z$ is a hypersurface, says  $Z=V(F)$ for some irreducible $F \in k[\textbf{x}]$. We are required to prove irreducible components of $Y \cap Z$ have dimension $\geq r-1$. Because $A(Y)$ is Noetherian, by \customref{EoPDiNr}{primary decomposition theorem}, we know $\langle [F]\rangle \subseteq A(Y)$ has finite number of minimal prime ideals $\mathfrak{p}_1,\dots , \mathfrak{p}_m \subseteq A(Y)$. By \customref{ctfr}{correspondence theorem}, preimage of $\mathfrak{p}_i$ under quotient map $k[\textbf{x}] \twoheadrightarrow A(Y)$ are exactly minimal prime ideals over $I(Y)+\langle F\rangle $. Moreover, because:
\begin{align*}
\sqrt{I(Y)+\langle F\rangle}  =  I (V(I(Y)+\langle F\rangle ))  = I(Y\cap Z)
\end{align*}
We see preimages of  $\mathfrak{p}_i$ are furthermore exactly the minimal prime ideals over $I(Y\cap Z)$. Therefore, the images of ideals of irreducible components of $Y \cap Z$ under quotient map $k[\textbf{x}] \twoheadrightarrow A(Y)$ are exactly $\mathfrak{p}_i$. Let $C$ be an irreducible component of  $Y \cap Z$ correspond to $\mathfrak{p}_i$. It now follows from third isomorphism theorem of ring that 
\begin{align*}
A(C)= \frac{k[\textbf{x}]}{I(C)}= \frac{\frac{k[\textbf{x}]}{I(Y)}}{\frac{I(C)}{I(Y)}}  = \frac{A(Y)}{\mathfrak{p}_i} 
\end{align*}
Because $\mathfrak{p}_i$ is of height one by \customref{Kpit}{Krull's principal ideal theorem}, by \myref{Theorem}{sdt}, we know $\operatorname{Krudim}(A(C))=\operatorname{Krudim}(A(Y))- \operatorname{height}\mathfrak{p}_i=r-1$. We have proved the special case when $Z$ is a hypersurface. We now prove the general case. \\

Denote the diagonal in $\A^{2n}$ by: 
\begin{align*}
\Delta \triangleq \set{(\textbf{a},\textbf{a})\in \A^{2n}: \textbf{a} \in \A^n}
\end{align*}
Clearly, $\phi:\A^n \rightarrow \Delta$ defined by $\textbf{a}\mapsto (\textbf{a},\textbf{a})$ forms a homeomorphism between $Y \cap Z\subseteq \A^n$ and $(Y \times Z)\cap \Delta \subseteq \A^{2n}$. Because of such, we only have to prove the irreducible components of $(Y \times Z)\cap \Delta $ has dimension $\geq r+s-n$. We now prove such using the special case above.\\

Note that
\begin{enumerate}[label=(\roman*)]
  \item $\operatorname{Topdom}(Y\times  Z)=r+s$. 
  \item $\Delta =V(x_1-y_1)\cap  \cdots \cap  V(x_n-y_n)$ is the intersection of $n$ numbers of hyper surfaces. 
\end{enumerate}
By applying the special case $n$ times, we see the irreducible components of  $(Y\times Z)\cap \Delta$ has dimension $r+s- 1 \cdot n$.  
\end{proof}
\footnote{I don't understand:
\begin{enumerate}[label=(\roman*)]
  \item Do we need primary decomposition theorem to deduce about the number or existence of minimal prime ideals in $A(Y)$ over $\langle [F]\rangle $? Doesn't the finite existence of irreducible components of $Y\cap Z$ with correspondence theorem already implies this? 
  \item Why $I(Y)+\langle F\rangle =I(Y \cap Z) $? 
  \item How to write third isomorphism theorem better? Remember to write it formally in chapter 1. 
  \item Why is $\phi $ a homeomorphism? 
  \item Why is $\operatorname{Topdim}(Y\times Z)=r+s$? 
  \item Why can we apply the special case $n$ times?   
\end{enumerate}}
\begin{theorem}
\label{PDT}
\textbf{(Projective Dimension Theorem)} Let $k$ be closed,  $Y,Z$ be two varieties of dimension  $r,s$ in  $\P^n$. Every irreducible component of $Y\cap Z$  has dimension $\geq r+s-n$. Moreover, if  $r+s-n\geq 0$, then $Y \cap Z$ is nonempty. 
\end{theorem}
\begin{proof}
\end{proof}
A single variable rational coefficient polynomial $P$ is said to be \textbf{numerical} if $P(z)$ is an integer for all $z\inz$.   
\begin{equiv_def}
\label{Np}
\textbf{(Numerical polynomial)} For all $z\inc$ and $r\inz_0^+$, we define 
\begin{align*}
\binom{z}{r}\triangleq \frac{z(z-1)\cdots (z-r+1)}{r!}
\end{align*}
Given $P \in \Q[z]$, the followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
\item $P(z)\inz$ for all $z \gg 0 \inz$. 
  \item There exists $c_0,\dots ,c_r\inz$ such that 
\begin{align*}
P(z)=c_0 \binom{z}{r}+ c_1 \binom{z}{r-1}+ \cdots + c_r
\end{align*}
  \item $P$ is numerical. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
(i)$\implies $(ii): The proof is done by induction on degree of $P$. If $P$ is a constant then there is nothing to prove. Suppose $\operatorname{deg}(P)=r$ and the assertion hold true when $\operatorname{deg}(P)<r$. Clearly, there exists some $c_0,\dots ,c_r\inq $ such that 
\begin{align*}
P(z)=c_0 \binom{z}{r}+ c_1 \binom{z}{r-1}+ \cdots + c_r
\end{align*}
Define $\Delta P \in \Q[z]$ by $\Delta P(z)\triangleq P(z+1)-P(z)$. Computing 
\begin{align*}
\binom{z+1}{r}- \binom{z}{r}= \binom{z}{r-1}
\end{align*}
We see 
\begin{align*}
\Delta P(z)= c_0 \binom{z}{r-1} + c_1 \binom{z}{r-2}+ \cdots + c_{r-1}
\end{align*}
Clearly, $\Delta P(z)\inz$ for all $z\gg 0\inz$ by construction, and there exists only one $(b_0,\dots ,b_{r-1})\inq^r$ such that 
\begin{align*}
\Delta P(z)=  b_0 \binom{z}{r-1} + b_1 \binom{z}{r-2}+ \cdots + b_{r-1}
\end{align*}
Therefore, we may apply inductive hypothesis to conclude $c_0,\dots ,c_{r-1}\inz$. It then follows form $P(z)\inz$ for all $z\gg 0\inz$ that $c_r \inz$, as desired. \\

(ii)$\implies $(iii): This follows from $\binom{z}{r}\inz$ for all $z\inz$, which can be checked by induction. \\

(iii)$\implies $(i) is clear. 
\end{proof}
\begin{corollary}
\label{Ponp}
\textbf{(Properties of numerical polynomials)} Given two numerical $P_1,P_2\inq[z]$, if $P_1(z)=P_2(z)$ for all $z\gg 0\inz$, then $P_1=P_2$. 
\end{corollary}
\begin{proof}
Clearly, $P_1-P_2\inq[z]$ is numerical and maps large integers to $0$. Therefore, by \customref{Np}{definition of numerical polynomial}, we have: 
\begin{align*}
  (P_1-P_2)(z)=c_0 \binom{z}{r}+ c_1\binom{z}{r-1}+ \cdots +c_r
\end{align*}
Letting $z\rightarrow \infty$, we see $c_0$ must be $0$. Letting $z\rightarrow \infty$ again, we see $c_1$ also must be $0$. Repeating the same process, we see  $P_1-P_2=0\inq[z]$. 
\end{proof}




\begin{theorem}
\label{Ftc}
\textbf{(Filtration to compute Hilbert polynomial)} Let $S$ be a  $\N$-graded Noetherian ring and  $M$ a graded $S$-module  of finite type.  There exists some ascending filtration $0=M^0 \subseteq M^1 \subseteq \cdots \subseteq M^r=M$ consisting of graded submodules together with a tuple $\set{\mathfrak{p}_1,\dots ,\mathfrak{p}_r}$ of homogeneous prime ideal in $S$ and a tuple of integer $\set{l_1,\dots ,l_r}$ such that  
\begin{align*}
M^i\quotient M^{i-1} \cong  (S\quotient \mathfrak{p}_i)(l_i),\quad \text{ as graded $S$-module for all $i$. }
\end{align*}
Even though such ascending filtration consisting of graded submodules aren't unique, every such filtration satisfies: 
\begin{enumerate}[label=(\roman*)]
  \item If $\mathfrak{p}\subseteq S$ is homogeneous prime, then 
\begin{align*}
\mathfrak{p} \supseteq \operatorname{Ann}M \iff \mathfrak{p}\supseteq \mathfrak{p}_i\text{ for some }i 
\end{align*}
   Moreover, the set of minimal elements of the set $\set{\mathfrak{p}_1,\dots ,\mathfrak{p}_r}$ is exactly the set of minimal prime ideals over $\operatorname{Ann}(M)$.\footnote{This statement implies the statement that minimal prime ideals over $\operatorname{Ann}(M)$ is always homogeneous, which I believe can be probed by showing $\operatorname{Ann}(M)$ is always homogeneous and minimal prime over homogeneous ideals are always homogeneous.}
\item For each minimal prime $\mathfrak{p}$ over $\operatorname{Ann}(M)$, the number of times which $\mathfrak{p}$ occur in the set  $\set{\mathfrak{p}_1,\dots ,\mathfrak{p}_r}$  equals to $\mu_\mathfrak{p}(M)$, the length of the $S_\mathfrak{p}$-module $M_\mathfrak{p}$. 
\end{enumerate}
\end{theorem}
\begin{proof}
  We first prove the existence of such filtration. Consider the set of graded submodule of $M$ which admit such a filtration. Clearly, the zero module is in this set, so this set is nonempty. Because $M$ is Noetherian, we know this set has a maximal element $M'$.\footnote{\myref{Theorem}{cpoN} implies $M$ is Noetherian. \customref{EDoN}{equivalent definition of Noetherian module} implies existence of $M'$}  \\

Consider $M''\triangleq M\quotient M'$. If $M''=0$, we are done. If not, consider the set of ideals  $\set{\operatorname{Ann}(m) \subseteq M'':m \in M''\text{ is homogeneous and nonzero.}}$
\end{proof}
Let $M$ be a graded module over polynomial ring  $k[x_0,\dots ,x_n]$. Its \textbf{Hilbert function} $\phi_M:\Z\rightarrow \N \cup \set{0}$ is defined by 
\begin{align*}
\phi_M(l)\triangleq \operatorname{dim}_k(M_l)
\end{align*}
\begin{theorem}
\label{HST}
\textbf{(Hilbert-Serre Theorem)} Let $k$ be an algebraically closed field and $M$ a graded module of finite type over $k[x_0,\dots ,x_n]$. There exists unique $P_M\in \Q[z]$ such that 
\begin{align*}
 \phi_M(l)=P_M(l),\quad \text{ for all }l\gg 0 
\end{align*}
Moreover, the degree of this $P_M$ is the topological dimension of  $Z(\operatorname{Ann}M)\subseteq \P^n$. 
\end{theorem}
\begin{proof}

\end{proof}

Given closed $Y \subseteq \P^n$, its \textbf{Hilbert polynomial} is $P_{S(Y)}$ from \customref{HST}{Hilbert-Serre Theorem}. The \textbf{degree} of $Y$ is the  $\operatorname{Topdim}(Y)!$ times the leading coefficient of  $P_{S(Y)}$. 
\begin{theorem}
\label{Dos}
\textbf{(Degrees of simple objects are expected)} Let $k$ be closed. Denote $S$ the coordinate ring of  $\P^n$ and denote $\phi$ the Hilbert function. If  $F\in S$ is an irreducible homogeneous polynomial of degree $d$, $H$ is the zero set of  $F$, and  $X\subseteq \P^n$ is singleton, then:
\begin{enumerate}[label=(\roman*)]
  \item $\phi_S(l)=\binom{l+n}{n}$ for all $l\geq 0$. Therefore, $\operatorname{deg}(\P^n)=1$.  
  \item  $\phi_{S(H) }(l)=\binom{l+n}{n}- \binom{l-d+n}{n}$ for all $l\geq d$. Therefore,  $\operatorname{deg}(H)=d$. 
  \item $\phi_{S(X)}(l)= 1$ for all $l\geq 0$. Therefore, $\operatorname{deg}(X)=1$.
\end{enumerate}
\end{theorem}
\begin{proof}
  (i): The proof follows from noting that for all $l\geq 0$, $S_l$ has basis:
\begin{align*}
\set{x_0^{d_0}\cdots x_n^{d_n}\in S: d_0+\cdots +d_n=l}
\end{align*}
(ii): Fix $l\inz$. Check that $G\mapsto GF$ forms a graded $S$-module homomorphism $S(-d)\rightarrow S$ that give us a short exact sequence of graded $S$-modules: 
 \begin{align*}
 0 \longrightarrow S(-d) \overset{F}{\longrightarrow } S \longtwoheadrightarrow S\quotient \langle F\rangle  \longrightarrow 0
\end{align*}
Clearly, its restriction is a short exact sequence of  $k$-vector spaces: \footnote{I want to check this again later.}\footnote{A $S$-module isomorphism is a  $k$-vector space isomorphism. Category of $S$-module is a subcategory of  $k$-vector space. Record this in early chapter.}  
\begin{align*}
0\longrightarrow S(-d)_l \longrightarrow  S_l \longrightarrow  S(H)_l  \longrightarrow 0
\end{align*}
 It then follows from \customref{Eod}{dimension of vector space is additive} and (i) that: 
\begin{align*}
\phi_{S(H)}(l)= \phi_S (l)-\phi_S (l-d)= \binom{l+n}{n}- \binom{l-d+n}{n},\quad \text{ for all }l\geq d. 
\end{align*}
(iii): Fix $l\geq 0$. Check that:\footnote{I haven't checked it yet, and I think there is a good generalization of it.}
\begin{align*}
S(X)_l\cong  S_l \quotient I(X)\cap S_l,\quad \text{ as $k$-vector space. }
\end{align*}
We are then required to show $\operatorname{dim}_k(I(X)\cap S_l)= \binom{l+n}{n}-1$. Under a projective change of coordinate\footnote{I don't know how to perform this yet.}, WLOG, we may let $X=\set{[1:0:\cdots :0]}$. The proof then follows from checking $I(X)\cap S_l$ has basis: 
\begin{align*}
\set{x_0^{d_0}\cdots x_n^{d_n}\in S: d_0+\cdots +d_n=l\text{ and }d_0\neq l}
\end{align*}
\end{proof}
Let $S$ be a  $\N$-graded Noetherian ring, $M$ a graded  $S$-module, and $\mathfrak{p}\subseteq S$ be a minimal prime ideal over $\operatorname{Ann}(M)$. The \textbf{multiplicity} of $M$ at  $\mathfrak{p}$, denoted by $\mu_\mathfrak{p}(M)$ is the length of $M_\mathfrak{p}$ over $S_\mathfrak{p}$. Let $Y\subseteq \P^n$ be a projective variety and $H\subseteq \P^n$ a hypersurface not containing $Y$. Clearly, 
\begin{align*}
\operatorname{Ann}(S\quotient I(Y)+I(H))=I(Y)+I(H)
\end{align*}
Let $C_1,\dots ,C_s$ be the irreducible components of $Y \cap H$, so $\set{I(C_1),\dots ,I(C_s)}$ is exactly the set of minimal prime ideals over:\footnote{The first equality follows from $Z(I(Y)+I(H))=Y\cap H$, the second is just Nullstellensatz.}\footnote{Write the minimal prime share with radical in Chapter 1.1}
 \begin{align}
\label{IYH}
I(Y\cap H)=I(Z(I(Y)+I(H)))= \sqrt{I(Y)+I(H)} 
\end{align}
This implies that $\set{I(C_1),\dots ,I(C_s)}$ is exactly the set of minimal prime ideals over $I(Y)+I(H)=\operatorname{Ann}(S\quotient I(Y)+I(H))$. Because of such, we may now well define the \textbf{intersection multiplicity (number) of $Y$ and  $H$ along  $C_j$} to be 
\begin{align*}
i(Y,H;C_j)\triangleq \mu_{I(C_j)}(S\quotient I(Y)+I(H)) 
\end{align*}
\begin{theorem}
\label{GBT}
\textbf{(Bezout Theorem for a variety and a hypersurface in $\P^n$)} Let $Y$ be a variety of dimension $\geq 1$ in $\P^n$, and let  $H$ be a hypersurface not containing  $Y$. Let  $C_1,\dots ,C_s$ be the irreducible components of $Y \cap H$. We have 
\begin{align*}
\sum_{j=1}^s i(Y,H;C_j) \cdot \operatorname{deg}C_j= (\operatorname{deg}Y)( \operatorname{deg}H) 
\end{align*}
\end{theorem} 
\begin{proof}
Let $H$ be defined by irreducible homogeneous  $F$ of degree $d$. We have an exact sequence of graded $S$-modules: 
 \begin{align*}
0\longrightarrow (S\quotient I(Y))(-d)\overset{F}{\longrightarrow }S\quotient I(Y) \longrightarrow S\quotient (I(Y)+I(H))\longrightarrow 0
\end{align*}
Clearly, its restriction is a short exact sequence of $k$-vector spaces: 
\begin{align*}
0\longrightarrow (S(Y))(-d)_l \longrightarrow S(Y)_l \rightarrow (S\quotient (I(Y)+I(H)))_l \longrightarrow 0
\end{align*}
Denoting $M\triangleq S\quotient (I(Y)+I(H))$, because \customref{Eod}{dimension of vector space is additive}, this give us: 
\begin{align}
\label{PMz}
P_M(z)=P_{S(Y)}(z)-P_{S(Y)}(z-d),\quad \text{ for all }z\gg 0 
\end{align}
Let $r$ and $e$ respectively be the dimension and degree of  $Y$. It is clear that $\operatorname{Ann}(S(Y))=I(Y)$, which by closedness of $Y$ implies  $Z(\operatorname{Ann}(S(Y)))=Y$. It now follows from  \customref{HST}{Hilbert-Serre Theorem} that $P_{S(Y)}(z)$ has degree $r$. This implies the leading term of $P_{S(Y)}(z)$ is $\frac{\operatorname{deg}Y}{r!}z^r$. This with \myref{Equation}{PMz} 
implies:
\begin{align}
\label{Tlt}
  \text{ The leading term of $P_M(z)$ is $\frac{(\operatorname{deg}Y)(\operatorname{deg}H)}{(r-1)!}z^{r-1}$.} 
\end{align}
Let the ascending filtration $0=M^0 \subseteq M^1 \subseteq \cdots \subseteq M^{q}=M$ consisting of graded $S$-submodules and the tuples $\set{\mathfrak{p}_1,\dots , \mathfrak{p}_q},\set{l_1,\dots ,l_q}$ be from \myref{Theorem}{Ftc}. In other words, we have: 
\begin{enumerate}[label=(\Roman*)]
  \item For each $i$
\begin{align}
\label{Miqmi}
M^i\quotient  M^{i-1}\cong  (S\quotient \mathfrak{p}_i)(l_i),\quad \text{ as graded $S$-module }
\end{align}
  \item The set of minimal elements of the set $\set{\mathfrak{p}_1,\dots ,\mathfrak{p}_q}$ is exactly the set of minimal prime ideals over $\operatorname{Ann}(M)$. 
  \item For each minimal prime $\mathfrak{p}$ over $\operatorname{Ann}(M)$, the number of times which $\mathfrak{p}$ occur in the set $\set{\mathfrak{p}_1,\dots ,\mathfrak{p}_q}$ equals to $\mu_{\mathfrak{p}}(M)$.  
\end{enumerate}
Because for each $1\leq i\leq q$ we have short exact sequence of graded $S$-modules:
 \begin{align*}
0 \longrightarrow M^{i-1}\longrightarrow M^i \longrightarrow M^i \quotient M^{i-1} \longrightarrow 0
\end{align*}
We have $\phi_{M^i}=\phi_{M^{i-1}}+\phi_{M^i\quotient M^{i-1}}$, which by \myref{Corollary}{Ponp} give us $P_{M^i}=P_{M^{i-1}}+P_{M^i\quotient M^{i-1}}$. It now follows from induction and \myref{Equation}{Miqmi} that $P_M = \sum_{i=1}^q P_{(S\quotient \mathfrak{p}_i)(l_i)}$. Because shifting doesn't effect leading coefficients of Hilbert polynomial\footnote{This can be easily check by computing $G(z)\triangleq F(l+z)$.} and because of \myref{Equation}{Tlt}, it only remains to prove:
\begin{align*}
\text{ The leading coefficient of polynomial }\sum_{i=1}^q P_{S\quotient \mathfrak{p}_i}\text{ equals to } \frac{\sum_{j=1}^s i(Y,H;C_j)\cdot \operatorname{deg}C_j}{(r-1)!}
\end{align*}
Denote $r_i\triangleq \operatorname{Topdim}(Z(\mathfrak{p}_i))=\operatorname{Krudim}(S\quotient \mathfrak{p}_i)$, and denote $f_i\triangleq \operatorname{deg}(Z(\mathfrak{p}_i))$. Recall that 
\begin{enumerate}[label=(\roman*)]
  \item Because $\set{I(C_1),\dots ,I(C_s)}$ is exactly the set of minimal prime ideals over  $I(Y)+I(H)=\operatorname{Ann}(M)$ as shown in the paragraph before this theorem, by construction, $\set{I(C_1),\dots ,I(C_s)}$ is exactly the set of minimal elements of the set $\set{\mathfrak{p}_1,\dots ,\mathfrak{p}_q}$. 
  \item By  \customref{PDT}{projective dimension theorem}, $\operatorname{Topdim}(C_j)= r-1$.
\end{enumerate}
Therefore, by \customref{sdt}{fake dimension theorem}, $\mathfrak{p}_i \in \set{I(C_1),\dots , I(C_s)}\iff r_i=r-1$. By \customref{HST}{Hilbert-Serre Theorem}, $P_{S\quotient \mathfrak{p}_i}$ have degree $r_i$ and therefore have leading term $\frac{f_i}{r_i!}z^{r_i}$. We now see conclude by (III) that indeed, the leading coefficient of $\sum_{i=1}^q P_{S\quotient \mathfrak{p}_i}$ equals to 
\begin{align*}
\frac{\sum_{r_i=r-1}f_i}{(r-1)!}=  \frac{\sum_{\mathfrak{p}_i \in \set{I(C_1),\dots ,I(C_s)}}f_i}{(r-1)!}=  \frac{\sum_{j=1}^q \mu_{I(C_j)}(M)\cdot \operatorname{deg}(C_j)}{(r-1)!}
\end{align*}
\end{proof}
\begin{corollary}
\textbf{(Bezout's Theorem for $\P^2$)} Let $k$ be algebraically closed and $H_1\triangleq Z(F_1),H_2\triangleq Z(F_2)$ be two hypersurfaces in $\P^2$. If $H_1 \cap H_2$ is finite, says, $H_1 \cap H_2= \set{P_1,\dots ,P_s}$, then: 
\begin{align*}
\sum i(H_1,H_2;P_j)= (\operatorname{deg}F_1)(\operatorname{deg}F_2)
\end{align*}
\end{corollary}
\begin{proof}
This follows from \customref{GBT}{Bezout theorem for a variety and a hypersurface in $\P^n$} and the fact  \customref{Dos}{$\operatorname{deg}(P_i)=1$ and  $\operatorname{deg}(H_j)=\operatorname{deg}(F_j)$}. 
\end{proof}
\chapter{Schemes}
\section{Direct limit}
We say that a pair $(X,\leq )$ forms a \textbf{preordered set} f the relation $\leq $ is reflexive and transitive. Given a preordered set $(X,\leq )$, an element $x \in X$ is called an \textbf{upper bound} of a subset $Y \subseteq X$ if  $y\leq x$ for all $y \in Y$. If every finite subset of $X$ has an upper bound, then  $(X,\leq )$ is called a \textbf{directed set}.  \\

Let $(I,\leq )$ be a directed set, $\mathfrak{C}$ a category, and $\set{A_i \in \mathfrak{C}: i \in I}$ a family of objects in $\mathfrak{C}$. If for each pair $i\leq j$, there exists a morphism $f_{ij}:A_i \rightarrow A_j$, satisfying: 
\begin{enumerate}[label=(\roman*)]
  \item For all $i \in I$, $f_{ii}$ is the identity morphism.  
  \item For all $i\leq j\leq k$, we have $f_{ik}=f_{jk}\circ f_{ij}$. 
\end{enumerate}
then we say $(A_i,f_{ij})$ forms a \textbf{direct system} over $I$. Given a direct system $(A_i,f_{ij})$, an object $B \in \mathfrak{C}$, together with morphisms $\phi_i:A_i\rightarrow B$ for each $i \in I$, is called a \textbf{target} if for all $i\leq j$, the compatibility condition
\begin{align*}
\phi_i=\phi_j \circ f_{ji}
\end{align*}
holds. The \textbf{direct limit} of the system, denoted $A\triangleq \varinjlim A_i$, is a target $(A,\phi_i)$ that satisfies the following \textbf{universal property}: For any target $(B,\psi_i)$, there exists a unique morphism $u:A\rightarrow B$ that makes the diagram:
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJBX2kiXSxbMiwwLCJBX2oiXSxbMSwyLCJBIl0sWzEsNCwiQiJdLFswLDEsImZfe2lqfSJdLFsyLDMsInUiXSxbMCwzLCJcXHBzaV9pIiwyLHsiY3VydmUiOjN9XSxbMSwzLCJcXHBzaV9qIiwwLHsiY3VydmUiOi0zfV0sWzAsMiwiXFxwaGlfaSIsMl0sWzEsMiwiXFxwaGlfaiJdXQ==
\[\begin{tikzcd}
	{A_i} && {A_j} \\
	\\
	& A \\
	\\
	& B
	\arrow["{f_{ij}}", from=1-1, to=1-3]
	\arrow["{\phi_i}"', from=1-1, to=3-2]
	\arrow["{\psi_i}"', curve={height=18pt}, from=1-1, to=5-2]
	\arrow["{\phi_j}", from=1-3, to=3-2]
	\arrow["{\psi_j}", curve={height=-18pt}, from=1-3, to=5-2]
	\arrow["u", from=3-2, to=5-2]
\end{tikzcd}\]
commute for each $i\leq j$. \\


As one might expect, direct limits are indeed unique up to a unique isomorphism. In the remainder of this note, we refer to a category as a \textbf{good category} if it is the category of groups, rings, modules over a fixed ring, or algebras over a fixed ring. In such good categories, the existence of direct limits can be established by explicitly constructing:
\begin{align*}
A \triangleq \left( \bigsqcup A_i \right) \big/ \sim, \quad \text{where } x_i \sim x_j \overset{\triangle}{\iff} f_{ki}(x_i) = f_{kj}(x_j) \text{ for some } k \geq i,j.
\end{align*}




\section{Presheaves}
Let $X$ be a topological space and $\mathfrak{C}$ a category. A \textbf{presheaf $\mathcal{F}$ of $\mathfrak{C}$-objects on $X$} consists of the following data:
\begin{enumerate}[label=(\roman*)]
  \item For each open subset $U \subseteq X$, an object $\mathcal{F}(U)\in \mathfrak{C}$. We call elements of $\mathcal{F}(U)$ \textbf{sections of $\mathcal{F}$ over} $U$. 
  \item For each inclusion of open sets $V\subseteq U$, a morphism (called the \textbf{restriction map}) $\operatorname{Res}^U_V:\mathcal{F}(U)\rightarrow \mathcal{F}(V)$ in $\mathfrak{C}$. For obvious reason, we write $\operatorname{Res}^U_V(s)\triangleq s |_V$. 
\end{enumerate}
subject to the following conditions: 
\begin{enumerate}[label=(\alph*)]
  \item $\mathcal{F}(\varnothing )$ is a final object of $\mathfrak{C}$. 
  \item \textbf{(Identity Law)} For every open set $U \subseteq X$, the restriction map $\operatorname{Res}^U_U$ is the identity morphism on $\mathcal{F}(U)$. 
  \item \textbf{(Composition Law)} For all open sets $W\subseteq V \subseteq U$, the composition law holds: 
    \begin{align*}
    \operatorname{Res}^U_W =\operatorname{Res}^V_W \circ \operatorname{Res}^U_V
    \end{align*}
\end{enumerate}
For example, if we say that \( \mathcal{F} \) is a \textbf{presheaf of sets} on \( X \), we mean that for each open subset \( U \subseteq X \), \( \mathcal{F}(U) \) is a set, each restriction map \( \operatorname{Res}^U_V : \mathcal{F}(U) \to \mathcal{F}(V) \) is a function between sets, the identity and composition laws hold, and \( \mathcal{F}(\varnothing) = \{\varnothing\} \). Similarly, if \( \mathcal{F} \) is a \textbf{presheaf of rings} on \( X \), then each \( \mathcal{F}(U) \) is a ring, each restriction map \( \operatorname{Res}^U_V \) is a ring homomorphism, and \( \mathcal{F}(\varnothing)=\Z_1 \). Likewise, a \textbf{presheaf of groups} consists of group-valued assignments: each \( \mathcal{F}(U) \) is a group, the restriction maps are group homomorphisms, and $\mathcal{F}(\varnothing )=\Z_1$. Note that given a sheaf $\mathcal{F}$ on $X$, we often denote the global section object by $\Gamma  (X,\mathcal{F})$.\\

Fix $\mathfrak{C}$ and $X$. One may check that a $\mathfrak{C}$-valued presheaf on $X$ forms a category   if we define a \textbf{morphism} $\phi$ from $\mathcal{F}$ to $\mathcal{G}$ to be an assignment of each open $U \subseteq X$ a $\mathfrak{C}$-morphism  $\phi (U):\mathcal{F}(U)\rightarrow \mathcal{G}(U)$ such that for every inclusion $V \subseteq U$, the diagram:
\begin{equation}
\label{FPU}
\begin{tikzcd}
\mathcal{F}(U) \arrow[r, "\phi_U"] \arrow[d, "\operatorname{Res}^{\mathcal{F}}_{UV}"'] & \mathcal{G}(U) \arrow[d, "\operatorname{Res}^{\mathcal{G}}_{UV}"] \\
\mathcal{F}(V) \arrow[r, "\phi_V"] & \mathcal{G}(V)
\end{tikzcd}
\end{equation}
commutes. We denote the category of $\mathfrak{C}$-valued presheaves on $X$ by $\text{\textbf{PSh}}_{\mathfrak{C}}(X)$. Note that if $\mathfrak{C}$ has a final object, then the final object of $\text{\textbf{PSh}}_{\mathfrak{C}}(X)$ exist and is just the presheaf that send each open subset of $X$ to the final object of  $\mathfrak{C}$. Let $\mathcal{F} \in\text{\textbf{PSh}}_{\mathfrak{C}}(X)$. A \textbf{subpresheaf} $\mathcal{G}$ of $\mathcal{F}$ consists of the assignment to each open set $U \subseteq X$ a subobject $\mathcal{G}(U) \subseteq  \mathcal{F}(U)$ such that for every inclusion of open sets  $V \subseteq U$, the restriction map $\mathcal{F}(U)\rightarrow \mathcal{F}(V)$ sends $\mathcal{G}(U)$ into $\mathcal{G}(V)$. Because of our extra requirement, we may well define the restriction maps of $\mathcal{G}$ to be that of $\mathcal{F}$.\\ 


Let $\mathcal{F}$ be a abelian-group-valued presheaf on $X$ and  $\mathcal{G}$ a subpresheaf of $\mathcal{F}$. The \textbf{quotient presheaf} $\mathcal{F}\quotient \mathcal{G}$ assign $U\mapsto  \mathcal{F}(U)\quotient \mathcal{G}(U)$. Let $V \subseteq U$. Because the restriction morphism $\mathcal{F}(U)\rightarrow \mathcal{F}(V)$ send $\mathcal{G}(U)$ into $\mathcal{G}(V)$, we may define the restriction map $\mathcal{F}(U)\quotient \mathcal{G}(U)\rightarrow \mathcal{F}(V)\quotient \mathcal{G}(V)    $ via the universal property for quotient groups:
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGJ1bGxldCJdLFszLDAsIlxcYnVsbGV0Il0sWzMsMywiXFxidWxsZXQiXSxbMCwzLCJcXGJ1bGxldCJdLFswLDEsImpfVSJdLFsxLDIsIlxcdGlsZGV7al9WXFxjaXJjIFxcb3BlcmF0b3JuYW1le1Jlc319IiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV0sWzAsM10sWzMsMl1d
\[\begin{tikzcd}
	\mathcal{F}(U)  &&& \mathcal{F}(U)\quotient \mathcal{G}(U)   \\
	\\
	\\
	\mathcal{F}(V)  &&& \mathcal{F}(V)\quotient \mathcal{G}(V)  
	\arrow[ two heads,from=1-1, to=1-4]
	\arrow["{\operatorname{Res}}",from=1-1, to=4-1]
	\arrow[ dotted, from=1-4, to=4-4]
	\arrow[ two heads,from=4-1, to=4-4]
\end{tikzcd}\]



Let $\mathfrak{C}$ be a good category and $\phi: \mathcal{F}\rightarrow \mathcal{G}$ be a presheaf morphism for two $\mathfrak{C}$-valued presheaf on  $X$. In the category of $\mathfrak{C}$-valued presheaves, \textbf{image} of $\phi$ assigns $U \rightarrow \operatorname{Im} (\phi (U))$, 



good category and $\phi \in \operatorname{Hom}_{\text{\textbf{PSh}}_{\mathfrak{C}}(X)} (\mathcal{F},\mathcal{G}) $. The \textbf{presheaf image} of $\phi$ assigns $U \mapsto \operatorname{Im}(\phi(U)) \subseteq \mathcal{G}(U)$ and has the restriction map of $\mathcal{G}$.  The \textbf{presheaf kernel} of $\phi$ assigns $U \mapsto \operatorname{Ker}(\phi (U))\subseteq \mathcal{F}(U)$ and has the restriction map of $\mathcal{F}$. The \textbf{presheaf cokernel} of $\phi$ assigns $U \mapsto  \operatorname{Coker}(\phi (U))$ and has the restriction map $\operatorname{Coker}(\phi (U))\rightarrow \operatorname{Coker}(\phi (V));[t]\mapsto [\operatorname{Res}^\mathcal{G}_{UV}(t)]$. Note that the image, kernel, and cokernel of $\phi$ are well-defined because we require \myref{diagram}{FPU} to commute, and the image presheaf of $\phi$ is indeed a subpresheaf of $\mathcal{G}$, while the kernel presheaf of $\phi$ is a subpresheaf of $\mathcal{F}$. \\









Just like other categories, a presheaf isomorphism is again a morphism that admits a two-sided inverse.\\











Let $P \in X$, $\mathfrak{C}$ a good category, and $\mathcal{F}$ a $\mathfrak{C}$-valued presheaf on  $X$. Its \textbf{stalk} $\mathcal{F}_P$ at $P$ is the direct limit of the directed system $(\mathcal{F}(U), \operatorname{Res})$ over all open neighborhoods $U \ni P$. Therefore, an element of $\mathcal{F}_P$ is an equivalence class represented by a pair $(U, s)$ with $s \in \mathcal{F}(U)$, and two such pairs $(U, s),(V, t)$ represent the same element if there exists a  neighborhood $W \subseteq U \cap V$ of $P$ such that $s|_W = t|_W$. Let $\phi \in \operatorname{Hom}_{\text{\textbf{PSh}}_{\mathfrak{C}}(X)}(\mathcal{F},\mathcal{G})$. It induces a $\mathfrak{C}$-homomorphism $\phi_P \in \operatorname{Hom}(\mathcal{F}_P,\mathcal{G}_P)$ via universal property of direct limit: 
% https://q.uiver.app/#q=WzAsNyxbMiwxLCJGX1AiXSxbMiwzLCJHX1AiXSxbMSwwLCJGKFUpIl0sWzMsMCwiRihWKSJdLFswLDEsIkcoVSkiXSxbNCwxLCJHKFYpIl0sWzEsMV0sWzIsNCwiXFxwaGkgKFUpIiwyXSxbMyw1LCJcXHBoaSAoVikiXSxbMiwwXSxbMywwXSxbMCwxLCIiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifX19XSxbNSwxXSxbNCwxXV0=
\[\begin{tikzcd}
	& {\mathcal{F} (U)} && {\mathcal{F} (V)} \\
	{\mathcal{G} (U)} & {} & {\mathcal{F} _P} && {\mathcal{G} (V)} \\
	\\
	&& {\mathcal{G} _P}
	\arrow["{\phi (U)}"', from=1-2, to=2-1]
	\arrow[from=1-2, to=2-3]
	\arrow[from=1-4, to=2-3]
	\arrow["{\phi (V)}", from=1-4, to=2-5]
	\arrow[from=2-1, to=4-3]
	\arrow["\phi_P",dotted, from=2-3, to=4-3]
	\arrow[from=2-5, to=4-3]
\end{tikzcd}\]




In particular, recall that when $X$ is a quasi-variety, we denote by $\mathcal{O} (U)$ the ring of regular functions on an open set $U \subseteq X$, and by $\mathcal{O} _p$ the local ring of $X$ at a point $p \in X$. One can verify that $\mathcal{O} $ defines a presheaf on $X$, and that its stalk at $p$ coincides with the local ring $\mathcal{O}_p$which is precisely why we adopt this notation in the first place. \\

Given a sheaf $\mathcal{F}$ on $X$, a subspace $Z \subseteq X$, and a continuous map  $f:X\rightarrow Y$, and a presheaf $\mathcal{G}$ on $Y$, the \textbf{direct image presheaf} $f_*\mathcal{F}$ is a presheaf on $Y$ defined by $U\mapsto \mathcal{F}(f^{-1}(U))$ with the restriction map being that of $\mathcal{F}$, the \textbf{inverse image presheaf} $f^{-1}\mathcal{G}$ is the presheaf $U \mapsto \lim_{ V \supseteq f(U) }\mathcal{G}(V)$, and the \textbf{restriction sheaf} of $\mathcal{F}$ onto $Z$ denoted by $\mathcal{F}|_Z$ is simply the inverse image presheaf of  $\mathcal{F}$ under the inclusion map $Z \hookrightarrow X$.     

\section{Sheaves}
We call a presheaf $\mathcal{F}$ on $X$ a \textbf{sheaf} if for every union of open sets $U= \bigcup_{i \in I}V_i$, we have 
\begin{enumerate}[label=(\roman*)]
  \item \textbf{(Separated Axiom)} If $s,t \in \mathcal{F}(U)$ satisfies $s|_{V_i}=t |_{V_i}$ for all $i$, then  $s=t$.  
  \item \textbf{(Gluing Axiom)} If $\set{s_i \in V_i: i \in I}$ satisfies $s_i|_{V_i \cap V_j}=s_j|_{V_i\cap V_j}$, then there exists unique \textbf{gluing section} $s \in \mathcal{F}(U)$ such that $s|_{V_i}=s_i$ for all $i$. 
\end{enumerate}
\begin{theorem}
\label{THgpos}
\textbf{(Properties of presheaves that satisfies separated axiom)}  Let  $X$ be a topological space, $\mathfrak{C}$ a good category,  $\mathcal{F}$ a $\mathfrak{C}$-valued presheaf  on $X$ that satisfies separated axiom, and $s \in \mathcal{F}(U)$. Then:  
\begin{enumerate}[label=(\roman*)]
  \item If $s_P =0 \in \mathcal{F}_P$ for all $P \in U$, then $s=0 \in \mathcal{F}(U)$.  
  \item If $s_P=1 \in \mathcal{F}_P$ for all $P \in U$, then $s=1 \in \mathcal{F}(U)$
\end{enumerate}
\end{theorem}
\begin{proof}
Use separated axiom to conclude that if such $s \in \mathcal{F}(U)$ really exists, then it equal $0$ or $1 \in \mathcal{F}(U) $. 
\end{proof}
\begin{theorem}
\textbf{(What need to be sheafified)} Let $X,Y$ be two topological spaces, $Z \subseteq X$ a topological subspace, $f:X\rightarrow Y$ a continuous map, $\mathfrak{C}$ a good category, $\mathcal{F},\mathcal{G}$ two sheaves on $X$, $\mathcal{E}$ a subsheaf of $\mathcal{F}$, $\phi: \mathcal{F}\rightarrow \mathcal{G}$ a sheaf morphism, and $\mathcal{H}$ a sheaf on $Y$. The following presheaves are always sheaves: 
\begin{enumerate}[label=(\roman*)] 
  \item Direct image sheaf $f_*\mathcal{F}$. 
  \item Kernel sheaf $\operatorname{Ker}(\phi)$. 
\end{enumerate}
The following presheaves may not always be a sheaf: 
\begin{enumerate}[label=(\roman*)]
  \item  Quotient presheaf $\mathcal{F}\quotient \mathcal{E}$. 
  \item Restriction presheaf $\mathcal{F}|_Z$.   
  \item Inverse image presheaf $f^{-1}\mathcal{H}$. 
  \item Image presheaf $\operatorname{Im}(\phi)$. 
  \item Cokernel presheaf $\operatorname{Coker}(\phi)$. 
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}
\begin{definition}
\textbf{(Constant sheaves of abelian groups)} Let $X$ be a topological space and $A$ an abelian group. Give  $A$ the discrete topology. One may check that assigning $\mathcal{A}(U)$ to be the abelian group of all continuous functions form a sheaf with the obvious restriction map forms a sheaf on $X$.\footnote{Use paste lemma to prove the gluing law.}$\mathcal{A}$ is called the \textbf{constant sheaf of $A$ on  $X$}. The naming comes from the fact that for every connected $U\subseteq X$, the abelian group $\mathcal{A}(U)$ is isomorphic to $A$. 
\end{definition}


For each $\mathfrak{C}$-valued presheaf $\mathcal{F}$ on $X$, its \textbf{sheafification}  is the unique (up to a unique isomorphism) $\mathfrak{C}$-valued sheaf $\mathcal{F}^+$ on $X$ together with a $\mathfrak{C}$-valued sheaf morphism $\theta :\mathcal{F}\rightarrow \mathcal{F}^+$ that satisfies the \textbf{universal property}: For each  $\mathfrak{C}$-valued sheaf homomorphism $\phi: \mathcal{F}\rightarrow \mathcal{G}$, there exists a unique $\mathfrak{C}$-valued sheaf homomorphism $\tilde{\phi}:\mathcal{F}^+ \rightarrow \mathcal{G}$ that makes the diagram: 
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXG1hdGhjYWx7Rn0iXSxbMiwwLCJcXG1hdGhjYWx7Rn1eKyJdLFsyLDIsIlxcbWF0aGNhbHtHfSJdLFswLDEsIlxcdGhldGEgIl0sWzEsMiwiXFx0aWxkZXtcXHBoaX0iXSxbMCwyLCJcXHBoaSIsMl1d
\[\begin{tikzcd}
	{\mathcal{F}} && {\mathcal{F}^+} \\
	\\
	&& {\mathcal{G}}
	\arrow["{\theta }", from=1-1, to=1-3]
	\arrow["\phi"', from=1-1, to=3-3]
	\arrow["{\tilde{\phi}}", dotted,from=1-3, to=3-3]
\end{tikzcd}\]
commute.  
\begin{theorem}
\label{THsff}
\textbf{(Existence of sheafification of sheaves of good category)} Let $X$ be a topological space, and  $\mathcal{F}$ a presheaf of abelian groups on $X$. The sheafification can be defined by setting  $\mathcal{F}^{+}(U)$ to be the set of functions $s:U\rightarrow \bigsqcup _{P \in U} \mathcal{F}_P$ such that: 
\begin{enumerate}[label=(\roman*)]
  \item $s(P)\in \mathcal{F}_P$. 
  \item For each $P \in U$, there exists neighborhood  $V$ of  $P$ contained by  $U$, and an element $t \in \mathcal{F}(V)$ such that we have $[(V,t )]=s(Q)\in \mathcal{F}_Q$ for all $Q \in V$.  
\end{enumerate}
with the usual restriction map forms a sheaf that satisfies the universal property.   
\end{theorem}
\begin{proof}
It is not difficult to check that $\mathcal{F}^+$ forms a sheaf. The morphism $\theta: \mathcal{F}\rightarrow \mathcal{F}^+  $ is given by: 
\begin{align*}
  g \in \mathcal{F}(U)\mapsto s \in \mathcal{F}^+(U),\quad\text{ where }s (P)= [(U,g)]\in \mathcal{F}_P 
\end{align*}
We now show $(\mathcal{F}^+,\theta )$ satisfies the universal property. Fix $\phi : \mathcal{F}\rightarrow \mathcal{G}$, we may define $\tilde{\phi}:\mathcal{F}^+ \rightarrow \mathcal{G}$ by mapping $s \in \mathcal{F}^+(U)\mapsto  f\in \mathcal{G}(U)$  where $f\in \mathcal{G}(U) $ is the gluing section of $\set{ \phi(t) \in \mathcal{G}(V): P \in V \subseteq U, t \in \mathcal{F}(V): [(V,t)]=s(Q)\in \mathcal{F}_Q\text{ for all }Q \in V}_{P \in U}$. 
\end{proof}
\begin{theorem}
\label{THshe}
\textbf{(Properties of sheafs)} Let $X$ be a topological space, $\mathfrak{C}$ a good category, $Y \subseteq X$, $\mathcal{G}$ a $\mathfrak{C}$-valued presheaf on $X$,   $\mathcal{F},\mathcal{H}$ two $\mathfrak{C}$-valued sheaves on $X$, and $\phi: \mathcal{F}\rightarrow \mathcal{H}$ a $\mathfrak{C}$-valued sheaf morphism. Then:
\begin{enumerate}[label=(\roman*)]
  \item The sheafification  $\theta :\mathcal{F} \rightarrow \mathcal{F}^+$ is a sheaf isomorphism. 
  \item $\phi (U):\mathcal{F}(U)\rightarrow \mathcal{H}(U)$ are injective for all $U$ if and only if  $\phi_P:\mathcal{F}_P \rightarrow \mathcal{H}_P$ are injective for all $P \in X$. 
  \item For all $x \in Y$, we have $(\mathcal{F}|_Y)_x \cong  \mathcal{F}_x$. 
  \item Sheafification $\theta_x:\mathcal{G}_x \rightarrow \mathcal{G}^+_x$ on stalk are isomorphism.
  \item If $\mathcal{G}$ satisfies separateness law, then sheafification $\mathcal{G}\rightarrow \mathcal{G}^{+}  $ is injective. 
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}
For simplicity, we shall from now on use (ii) of \myref{Theorem}{THshe} without explicit quotation. Let $\mathfrak{C}$ be the category of abelian group. Even though the kernel of a sheaf homomorphism must be also be a sheaf, the image we define earlier may only be a presheaf. Because of such, in the category $\textbf{\text{Sh}}_{\mathfrak{C}}(X)$ of sheaf of abelian groups on $X$, we define \textbf{image of a sheaf homomorphism}  $\phi : \mathcal{F}\rightarrow \mathcal{G}  $ to be the sheafification of the induced sheaf $U \mapsto  \phi (\mathcal{F}(U))$. 
\begin{equiv_def}
\textbf{(Short exact sequences of sheaves of abelian groups)} Let $X$ be a topological space and let 
\begin{align*}
0\longrightarrow \mathcal{F} \longrightarrow \mathcal{G} \longrightarrow \mathcal{H} \longrightarrow 0
\end{align*}
be a short sequence of sheaves of abelian groups on $X$. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $0\rightarrow \mathcal{F} \rightarrow \mathcal{G} \rightarrow \mathcal{H} \rightarrow 0$ is exact. 
  \item For all open $U \subseteq X$, the sequence $0\rightarrow \mathcal{F}(U) \rightarrow \mathcal{G}(U)\rightarrow \mathcal{H}(U)\rightarrow 0$ is exact.
  \item For all $P \in X$, the sequence $0 \rightarrow \mathcal{F}_P \rightarrow \mathcal{G}_P \rightarrow \mathcal{H}_P  \rightarrow 0 $ is exact. 
\end{enumerate}
\end{equiv_def}
\begin{proof}

\end{proof}

\begin{theorem}
\textbf{(Gluing lemma for sheaves)} Let $X$ be a topological space, $\mathfrak{C}$ a good category, and $\mathfrak{U}= \set{U_i} $ an open cover of $X$. Suppose:
\begin{enumerate}[label=(\roman*)]
  \item For each $i$, $\mathcal{F}_i$ is a $\mathfrak{C}$-valued sheaf on $U_i$. 
  \item For each $i$ and $j$, a $\mathfrak{C}$-valued sheaf isomorphism $\phi_{ij}:\mathcal{F}_i |_{U_i \cap U_j} \rightarrow  \mathcal{F}_j |_{U_i \cap U_j}$. 
  \item For each $i$, $\phi_{ii}$ is the identity $\mathfrak{C}$-valued sheaf morphism on $U_i$. 
  \item For each $i,j,k$ and $V \subseteq U_i \cap U_j \cap U_k$, we have  $\phi_{ik}(V)=\phi_{jk}(V)\circ \phi_{ij}(V)$.    
\end{enumerate}
\end{theorem}
Then, there exists a unique $\mathfrak{C}$-valued sheaf $\mathcal{F}$ on $X$, together with $\mathfrak{C}$-valued sheaf isomorphism $\psi_i:\mathcal{F}|_{U_i} \rightarrow \mathcal{F}_i$ such that for each $i,j$ and $V \subseteq U_i \cap U_j$, we have $\psi_j (V)=\phi_{ij}(V)\circ \psi_i (V)$. 
\begin{proof}
See https://math.stackexchange.com/questions/2367893/details-of-gluing-sheaves-on-a-cover  
\end{proof}







\section{Schemes}
Let $A$ be a ring and  $\mathfrak{a}$ an ideal in $A$. We denote $V(\mathfrak{a})\subseteq \operatorname{Spec}A$ the set of prime ideals that contains $\mathfrak{a}$. 
\begin{theorem}
\label{Zto}
  \textbf{(Zariski topology on $\operatorname{Spec}A$)}  Let $A$ be a ring and  $\set{\mathfrak{a}_{\alpha }}$ a collection of ideas in $A$. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $V(A)=\varnothing $ and $V(0)= \operatorname{Spec}A$. 
  \item $V(\mathfrak{a}_1)\cup  V(\mathfrak{a}_2)= V(\mathfrak{a}_1 \cap \mathfrak{a}_2) $. 
  \item $\bigcap V(\mathfrak{a}_\alpha )= V\left(\sum  \mathfrak{a}_\alpha \right)$. 
  \item $V(\mathfrak{a}_1) \subseteq V(\mathfrak{a}_2)\iff \sqrt{\mathfrak{a}_1} \supseteq \sqrt{\mathfrak{a}_2}  $
\end{enumerate}
\end{theorem}
\begin{proof}
  (i) is clear. (ii) follows from the basic property that   \customref{Pop}{if a prime ideal contains the intersection of a finite collection of ordinary ideals, then the prime contains at least one of the ordinary ideal}. (iii) follows from the fact that \customref{Soi}{sum of any collection of ideal is the smallest ideal that contains the union the collection}. (iv) follows form the \customref{Roi}{equivalent definitions of radical ideals}. 
\end{proof}
Because of \myref{theorem}{Zto}, we may define \textbf{Zariski topology}  on $\operatorname{Spec}A$ by defining the closed subset to be $\set{V(\mathfrak{a})\subseteq \operatorname{Spec}A: \mathfrak{a}\subseteq A\text{ is an ordinary ideal.}}$. Note that for each $f \in A$, we may associate it with an open subset of $\operatorname{Spec}A$ by defining 
\begin{align*}
D(f)\triangleq \operatorname{Spec}A-V(\langle f\rangle )
\end{align*}
A \textbf{ringed space} is a pair $(X,\mathcal{O}_X)$ consisting of a topological space $X$ and a sheaf of rings  $\mathcal{O}$ on $X$ called the \textbf{structure sheaf}. A \textbf{ringed space morphism} from $(X,\mathcal{O}_X)$ to $(Y,\mathcal{O}_Y)$ is a pair $(f,f^\sharp)$ of a continuous map $f:X\rightarrow Y$ and a ring-valued sheaf morphism $f^{\sharp}: \mathcal{O}_Y \rightarrow f_*\mathcal{O}_X$ from the structure sheaf $\mathcal{O}_Y$ of $Y$ to the direct image sheaf $f_* \mathcal{O}_X$ of $\mathcal{O}_X$ under $f:X\rightarrow Y$.    \\


A ringed space is called a \textbf{locally ringed space} if the stalk of its structure sheaf at each point is a local ring. Let $(X,\mathcal{O}_X)$ be a locally ringed space. A \textbf{locally ringed space morphism} is a ringed space morphism $(f,f^{\sharp})$ from one locally ringed space $(X,\mathcal{O}_X)$ to another $(Y,\mathcal{O}_Y)$ such that for each $P \in X$, when we induce ring homomorphism $f^{\sharp}_P: \mathcal{O}_{Y,f(P)} \rightarrow \mathcal{O}_{X,P}  $ via the universal property for direct limit: 
% https://q.uiver.app/#q=WzAsNixbMSwxLCJPIl0sWzEsMywiXFxidWxsZXQiXSxbMCwyLCJcXGJ1bGxldCJdLFswLDAsIlxcYnVsbGV0Il0sWzIsMCwiXFxidWxsZXQiXSxbMiwyLCJcXGJ1bGxldCJdLFszLDBdLFszLDIsImZee1xcc2hhcnB9KFUpIiwyXSxbMiwxXSxbNCwwXSxbNCw1LCJmXntcXHNoYXJwfShWKSJdLFs1LDFdLFswLDEsImZee1xcc2hhcnB9X1AiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifX19XV0=
\[\begin{tikzcd}
	\mathcal{O}_Y(U) && \mathcal{O}_Y(V)  \\
	& \mathcal{O}_{Y,f(P)}  \\
	\mathcal{O}_X(f^{-1}(U))  && \mathcal{O}_X(f^{-1}(V))  \\
	& \mathcal{O}_{X,P}  
	\arrow[from=1-1, to=2-2]
	\arrow["{f^{\sharp}(U)}"', from=1-1, to=3-1]
	\arrow[from=1-3, to=2-2]
	\arrow["{f^{\sharp}(V)}", from=1-3, to=3-3]
	\arrow["{f^{\sharp}_P}"{description}, dotted, from=2-2, to=4-2]
	\arrow[from=3-1, to=4-2]
	\arrow[from=3-3, to=4-2]
\end{tikzcd}\]
The ring homomorphism $f^{\sharp}_P:\mathcal{O}_{Y,f(P)} \rightarrow \mathcal{O}_{X,P}$ is moreover a local ring homomorphism. Let $(f,f^{\sharp})$  be a locally ringed space morphism from $X$ to  $Y$, and let  $(g,g^{\sharp})$ be a locally ringed space morphism from $Y$ to $Z$. Fix $U \subseteq Z$. Because direct image sheaf is defined by 
\begin{enumerate}[label=(\roman*)]
  \item $(g_*\mathcal{O}_Y)_U \triangleq \mathcal{O}_{Y,g^{-1}(U)} $. 
  \item $((f\circ g)_* \mathcal{O}_X)_U \triangleq  \mathcal{O}_{X,f^{-1}(g^{-1}(U))} $. 
\end{enumerate}
We may define the \textbf{composition of locally ringed space morphism} $(f\circ g)^\sharp: \mathcal{O}_Z \rightarrow (f\circ g)_* \mathcal{O}_X$ by:  
\begin{align*}
  (f\circ g)^\sharp |_U \triangleq  f^{\sharp} |_{g^{-1}(U)} \circ g^{\sharp} |_U   
\end{align*}
This makes locally ringed spaces a category. We define  \textbf{restriction of locally ringed space morphism} as follows: 
\begin{theorem}
\textbf{(Restriction of locally ringed space morphisms)} Let $f:X\rightarrow Y$ be a morphism of locally ringed spaces, and $U \subseteq X,V \subseteq Y$ two open subsets that makes $f(U)\subseteq V$. There exists a unique $f|_U: U \rightarrow V$ locally ringed space morphism that makes the diagram: 
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJYIl0sWzIsMCwiWSJdLFswLDIsIlUiXSxbMiwyLCJWIl0sWzAsMSwiZiJdLFsyLDBdLFszLDFdLFsyLDMsImZ8X1UiLDJdXQ==
\[\begin{tikzcd}
	X && Y \\
	\\
	U && V
	\arrow["f", from=1-1, to=1-3]
	\arrow[from=3-1, to=1-1]
	\arrow["{f|_U}"', from=3-1, to=3-3]
	\arrow[from=3-3, to=1-3]
\end{tikzcd}\]
commutes in the category of locally ringed space. 
\end{theorem}
\begin{proof}

\end{proof}
 An \textbf{affine scheme} is a locally ringed space isomorphic as a locally ringed space to the spectrum of some ring. A \textbf{scheme} is a locally ringed space that has an open cover consisting of open sets when equipped with the restricted sheaf is an affine scheme. A \textbf{scheme morphism} is then just a locally ringed space morphism. Let $X,Y$ be two schemes. We 

\begin{theorem}
\label{Poo}
\textbf{(Property of open sets associated with element of the underlying ring)} Let $A$ be a ring, $u\in A$ be a unit in $A$, and $f,g \in A$. Then:\footnote{If you wish, you make think of our notation $D$ stands for "the set of local rings whose denominator Doesn't contain".}
\begin{enumerate}[label=(\roman*)]
  \item $D(f)= \set{\mathfrak{p}\in \operatorname{Spec}A: f \not \in \mathfrak{p}}$. 
  \item $D(f)\subseteq D(g)\iff  V(\langle f\rangle ) \supseteq V(\langle g\rangle )$. 
  \item $D(f)\cap D(g)=D(fg)$.  
  \item $D(u)= \operatorname{Spec}A$. 
\end{enumerate}
\end{theorem}
\begin{proof}
Unroll the definitions.
\end{proof}
The \textbf{structure sheaf} $\mathcal{O}$ on $\operatorname{Spec}A$ is a sheaf of ring defined by  assigning each $U$ the ring of functions  $s:U \rightarrow  \bigsqcup_{\mathfrak{p} \in U} A_\mathfrak{p}$ that satisfies:\footnote{Checking that this indeed forms a sheaf isn't difficult.}
\begin{enumerate}[label=(\roman*)]
  \item $s(\mathfrak{p})\in A_{\mathfrak{p}}$ for all $\mathfrak{p}\in U$.  
  \item  For each $\mathfrak{p}\in U$, there exists neighborhood $V$ of $\mathfrak{p}$ contained by $U$ and exist $a,f\in A$ such that  $f \not \in \mathfrak{q}\text{ and }s(\mathfrak{q})= a\quotient f$ for all  $\mathfrak{q} \in V$. 
\end{enumerate}
\begin{theorem}
\label{THas}
\textbf{(Properties of affine scheme $\operatorname{Spec}A$)} Let $A$ be a ring, and $\mathcal{O}$ the structure sheaf on $\operatorname{Spec}A$. Then:
\begin{enumerate}[label=(\roman*)]
  \item For all $\mathfrak{p}\in \operatorname{Spec}A$, the stalk $\mathcal{O} _\mathfrak{p}\cong  A_{\mathfrak{p}}$ as rings. 
  \item For all $f \in A$, the ring $\mathcal{O} (D(f))\cong  A_f$ as rings. 
  \item $\Gamma (\operatorname{Spec}A) \cong  A$ as rings. 
\end{enumerate}
\end{theorem}
\begin{proof}
  (i): Let  $\phi : \mathcal{O}_\mathfrak{p} \rightarrow A_\mathfrak{p} $ be the ring homomorphism induced by universal property of direct limit with $\mathcal{O}(U)\rightarrow A_{\mathfrak{p}} ; s \mapsto  s(\mathfrak{p})$. In other words, $\phi:\mathcal{O}_{\mathfrak{p}}\rightarrow A_{\mathfrak{p}}$ has the action $[(U,s)]\mapsto s(\mathfrak{p})$. We are required to prove $\phi$ is bijective. Fix $a \quotient f \in A_{\mathfrak{p}}$. Because $\mathfrak{p} \in D(f)$ and because $s \in \mathcal{O}(D(f)),s(\mathfrak{q})\triangleq a\quotient f$ is well defined, we see $\phi$ maps $[(D(f),s)]$ to $a\quotient f$. We have shown $\phi$ is surjective. \\

Let $s,t \in \mathcal{O}(U)$ and $s(\mathfrak{p})=t(\mathfrak{p})$. To prove $\phi$ is injective, we only have to prove $s|_V=t |_V$ for some neighborhood $V \subseteq U$ of $\mathfrak{p}$. By shrinking $U$ if necessary, we may find $a,f,b,g \in A$ such that:
\begin{align*}
  s(\mathfrak{q})\triangleq a\quotient f,t(\mathfrak{q})\triangleq b\quotient g,\quad \text{ for all }\mathfrak{q} \in U. 
\end{align*}
Because $s(\mathfrak{p})=t(\mathfrak{p})$, we know $a\quotient f = b \quotient g \in A_\mathfrak{p}$, which implies $h(ag-bf)=0 \in A$ for some $h \in A - \mathfrak{p}$. We now see that $V \triangleq U \cap D(h)$ suffices. \\

(ii): Let $\psi_f: A_f \rightarrow \mathcal{O}(D(f))$ be the ring homomorphism that sends $a\quotient f^n$ to $s \in \mathcal{O}(D(f))$ where $s(\mathfrak{p})= a \quotient f^n$ for all $\mathfrak{p} \in D(f)$. Let $\psi (a\quotient f^n)=\psi (b \quotient f^m)$. To prove $\psi$ is injective, we only have to prove $a\quotient f^n=b \quotient f^m \in A_f$. \\

Because for each  $\mathfrak{p} \in D(f)$, we have $a\quotient f^n= b \quotient f^m \in A_\mathfrak{p}$ by construction, we know for each $\mathfrak{p} \in D(f)$, there exists $ h \in \operatorname{Ann}(af^m-bf^n)-\mathfrak{p}$ is nonempty, i.e., $\operatorname{Ann}(af^m -bf^n) \not \subseteq \mathfrak{p}$. We have shown that for all $\mathfrak{p} \in D(f)$, we have $\mathfrak{p}\not \in V( \operatorname{Ann}(af^m-bf^n))$. That is, $D(f)\cap V(\operatorname{Ann}(af^m-bf^n))=\varnothing $, which implies $V(\operatorname{Ann}(af^m-bf^n)) \subseteq V(\langle f\rangle )$, which by \myref{theorem}{Zto} further implies $ f\subseteq \sqrt{\operatorname{Ann}(af^m-bf^n)} $. It now follows that $f^r (af^m-bf^n)=0 \in A$ for some $r\geq 0$, which implies $a\quotient f^n = b\quotient f^m \in A_f$, as desired.\\

We now prove $\psi_f$ is surjective. Let $s \in \mathcal{O}(D(f))$. By definition of structure sheaf, we know there exists $\set{h_i \in A: i \in I}$ such that:
\begin{enumerate}[label=(\Roman*)]
  \item $D(f)\subseteq \bigcup_{i \in I}D(h_i)$. 
  \item $s(\mathfrak{p})= a_i \quotient h_i \in A_{\mathfrak{p}}$ for all $i \in I$ and $\mathfrak{p} \in D(h_i)\cap D(f)$. 
\end{enumerate}
where $I$ may be infinite. We claim that there exists finite subset $J \subseteq I$ such that $D(f)\subseteq \bigcup_{i \in J}D(h_i)$. By (I), \customref{Poo}{the relationship between $D(f)$ and $V(\langle f\rangle )$}, and \customref{Zto}{the property of topology of $\operatorname{Spec}A$}, we have: 
\begin{align*}
V\left(\langle f\rangle \right) \supseteq\bigcap_{i \in I} V\left(\langle h_i\rangle \right) = V\left(\sum_{i\in I} \langle h_i\rangle \right) 
\end{align*}
Again, this by \customref{Zto}{the property of topology of $\operatorname{Spec}A$} implies $f \in \sqrt{\sum_{i \in I} \langle h_i\rangle } $, which implies that for $n \gg 0$, we may write $f^n$ as a finite sum: 
\begin{align*}
\label{eqPoa1}
f^n = \sum_{i=1}^r b_ih_i,\quad \text{ where }b_i \in A
\end{align*}
In other words, $f \in \sqrt{\sum_{i=1}^r \langle h_i\rangle } $, which by  \customref{EDRi}{equivalent definitions of radical ideals} implies $\sqrt{\langle f\rangle } \subseteq \sqrt{\sum_{i=1}^r \langle h_i\rangle}  $. The claim now follows from \customref{Zto}{the property of topology of $\operatorname{Spec}A$} and  \customref{Poo}{the relationship between $D(f)$ and $V(\langle f\rangle )$}.\footnote{Note that our argument for finding this finite subcover is morally the same as  \customref{Soi}{equivalent definition of ideals sum}} \\

We from now on write $D(f) \subseteq D(h_1) \cup  \cdots \cup  D(h_r)$. Fix $i$ and $j$. Noting that $\psi_{h_ih_j}:A_{h_ih_j}\rightarrow \mathcal{O}(D(h_ih_j))$ maps both $a_ih_j \quotient h_ih_j$ and $a_jh_i \quotient h_ih_j$ to $\tilde{s} |_{D(h_ih_j)}$, where $\tilde{s}\in \mathcal{O}(D(h_1)\cup  \cdots \cup  D(h_r))$ comes from the gluing axioms of sheaf and:
\begin{align*}
\set{s_l\in \mathcal{O}(D(h_l)): 1\leq l\leq r\text{ and }s_l(\mathfrak{p})\triangleq a_l \quotient h_l\text{ for all }\mathfrak{p} \in D(h_l)}
\end{align*}
we see from injectivity of $\psi_{h_ih_j}:A_{h_ih_j}\rightarrow \mathcal{O}(D(h_ih_j))$ that: 
\begin{align*}
\frac{a_ih_j}{h_ih_j}= \frac{a_jh_i}{h_ih_j} \in A_{h_ih_j}. 
\end{align*}
Because the index set $\set{1,\dots ,r}$ is finite, we have just shown:  
\begin{align}
\label{eqPoa2}
  (h_ih_j)^n a_ih_j = (h_ih_j)^n a_jh_i \in A,\quad \text{ for all }i,j\text{ and }n\gg 0 
\end{align}
Because for all $n\geq 1$,  \customref{Poo}{$D(h_i)=D(h_i^n)$}  and $a_i\quotient h_i = a_ih_i^{n}\quotient h_i^{n+1}\in A_{\mathfrak{p}}$ for all $i$ and $\mathfrak{p}\in D(h_i^n)\cap D(f)$, we now see that for all $n\geq 0$, we have: 
\begin{enumerate}[label=(\Alph*)]
  \item $D(f)\subseteq \bigcup_{i=1}^r D(h_i^n)$. 
  \item $s(\mathfrak{p})=a_ih_i^n \quotient h_i^{n+1}\in A_{\mathfrak{p}}$ for all $1\leq i\leq r$ and  $\mathfrak{p}\in D(h_i^n)\cap D(f)$. 
\end{enumerate}
Again by (A), \customref{Poo}{the relationship between $D(f)$ and $V(\langle f\rangle )$}, and \customref{Zto}{the property of topology of $\operatorname{Spec}A$}, we now have: 
\begin{align*}
f\in \sqrt{\sum_{i=1}^r \langle h_i^n\rangle },\quad \text{ for all }n\geq 1
\end{align*}
Finally, we may fix large enough $n$ so that  \myref{equation}{eqPoa2} holds true and that we may write $f^m = \sum_{i=1}^r b_ih_i^{n+1}$, for some $m \inn$ and $b_i \in A$. Let $a\triangleq \sum b_ih_i^na_i$. We shall finish the proof by showing $\psi_f(a\quotient f^m)=s$. Fix $j$. We are required to prove $a_j \quotient h_j= a\quotient f^m\in A_{\mathfrak{p}}$  for any $\mathfrak{p}\in D(f)\cap D(h_j)$, which follows from noting: 
\begin{align*}
  h_j^n(a_jf^m -h_ja)= h_j^n\sum_i (a_jb_ih_i^{n+1} - h_jb_ih_i^n a_i)= \sum_{i}b_ih_j^nh_i^n(h_ia_j-h_ja_i)=0 
\end{align*}
where the last equality hold true because of \myref{equation}{eqPoa2}. \\

(iii): This is a special case $f\triangleq 1$ of  (ii). Just recall \customref{Poo}{$D(1)=\operatorname{Spec}A$}. 
\end{proof}
\begin{theorem}
\label{THffsZ}
\textbf{(A functor I don't understand)} Let $(X,\mathcal{O}_X)$ be a scheme, $A$ a ring. Because \customref{THas}{the ring of global sections of an affine scheme is its underlying ring}, we may define a functor $\operatorname{Hom}_{\mathfrak{Sch}}(X,\operatorname{Spec} A) \rightarrow \operatorname{Hom}_{\mathfrak{Ring}}(A, \Gamma (X))$ by: 
\begin{align*}
 \left((f,f^{\sharp}):X\rightarrow \operatorname{Spec}A   \right) \mapsto  f^\sharp (\operatorname{Spec} A): A=\Gamma  (\operatorname{Spec}A)\rightarrow \Gamma (X,\mathcal{O}_X) 
\end{align*}
Such functor is bijective.
\end{theorem}
\begin{proof}

\end{proof}
\begin{theorem}
\label{THsin}
\textbf{(Properties of scheme)} Let $(X,\mathcal{O})$ be a scheme. Then, 
\begin{enumerate}[label=(\roman*)]
  \item Every nonempty irreducible closed subset $Z \subseteq X$ has a unique generic point.  
  \item Given nonempty irreducible closed $Y \subseteq X$ with generic point $\eta$, we have $\operatorname{Cotopdim}(Y,X)=\operatorname{Krudim}(\mathcal{O}_{X,\eta})$.  
  \item For each $P \in X$, the stalk $\mathcal{O}_P$ as a ring is nonzero. 
\end{enumerate}
\end{theorem}
\begin{proof}
(ii): https://stacks.math.columbia.edu/tag/02IZ?utm_source=chatgpt.com 


\end{proof}



Let $S$ be a  $\N$-graded ring. Clearly,  $S_+ \triangleq \bigoplus_{d>0} S_d$ forms an ideal. We define:
\begin{align*}
\operatorname{Proj}S \triangleq \set{\mathfrak{p}\in \operatorname{Spec}S: \mathfrak{p} \supseteq \mathfrak{a} }
\end{align*}
If $\mathfrak{a}\subseteq S$ is homogeneous, then we define $V(\mathfrak{a})\triangleq \set{\mathfrak{p} \in \operatorname{Proj}S: \mathfrak{p}\supseteq \mathfrak{a}}$. 
\begin{theorem}
\label{THtp}
\textbf{(Topology of $\operatorname{Proj}S$)} Let $S$ be a graded ring, and $\set{\mathfrak{a}_i}$ an infinite collection of homogeneous ideals in $S$. We have: 
 \begin{enumerate}[label=(\roman*)]
  \item $V(\mathfrak{a}_1)\cup  V(\mathfrak{a}_2)=V(\mathfrak{a}_1 \mathfrak{a}_2)$. 
  \item $\bigcap V(\mathfrak{a}_i)=V (\sum \mathfrak{a}_i)$
\end{enumerate}
\end{theorem}
\begin{proof}
This is basic algebra. See Hartshorne II.2.4.
\end{proof}
Because of \myref{theorem}{THtp}, we can consider $\operatorname{Proj}S$ as a topological space where closed set take the form $V(\mathfrak{a})$, for some homogeneous ideal  $\mathfrak{a}\subseteq S$. Fix $\mathfrak{p}\in \operatorname{Proj}S$. Let $T\subseteq S$ be the multiplicatively closed subset consisting of all homogeneous elements of $S$ that doesn't lie in $\mathfrak{p}$. We know \customref{Ogoh}{there exists a $\Z$-grading}: 
\begin{align*}
  (T^{-1}S)_d \triangleq \set{ f\quotient g \in T^{-1}S:f\text{ is homogeneous and }\operatorname{deg}f-\operatorname{deg}g=d} \cup \set{0}
\end{align*}
Writing $S_{(\mathfrak{p})}\triangleq (T^{-1}S)_0$, we may define a sheaf of ring on $\operatorname{Proj}S$ by letting $\mathcal{O}(U)$ to be the set of functions $s: U \rightarrow  \bigsqcup_{\mathfrak{p}\in U} S_{(\mathfrak{p})} $ such that: 
\begin{enumerate}[label=(\roman*)]
  \item $s(\mathfrak{p}) \in S_{(\mathfrak{p})}$ for all $\mathfrak{p}\in U$.  
  \item For each $\mathfrak{p}\in U$, there exists neighborhood $V$ of $\mathfrak{p}$  contained by $U$ and homogeneous  $a,f \in S$ of same degree such that for all $\mathfrak{q}\in V$ we have $f \not\in \mathfrak{q}$ and have  $s(\mathfrak{q})= a\quotient f \in S_{(\mathfrak{q})}$.  
\end{enumerate}
Let $f\in S_+$. In the remaining part of this section, we shall denote 
\begin{align*}
D_+(f)\triangleq \set{\mathfrak{p}\in \operatorname{Proj}S: f \not \in \mathfrak{p}}
\end{align*}
\begin{theorem}
\textbf{(Structure sheaf of $\operatorname{Proj}S$)} Let $S$ be a $\N$-graded ring and $\mathcal{O}$ be the ring-valued sheaf on $\operatorname{Proj}S$ defined above.  Then: 
\begin{enumerate}[label=(\roman*)]
  \item $(\operatorname{Proj}S,\mathcal{O})$ forms a locally ringed space.  
  \item For all $\mathfrak{p}\in \operatorname{Proj}S$, we have ring isomorphism  $\mathcal{O}_{\mathfrak{p}}\cong  S_{(\mathfrak{p})}$.  
  \item $\set{D_+(f) \subseteq \operatorname{Proj}S: f \in S\text{ is homogeneous and }\operatorname{deg}f>0}$ forms an open cover of $\operatorname{Proj}S$. 
  \item For each $f\in S_+$, we have a locally ringed space isomorphism $(D_+(f), \mathcal{O}|_{D_+(f)} ) \cong  \customref{Ogoh2}{\operatorname{Spec} S_{(f)}}$  
  \item $\operatorname{Proj}S$ forms a scheme. 
\end{enumerate}
\end{theorem}
\begin{proof}
Hartshorne II.2.5
\end{proof}
Let $A$ be a ring. The  \textbf{abstract projective $n$-space over $A$} is $\operatorname{Proj}A[x_0,\dots ,x_n]$. 
\begin{theorem}
\textbf{(Natural homeomorphism from abstract projective $n$-space to projective $n$-space when the ground field is algebraically closed)} Let $k$ be an algebraically closed field. The space of closed point of $\operatorname{Proj}k[x_0,\dots ,x_n]$ is homeomorphic to $\P^n_k$. 
\end{theorem}
\begin{proof}

\end{proof}
A scheme $(X,\mathcal{O})$ is \textbf{locally Noetherian} if it can be covered by open affine subsets  $\operatorname{Spec}A_i$, where each $A_i$ is a Noetherian ring. A scheme is \textbf{Noetherian} if it is locally Noetherian and compact. A scheme $(X,\mathcal{O})$ is \textbf{reduced} if for each $U \subseteq X$, the ring $\mathcal{O}(U)$ has no nilpotent element. A scheme is \textbf{integral} if for all $U \subseteq X$, the ring $\mathcal{O}(U)$ is an integral domain. A scheme is \textbf{normal} its every local ring is an integrally closed domain.  


\begin{equiv_def}
\textbf{(Locally Noetherian scheme)} Let $(X,\mathcal{O})$ be a scheme. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)] 
  \item $X$ is locally Noetherian. 
  \item For each affine open $\operatorname{Spec}A=U \subseteq X$,    \customref{THas}{$A=\Gamma (U)$} is Noetherian.  
\end{enumerate}
\end{equiv_def}
\begin{theorem}
\textbf{(Properties of locally Noetherian scheme)} Let $(X,\mathcal{O})$ be a locally Noetherian scheme. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathcal{O}_x$ is Noetherian for all $x\in X$. 
\end{enumerate}
\end{theorem}
\begin{proof}
  (i): Recall that 
\end{proof}
\begin{theorem}
\textbf{(Properties of Noetherian scheme)} Let $(X,\mathcal{O})$ be a Noetherian scheme. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $X$ is Noetherian as a topological space. 
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}
\begin{equiv_def}
\textbf{(Reduced schemes)} Let $(X,\mathcal{O})$ be a scheme. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $X$ is reduced. 
  \item For all $P \in X$, $\mathcal{O}_P$ has no nilpotent elements. 
\end{enumerate}
\end{equiv_def}
\begin{proof}

\end{proof}
\begin{equiv_def}
\label{EDIs}
\textbf{(Integral schemes)} Let $(X,\mathcal{O})$ be a scheme. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $X$ is integral.  
  \item For each $P \in X$, the stalk $X_P$ is an integral domain.  
  \item $X$ is both reduced and irreducible.
\end{enumerate}
\end{equiv_def}
\begin{proof}

\end{proof}
\begin{theorem}
\label{THff}
\textbf{(Function field is the quotient filed of local ring at generic point of open affine subset)} Let $X$ be an integral scheme, \customref{THsin}{$\eta$ be the unique generic point of $X$}, and $U\triangleq  \operatorname{Spec}A\subseteq X$ an affine open subset of $X$. Then:
\begin{enumerate}[label=(\roman*)]
    \item $\mathcal{O}_{X,\eta }$ forms a field, called \textbf{the function field $K(X)$ of the integral scheme $X$}. 
    \item $K(X)\cong \operatorname{Frac}(A)\cong  \operatorname{Frac}(\Gamma (\mathcal{O}_U))$ as rings. 
  \end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}
A \textbf{closed immersion} $(f,f^{\sharp}):Y\rightarrow X$ is a scheme morphism such that: 
\begin{enumerate}[label=(\roman*)]
  \item $f$ is a homeomorphism from $Y$ to some closed subset of $X$.  
  \item $f^{\sharp}:\mathcal{O}_X \rightarrow  f_* \mathcal{O}_Y$ is surjective.  
\end{enumerate}
A \textbf{closed subscheme} of $X$ is an equivalence class of closed immersions, where we say  $f:Y\rightarrow X$ and $f':Y'\rightarrow X$ are equivalent if there is a scheme isomorphism $i:Y \rightarrow Y'$ that makes the diagram:
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJZIl0sWzIsMCwiWCJdLFswLDIsIlknIl0sWzAsMSwiZiJdLFsyLDEsImYnIiwyXSxbMCwyLCJpIiwyXV0=
\[\begin{tikzcd}
	Y && X \\
	\\
	{Y'}
	\arrow["f", from=1-1, to=1-3]
	\arrow["i"', from=1-1, to=3-1]
	\arrow["{f'}"', from=3-1, to=1-3]
\end{tikzcd}\]
commutes. Note that from our definition, we can always treat the underlying topological space of closed subscheme $Y$ of  $X$ as a subset of  $X$, even though the structure sheaf may not be the restriction of that of  $X$.
\section{$\mathcal{O}_X$-modules}

Given a ringed space $(X,\mathcal{O}_X)$, if we say a sheaf $\mathcal{F}$ of abelian groups on $X$ is a $\mathcal{O}_X$\textbf{-module}, we are assigning each abelian group $\mathcal{F}(U)$ a $\mathcal{O}_X(U)$-module structure compatible not only with the addition of $\mathcal{F}(U)$ but also the restriction maps in the sense that: 
\begin{align*}
  (fs)|_V= (f|_V)(s|_V),\quad \text{ for each }f\in \mathcal{O}_X(U),s \in \mathcal{F}(U)\text{ and }V \subseteq U
\end{align*}
An \textbf{$\mathcal{O}_X$-module morphism} is then just a sheaf morphism such that all $\mathcal{F}(U) \rightarrow \mathcal{G}(U)$ are also $\mathcal{O}_X(U)$-module homomorphisms. An  $\mathcal{O}_X$-module $\mathcal{F}$ is \textbf{free of rank $\operatorname{card}(I)$} if it is a direct sum $\bigoplus_{I}\mathcal{O}_X$.  An $\mathcal{O}_X$-module $\mathcal{F} $ is \textbf{locally free} if there exists open cover $U_\alpha $ of $X$ on which all the restriction are free $\mathcal{O}_{U_\alpha}$-module. An $\mathcal{O}_X$-module $\mathcal{F} $ is \textbf{locally free of rank} $\operatorname{card}(I)$, if there exists open cover $U_\alpha$ of $X$ on which all the restriction are free $\mathcal{O}_{U_\alpha }$-module of rank $\operatorname{card}(I)$. Let $(X,\mathcal{O}_X)$ be a locally ringed space, an $\mathcal{O}_X$-module $\mathcal{F}$ is said to be \textbf{invertible} if it is locally free of rank $1$. 
\section{Schemes over $S$}
Let $S$ be a fixed scheme. A  \textbf{scheme over} $S$ is a scheme $X$ together with a scheme morphism  $X \rightarrow S$. Let $j_X\rightarrow S,j_Y:Y \rightarrow S$ be two scheme over $S$. A $S$\textbf{-scheme morphism} from $X$ to $Y$ is a scheme morphism  $f:X\rightarrow Y$ that makes the diagram: 
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJYIl0sWzIsMCwiWSJdLFsxLDIsIlMiXSxbMCwyLCJqX1giLDJdLFsxLDIsImpfWSJdLFswLDEsImYiXV0=
\[\begin{tikzcd}
	X && Y \\
	\\
	& S
	\arrow["f", from=1-1, to=1-3]
	\arrow["{j_X}"', from=1-1, to=3-2]
	\arrow["{j_Y}", from=1-3, to=3-2]
\end{tikzcd}\]
commute. Let $A$ be a fixed ring. A \textbf{scheme over} $A$ is a scheme over  $\operatorname{Spec}A$. Let $X,Y$ be two schemes over  $S$. Their \textbf{fiber product} $X \times_S Y$ is a scheme together with two scheme morphism $p_1:X \times_S Y \rightarrow X$ and $p_2: X \times_S Y \rightarrow Y$, called \textbf{projection morphisms}, that 
\begin{enumerate}[label=(\roman*)]
  \item makes the diagram: 
% https://q.uiver.app/#q=WzAsNCxbMCwxLCJYIl0sWzQsMSwiWSJdLFsyLDIsIlMiXSxbMiwwLCJYXFx0aW1lcyBfUyBZIl0sWzAsMiwial9YIiwxXSxbMSwyLCJqX1kiLDFdLFszLDAsInBfMSIsMV0sWzMsMSwicF8yIiwxXV0=
\[\begin{tikzcd}
	&& {X\times _S Y} \\
	X &&&& Y \\
	&& S
	\arrow["{p_1}"{description}, from=1-3, to=2-1]
	\arrow["{p_2}"{description}, from=1-3, to=2-5]
	\arrow["{j_X}"{description}, from=2-1, to=3-3]
	\arrow["{j_Y}"{description}, from=2-5, to=3-3]
\end{tikzcd}\]
  commute. 
\item satisfies \textbf{the universal property for fiber product of scheme}: For each tuple $(Z,f,g)$, where $Z$ is a scheme over $S$ and  $f:Z\rightarrow X,g:Z\rightarrow Y$ are two $S$-scheme morphism, there exists a unique scheme morphism $\theta : Z\rightarrow X \times_S Y$ that makes the diagram: 
% https://q.uiver.app/#q=WzAsNSxbMCw0LCJYIl0sWzQsNCwiWSJdLFsyLDUsIlMiXSxbMiwwLCJaIl0sWzIsMywiWFxcdGltZXMgX1MgWSJdLFswLDJdLFsxLDJdLFszLDEsImciXSxbMywwLCJmIiwyXSxbMyw0LCJcXHRoZXRhIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV0sWzQsMCwicF8xIiwxXSxbNCwxLCJwXzIiLDFdXQ==
\[\begin{tikzcd}
	&& Z \\
	\\
	\\
	&& {X\times _S Y} \\
	X &&&& Y \\
	&& S
	\arrow["\theta"{description}, dotted, from=1-3, to=4-3]
	\arrow["f"', from=1-3, to=5-1]
	\arrow["g", from=1-3, to=5-5]
	\arrow["{p_1}"{description}, from=4-3, to=5-1]
	\arrow["{p_2}"{description}, from=4-3, to=5-5]
	\arrow["j_X"{description},from=5-1, to=6-3]
	\arrow["j_Y"{description},from=5-5, to=6-3]
\end{tikzcd}\]
commute.  
\end{enumerate}
Because of (i), treating $X \times _S Y$ as a $S$-scheme via either $j_Y \circ p_2$ or $j_X \circ p_1$ are the same. 
\begin{theorem}
\textbf{(Existence of fiber product of scheme)} Let $S$ be a scheme, and let $X,Y$ be two scheme over $S$.  The fiber product $X \times_S Y$ exists.
\end{theorem}
\begin{proof}

\end{proof}
Let $f:X\rightarrow Y$ be a scheme morphism. The \textbf{diagonal morphism}  is the unique morphism $\Delta: X \rightarrow X \times _Y X$  whose composition with both projection morphisms is the identity map $X \rightarrow X$. 
\begin{theorem}
\textbf{(Properties of diagonal scheme morphism)} Let $f:X\rightarrow Y$ be a scheme morphism. Let $\Delta : X\rightarrow X\times_Y X$ be the diagonal morphism. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $\Delta (X)$ is the image of a closed subscheme $g: Z\rightarrow X\times_Y X$.  
  \item $g^{-1}\circ \Delta : X \rightarrow Z$ is a scheme isomorphism?    
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}

We say $f$ is \textbf{separated} if $\Delta : X\rightarrow  X \times_Y X$ is a closed immersion.\footnote{Recall that given a topological space  $H$, it is Hausdorff if and only if its diagonal $\set{(x,x) \in H\times H: x \in H}$ is closed in $H\times H$.} Because we have a \customref{THffsZ}{bijective functor $\operatorname{Hom}_{\mathfrak{Sch}}(X, \operatorname{Spec}\Z)\longleftrightarrow  \operatorname{Hom}_{\mathfrak{Ring}}(\Z, \Gamma (X)  )$} and there exists only one ring morphism $\Z \rightarrow \Gamma (X)$, every scheme can be uniquely identified as a scheme over $\Z$. We say a scheme $X$ is  \textbf{separated} if it is separated as a scheme over $\Z$. \\

A scheme morphism $f:X\rightarrow Y$ is \textbf{locally of finite type} if there exists:
\begin{enumerate}[label=(\roman*)]
  \item An open affine cover $V_i = \operatorname{Spec}B_i$ of $Y$. 
  \item For each $i$ a collection  $\set{\operatorname{Spec}A_{ij}}$ of open affine subset of $X$. 
\end{enumerate}
such that  $A_{ij}$ are all finitely generated $B_i$-algebras, and for each $i$, $f^{-1}(V_i)$ is covered by $\operatorname{Spec}A_{ij}$. The scheme morphism $f:X\rightarrow Y$ is of \textbf{finite type} if in addition for each $i$, the cover  $\set{\operatorname{Spec}A_{ij}}$ of $f^{-1}(V_i)$ can be finite.  \\

We say a scheme morphism $f:X\rightarrow Y$ is \textbf{universally closed} if topologically it is a closed map, and for any scheme morphism $Y'\rightarrow Y$ the projection map $X\times_Y Y' \rightarrow Y'$ is also topologically a closed map.   A scheme is \textbf{proper} if it is of finite type, separated, and universally closed .  \\




 


An \textbf{abstract variety} is an integral separated scheme  of finite type over some algebraically closed field  $k$. An abstract variety is \textbf{complete} if it is proper over  $k$. Note that because the only open affine subset of $\operatorname{Spec}k$ is itself, an abstract variety can be covered by $\operatorname{Spec}A_{i}$ where each $A_i$ are all finitely generated  $k$-algebra. In other words, an abstract variety \customref{cpoN}{must be Noetherian}. Because of such, given an abstract variety $(X,\mathcal{O}_X)$, we may talk about whether $x \in X$ is a \textbf{singularity} of $X$, i.e., whether  $\mathcal{O}_{X,x}$ is regular. We say abstract variety $X$ is  \textbf{nonsingular} if it contains no singularity. \label{PAavns} \\

Let $Y$ be a scheme. The \textbf{projective $n$-space $\P^n_Y$ over $Y$}  is defined as $\operatorname{Proj}\Z[x_0,\dots ,x_n]\times_{\Z} Y$. A scheme morphism $f:X\rightarrow Y$ is \textbf{projective} if for some $n$, there exists a closed immersion $i:X\rightarrow \P^n_Y$ such that the diagram:
% https://q.uiver.app/#q=WzAsMyxbMCwwXSxbMiwwLCJcXGJ1bGxldCJdLFsyLDIsIlxcYnVsbGV0Il0sWzAsMSwiaSJdLFswLDIsImYiLDJdLFsxLDIsIlxcdGV4dHtwcm9qZWN0aW9ufSJdXQ==
\[\begin{tikzcd}
	X && \P^n_Y  \\
	\\
	&& Y
	\arrow["i", from=1-1, to=1-3]
	\arrow["f"', from=1-1, to=3-3]
	\arrow["{\text{projection}}", from=1-3, to=3-3]
\end{tikzcd}\]
commute. 
\begin{theorem}
\textbf{(Projective morphisms are proper for Noetherian schemes)} Let $X,Y$ be two Noetherian schemes.  If the scheme morphism $f:X\rightarrow Y$ is projective, then it is proper.
\end{theorem}
\begin{proof}
Hartshorne II.4.9.
\end{proof}
\begin{equiv_def}
\label{EDcfnc}
\textbf{(Completeness for nonsingular curves)} Let $X$ be a nonsingular over $k$ with function field $K$. The followings are equivalent: 
 \begin{enumerate}[label=(\roman*)]
  \item $X$ is projective. 
  \item $X$ is complete. 
\end{enumerate}
\end{equiv_def}
\begin{proof}
Hartshorne II.6.7.
\end{proof}


\begin{theorem}
\textbf{(Translation between language of varieties and schemes for algebraically closed ground field)} Let $k$ be an algebraically closed field. There is a natural fully faithful functor $t$ from the category of varieties over  $k$ to schemes over  $k$. Let $V$ be a variety, $\mathcal{O}$ the sheaf of regular functions on $V$, $\mathcal{O}'$ the structure sheaf of $t(V)$. We have :
\begin{enumerate}[label=(\roman*)]
  \item $V$ is homeomorphic to the set of closed point  of $t(V)$. 
  \item  $(V,\mathcal{O})$ and $(V,\mathcal{O}'|_V)$ are isomorphic as scheme. 
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}
\section{Birational equivalence}


\begin{theorem}
\textbf{(Equivalence for scheme morphisms on open dense subset)}  Let $X,Y$ be schemes, $f:U \rightarrow Y,g:V \rightarrow Y$ be scheme morphisms defined on open dense subset $U,V\subseteq X$. The relation: 
\begin{align*}
f \cong g \overset{\triangle}{\iff }\text{ There exists open dense $W \subseteq U\cap V$ such that }f(x)=g(x)\text{ for all }x \in W. 
\end{align*}
forms an equivalence relation. 
\end{theorem}
A \textbf{rational scheme morphism} is an equivalence class of scheme morphism on open dense subsets. Let $X,Y$ be  $S$-schemes. A  \textbf{rational $S$-scheme morphism} is a rational scheme morphism that contains a $S$-scheme morphism.  \\

Let schemes $X,Y$ have finitely many irreducible components. We say a scheme morphism $f: X\rightarrow Y$ is a \textbf{birational scheme morphism} if 
\begin{enumerate}[label=(\roman*)]
  \item $f$ forms a bijection between the set of generic points of irreducible components of $X$ and the set of generic points of irreducible components of $Y$. 
  \item For every generic point $\eta \in X$ of an irreducible component of $X$, the induced local ring homomorphism $f^{\sharp}_{\eta}:\mathcal{O}_{Y,f(\eta )} \rightarrow \mathcal{O}_{X,\eta } $ is a ring isomorphism. 
\end{enumerate}







\section{$\mathcal{O}$-modules for schemes}
Given a ringed space $(X,\mathcal{O}_X)$, if we say a sheaf $\mathcal{F}$ of abelian groups on $X$ is a $\mathcal{O}$\textbf{-module}, we are assigning each abelian group $\mathcal{F}(U)$ a $\mathcal{O}(U)$-module structure compatible not only with the addition of $\mathcal{F}(U)$ but also the restriction maps in the sense that: 
\begin{align*}
  (fs)|_V= (f|_V)(s|_V),\quad \text{ for each }f\in \mathcal{O}(U),s \in \mathcal{F}(U)\text{ and }V \subseteq U
\end{align*}
An \textbf{$\mathcal{O}_X$-module morphism} is then just a sheaf morphism such that all $\mathcal{F}(U) \rightarrow \mathcal{G}(U)$ are also $\mathcal{O}(U)$-module homomorphisms. An  $\mathcal{O}_X$-module $\mathcal{F}$ is \textbf{free of rank $\operatorname{card}(I)$} if it is a direct sum $\bigoplus_{I}\mathcal{O}_X$.  An $\mathcal{O}_X$-module $\mathcal{F} $ is \textbf{locally free} if there exists open cover $U_\alpha $ of $X$ on which all the restriction are free $\mathcal{O}_{U_\alpha}$-module. An $\mathcal{O}_X$-module $\mathcal{F} $ is \textbf{locally free of rank} $\operatorname{card}(I)$, if there exists open cover $U_\alpha$ of $X$ on which all the restriction are free $\mathcal{O}_{U_\alpha }$-module of rank $\operatorname{card}(I)$. Let $(X,\mathcal{O}_X)$ be a locally ringed space, an $\mathcal{O}_X$-module $\mathcal{F}$ is said to be \textbf{invertible} if it is locally free of rank $1$. 
\begin{theorem}
\textbf{(Natural module structure for local rings of $\mathcal{O}_X$-module)} Let $X$ be a scheme, and  $\mathcal{F}$ an $\mathcal{O}_X$-module. For each $x\in X$, $\mathcal{F}_x$ is naturally an $\mathcal{O}_X$-module. 
\end{theorem}
\begin{proof}

\end{proof}
An $\mathcal{O}_X$\textbf{-module of ideal} $\mathcal{I}$ is an $\mathcal{O}_X$-module such that $\mathcal{I}(U)$ are all ideals of $\mathcal{O}_X(U)$. \\

Let $X$ be an abstract variety over $k$, given by scheme morphism  $f:X\rightarrow \operatorname{Spec}k$. Because $\operatorname{Spec}k$ has only one point, we know $(f_*\mathcal{O}_X)(\operatorname{Spec}k)=\Gamma  (X,\mathcal{O}_X)$. This together with \customref{THas}{property of affine scheme} allow us to write: 
\begin{align*}
f^{\sharp}_{\operatorname{Spec}k}:k = \Gamma (\operatorname{Spec}k,\mathcal{O}_{\operatorname{Spec}k} )\rightarrow (f_*\mathcal{O}_X )(\operatorname{Spec}k)= \Gamma (X,\mathcal{O}_X)
\end{align*}
which allow us to consider for any $\mathcal{O}_X$-module $\mathcal{F}$, the global section modules $\Gamma  (X,\mathcal{F})$ a $k$-vector space. \\

Let $A$ be a ring and $M$ an  $A$-module. We define a \textbf{sheaf $\tilde{M}$ on $\operatorname{Spec}A$ associated to $M$} by making $\tilde{M}(U)$ the set of functions $s: U \rightarrow \bigsqcup_{\mathfrak{p}\in U}M_{\mathfrak{p}}$ that satisfies:
\begin{enumerate}[label=(\roman*)]
  \item $s(\mathfrak{p}) \in M_{\mathfrak{p}}$. 
  \item There exists an open cover $\bigcup V_\alpha =U$ such that for all $\alpha $, there exists some $m_\alpha  \in M$ and $f_\alpha  \in A$ that make all $\mathfrak{p} \in V_\alpha $ satisfies $s(\mathfrak{p})= m_\alpha \quotient f_\alpha \in M_\mathfrak{p}$. 
\end{enumerate}
Let $(X,\mathcal{O}_X)$ be a scheme. We say an $\mathcal{O}_X$-module $\mathcal{F}$ is \textbf{quasi coherent} if there exists an open affine cover $X= \bigcup \operatorname{Spec}A_\alpha $ together for each $\alpha $ an $A_\alpha $-module $M_\alpha $ that makes $\mathcal{F}|_{\alpha }\cong  \tilde{M}_\alpha  $ as $\mathcal{O}_X |_{\operatorname{Spec}A_{\alpha}}$-module. We say $\mathcal{F}$ is \textbf{coherent} if further more each $M_\alpha $ can be taken to be a finitely generated $A_\alpha $-module. \\

Let $X$ be a scheme and $\mathcal{F}$ an $\mathcal{O}_X$-module. We say $\mathcal{F}$ is \textbf{generated by its global sections} if for each $x\in X$, the map $\rho_X:\Gamma (X,\mathcal{F} )\otimes_{\Gamma (X,\mathcal{O}_X )} \mathcal{O}_{X,x} \rightarrow \mathcal{F}_x$ defined by $s\otimes  a \mapsto  a\cdot s_x$ is surjective. \\ 

Let $X$ be a Noetherian scheme. We say invertible $\mathcal{O}_X$-module $\mathcal{L}$ is \textbf{ample} if for every coherent $\mathcal{O}_X$-module $\mathcal{F}$, there is an integer $n_0>0$ such that for every  $n\geq n_0$, $\mathcal{F}\otimes \mathcal{L}^{\otimes  n}  $ is generated by its global sections. 
\section{Weil divisors}
We say a scheme $X$ is \textbf{nonsingular in codimension one} if every local ring $\mathcal{O}_x$ of Krull dimension one is regular. A \textbf{Hartshorne scheme} is a Noetherian integral separated scheme nonsingular in codimension one. Note that \customref{PAavns}{an nonsingular abstract variety must be Hartshorne}. Let $X$ be Hartshorne. A \textbf{prime divisor} on $X$ is a integral closed subscheme  $Y$ of codimension one. Because \customref{EDIs}{integral scheme by definition is irreducible}, we know for each prime divisor $Y$, \customref{THsin}{there exists a unique generic point $\eta \in Y$}. Because such generic point is unique and homeomorphism clearly preserve generic point, we may identify $\eta  \in X$ without ambiguity.
\begin{theorem}
\textbf{(Local rings of Noetherian integral separated scheme nonsingular in codimension one at generic points of integral closed subschemes are DVRs)}  Let $X$ be a Hartshorne scheme, $Y$ a prime divisor $X$, and  $\eta \in Y$ the generic point. Then, $\mathcal{O}_{X,\eta }$ is a DVR. 
\end{theorem}
\begin{proof}
Recall that \customref{ECoDp1}{by definition a DVR is just a Noetherian regular local domain of Krull dimension $1$}. We only have to prove: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathcal{O}_{X,\eta}$ is Noetherian. 
  \item $\mathcal{O}_{X,\eta }$ is an integral domain.
  \item $\operatorname{Krudim}(\mathcal{O}_{X,\eta })=1$. 
  \item $\mathcal{O}_{X,\eta}$ is regular. 
\end{enumerate}
Before such, we first make the following settings: Because $X$ is Noetherian, there exists some affine open $x \in U \cong  \operatorname{Spec}A$, where $A$ is Noetherian and $\mathfrak{p} \in \operatorname{Spec}A$ correspond to $x \in U$.\\


(i): Because \customref{THshe}{stalks are intact under restriction}, by \customref{THas}{property of affine scheme}, we know:
\begin{align*}
\mathcal{O}_{X,\eta}= \mathcal{O}_{U,\eta}= A_\mathfrak{p},\quad \text{ for some }\mathfrak{p} \in \operatorname{Spec}A
\end{align*}
The rest of the proof then follows from the fact that \customref{cpoN}{localization preserves Noetherian}. \\

(ii): This is by \customref{EDIs}{equivalent definitions of integral scheme}. \\

(iii): By \customref{EDIs}{equivalent definition of integral scheme} and equivalent definition of closed immersion, we know $Y\cap U$ is an irreducible closed subset of  $U$. Let $V(\mathfrak{q})\triangleq Y \cap U \subseteq \operatorname{Spec}A$.  Because \customref{THcdim}{codimension is local}, by \customref{THsin}{property of scheme}, we know:
\begin{align*}
1=\operatorname{Cotopdim}(Y,X)= \operatorname{Cotopdim}(Y\cap U,U)= \operatorname{Krudim}(\mathcal{O}_{\operatorname{Spec}A,\mathfrak{p}})= \operatorname{Krudim}(\mathcal{O}_{X,\eta } )
\end{align*}
(iv): This follows (iii) and the premise that $X$ is nonsingular in codimension $1$. 
\end{proof}
Let $X$ be Hartshorne with \customref{THsin}{unique generic point} $\xi$, $Y$ an arbitrary prime divisor of $X$, and $\eta $ the unique generic point of $Y$. Let $\operatorname{Spec}A$ be an open affine neighborhood of $\eta$. Because $\xi$ is generic, we know $\xi \in \operatorname{Spec}A$. Let $\mathfrak{p},\mathfrak{q}\in \operatorname{Spec}A$ correspond to $\xi,\eta$. Because \customref{THff}{$\mathcal{O}_{\xi}$ is a field (the function field $K(X)$ of $X$)}, by \customref{THas}{property of affine scheme}, we know: 
\begin{align*}
\operatorname{Frac}(\mathcal{O}_{\eta } )=\customref{THlid}{\operatorname{Frac}(A_{\mathfrak{q}})=\operatorname{Frac}(A_{\mathfrak{p}})}=\operatorname{Frac}(\mathcal{O}_{\xi})=\mathcal{O}_{\xi}
\end{align*}
In other word, for any integral closed subscheme $Y$ and their generic point  $\eta$, the DVRs $\mathcal{O}_{\eta }$ all value the same field $\mathcal{O}_{\xi}$. For each $Y$ and $\eta$, let $\nu _Y: \mathcal{O}_\eta ^\times \rightarrow \Z $ be the smallest valuation. We now have:
\begin{theorem}
\label{THPW}
\textbf{(Principal Weil divisors are well-defined)} Let $X$ be a Hartshorne scheme. For each $f \in K(X)^{\times}$, there only exists finite number of integral closed subscheme $Y$ such that $\nu _Y(f)\neq 0$.  
\end{theorem}
\begin{proof}

\end{proof}
Let $X$ be a Hartshorne scheme. A \textbf{Weil divisor} of $X$ is a finite formal sum of prime divisors of $X$. The group of Weil divisor is denoted by $\operatorname{Div}X$. Because of \myref{Theorem}{THPW}, when we define \textbf{principal divisor $(f)$ generated by} $f\in K(X)^{\times}$ by 
\begin{align*}
  (f) \triangleq \sum_{\text{ prime divisor }Y} \nu _Y(f) \cdot Y
\end{align*}
we know $(f) $ is a Weil divisor. We say a Weil divisor is \textbf{effective} if its every coefficient is nonnegative. The \textbf{degree} of a Weil divisor is just the sum of the coefficients. We say two Weil divisors $D,D'$ are \textbf{linearly equivalent} if $D-D'$ is principal. The \textbf{Weil divisor class group} $\operatorname{Cl}X$ is then just the quotient group of $\operatorname{Div}X$ under linear equivalence.  Given a Weil divisor $c_1P_1 + \cdots +c_n P_n \in \operatorname{Div}X$, where $c_1,\dots, c_n$ are nonzero, its \textbf{support} $\operatorname{Supp}(c_1P_1+ \cdots + c_nP_n)$ is defined by $\bigcap P_i$. 




\section{Cartier divisors}
Let $(X,\mathcal{O})$ be  a scheme. For each open $U \subseteq X$, denote: 
\begin{align}
\label{EQSU}
S(U)\triangleq \set{s \in \mathcal{O}(U):\text{For all }P \in U, s_P \in \mathcal{O}_P\text{ is a non-zero-divisor.}  }
\end{align}
Because $S(U)$ is clearly a  multiplicatively closed subset of $\mathcal{O}(U)$, we have a localization  $\mathcal{K}^-(U)\triangleq S^{-1}(U)\mathcal{O}(U)$. 
\begin{theorem}
\textbf{(The image of every unit of $\mathcal{O}(U)$ in every stalk is a non-zero-divisor)} Let $(X,\mathcal{O})$ be a scheme, $U \subseteq X$, $j:\mathcal{O}(U) \rightarrow \mathcal{K}^{-}(U)  $ be the canonical ring homomorphism, and $\mathcal{O}^\times(U)\subseteq \mathcal{O}(U)$ the set of units. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $\mathcal{O}^\times(U) \subseteq S(U) $. 
  \item  $j |_{\mathcal{O}^\times(U)}:\mathcal{O}^\times(U)\rightarrow \mathcal{K}^-(U)$ is injective. 
\end{enumerate}
\end{theorem}
\begin{proof}
  (i) follows from the fact \customref{THrh}{ring homomorphism respects units}, the fact \customref{THunz}{units are non-zero-divisors in nonzero rings}, and the fact that \customref{THsin}{every stalk of a scheme as a ring is nonzero}. \\

  (ii): Let $a,b \in \mathcal{O}^*(U)$ satisfy $a\quotient 1=b\quotient 1 \in \mathcal{K}^- (U)$. Let $s \in S(U)$ satisfies $s(a-b)=0$. We then have $s_P(a-b)_P=0$ for all $P \in U$, which by definition of $S(U)$ implies $(a-b)_P=0$ for all $P \in U$. This by the \customref{THgpos}{the relationship between sheaf and its stalk} implies  $a-b =0 \in \mathcal{O}(U) $, as desired. 
\end{proof}

Let $V \subseteq U$, $j_V:\mathcal{O}(V)\hookrightarrow  \mathcal{K}^-(V)$ be the canonical ring homomorphism, and $\operatorname{Res}_{\mathcal{O}}$  the restriction map from $\mathcal{O}(U)$ to $\mathcal{O}(V)$, because $j_V\circ \operatorname{Res}_{\mathcal{O}}:\mathcal{O}(U)\rightarrow \mathcal{K}^-(V)$ clearly send each element of  $S(U)$ to a unit in $\mathcal{K}^-(V)$, we may induce unique ring homomorphism  $\operatorname{Res}_{\mathcal{K}^-}: \mathcal{K}^-(U)\rightarrow \mathcal{K}^-(V)$ via universal property of localization:  
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGJ1bGxldCJdLFszLDAsIlxcYnVsbGV0Il0sWzAsMywiXFxidWxsZXQiXSxbMywzLCJcXGJ1bGxldCJdLFswLDJdLFswLDFdLFsxLDNdLFsyLDNdXQ==
\[\begin{tikzcd}
	\mathcal{O}(U)  &&& \mathcal{K}^-(U)  \\
	\\
	\\
	\mathcal{O}(V)  &&& \mathcal{K}^-(V) 
	\arrow["j_U",hook,from=1-1, to=1-4]
	\arrow["\operatorname{Res}_{\mathcal{O}}",from=1-1, to=4-1]
	\arrow["\operatorname{Res}_{\mathcal{K} }\triangleq \tilde{j_V \circ \operatorname{Res}_{\mathcal{O}}} ",dotted,from=1-4, to=4-4]
	\arrow["j_V", hook,from=4-1, to=4-4]
\end{tikzcd}\]
Chasing the diagrams, clearly our assignment $U \mapsto \mathcal{K}^-(U)$ forms a ring-valued presheaf on $X$. The \textbf{$\mathcal{O}_X$-module $\mathcal{K}$ of total ring of fraction} on $X$ is the sheafification of  $\mathcal{K}^-$. Now, because \customref{THshe}{injectivity of sheaf morphism can be translated to stalk and sheafification on stalk is isomorphism}, we have:  
\begin{align*}
\mathcal{O}_P^{\times} \hookrightarrow \mathcal{K}^{-}_P \hookrightarrow \mathcal{K}_P  
\end{align*}
Then because  \customref{THshe}{injectivity of induced morphism on stalks can be translated back to the whole sheaf morphism}, we have 
\begin{align*}
\mathcal{O}^{\times}(U) \hookrightarrow \mathcal{K}^{\times}(U)
\end{align*}
We may now define a \textbf{Cartier divisor} on $X$ to be a global section of the sheaf $\mathcal{K}^\times\quotient \mathcal{O}^\times$. Note that given an open cover $V_i$ of  $X$ with $f_i \in \mathcal{K}^{\times}(V_i)$ that satisfies $f_i \quotient f_j \in \mathcal{O}(V_i \cap V_j)$, we can uniquely identify it as a Cartier divisor. Note that the sheaf $\mathcal{K}$ of total ring of fraction is clearly an $\mathcal{O}_X$-module under extension of scalar. Let $(V_i,f_i \in \mathcal{K}^{\times}(V_i) )$ represent a Cartier divisor $D$. Its \textbf{associated} $\mathcal{O}_X$-module $\mathcal{L}(D)$ is a sub-$\mathcal{O}_X$-module of $\mathcal{K}$ defined by
\begin{align*}
\Gamma (U,\mathcal{L}(D))\triangleq \set{ s \in \mathcal{K}(U):\text{For all }i,s |_{V_i \cap U} = g(f_i^{-1}|_{V_i \cap U})\text{ for some }g \in \mathcal{K}(V_i \cap U)} 
\end{align*}
\begin{theorem}
\label{THoCiK}
\textbf{(One-to-one correspondence between Cartier divisors and invertible sub $\mathcal{O}_X$-module of $\mathcal{K}$)} Let $X$ be a  scheme. Then: 
\begin{enumerate}[label=(\roman*)]
  \item The map $D\mapsto  \mathcal{L}(D)$ forms a one-to-one correspondence between the set of Cartier divisor and the set of invertible sub-$\mathcal{O}_X$-modules of $\mathcal{K}$.   
  \item If $X$ is integral, then every invertible  $\mathcal{O}_X$-module is $\mathcal{O}_X$-module isomorphic to some sub-$\mathcal{O}_X$-module of $\mathcal{K}$.   
\end{enumerate}
\end{theorem}
\begin{proof}
Hartshorne II.6.13 and Hartshorne II.6.15. 
\end{proof}
A \textbf{locally factorial} scheme is a scheme whose locals rings are all UFDs. Clearly, \customref{THrlrU}{a nonsingular abstract variety is locally factorial}.
\begin{theorem}
\label{THgib}
  \textbf{(Group isomorphism between group of Weil divisors and group of Cartier divisor for locally factorial integral separated Noetherian scheme)} Let $X$ be an integral separated Noetherian locally factorial scheme. Because \customref{THrlrU}{one-Krull-dimensional local UFD are regular}, we know $X$ is Hartshorne, and thus we can talk about the Weil divisor group $\operatorname{Div}X$. Then, there exist a group isomorphism between $\operatorname{Div}X$ and $\Gamma  (X,\mathcal{K}^\times \quotient \mathcal{O}^{\times} )$. 
\end{theorem}
\begin{proof}
Hartshorne II.6.11. 
\end{proof}
Note that in the proof of \customref{THgib}{isomorphism between the group of Weil divisors and Cartier divisors on integral separated Noetherian locally factorial scheme}, we construct a group homor  



\section{Differential}
Let $A$ be a ring,  $B$ be an $A$-algebra, and  $M$ a $B$-module. An  \textbf{$A$-derivation of $B$ into  $M$} is a map $d:B\rightarrow M$ such that 
\begin{enumerate}[label=(\roman*)]
  \item $d$ respect addition. 
  \item $d(bb')=bdb'+b'db$. 
  \item $da=0$ for all  $a \in A$. 
\end{enumerate}
The \textbf{module of relative differential forms} of $B$ over $A$ to is a  $B$-module $\Omega_{B\quotient A}$ together with an $A$-derivation  $d:B\rightarrow \Omega_{B \quotient A}$ that satisfies \textbf{the universal property}: For any $B$-module  $M$, and for any  $A$-derivation  $d':B\rightarrow M$, there exists a unique $B$-module homomorphism $f: \Omega_{B \quotient A}\rightarrow M$ that makes the diagram: 
% https://q.uiver.app/#q=WzAsMyxbMiwwLCJcXE9tZWdhX3tCL0F9Il0sWzAsMCwiQiJdLFsyLDIsIk0iXSxbMSwwLCJkIl0sWzEsMiwiZCciLDJdLFswLDIsImYiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifX19XV0=
\[\begin{tikzcd}
	B && {\Omega_{B/A}} \\
	\\
	&& M
	\arrow["d", from=1-1, to=1-3]
	\arrow["{d'}"', from=1-1, to=3-3]
	\arrow["f", dotted, from=1-3, to=3-3]
\end{tikzcd}\]
commutes.  
\chapter{Cohomology}
\section{Sheaf cohomology}
Let $X$ be a topological space, $A$ a ring, and  $\mathcal{G}$ a sheaf of $A$-modules on $X$. We say $\mathcal{G}$ is \textbf{injective} if it satisfies \textbf{the universal property}: For each injective sheaf homomorphism $f:\mathcal{F}\rightarrow \mathcal{H}$ and arbitrary sheaf homomorphism $g: \mathcal{F}\rightarrow \mathcal{G}$, there exists a unique sheaf homomorphism $h: \mathcal{H}\rightarrow \mathcal{G}$ that makes the diagram: 
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXGJ1bGxldCJdLFsyLDAsIlxcYnVsbGV0Il0sWzAsMiwiXFxidWxsZXQiXSxbMCwyLCJnIiwyXSxbMSwyLCJoIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV0sWzAsMSwiZiJdXQ==
\[\begin{tikzcd}
	\mathcal{F}  && \mathcal{H}  \\
	\\
	\mathcal{G} 
	\arrow["f", from=1-1, to=1-3]
	\arrow["g"', from=1-1, to=3-1]
	\arrow["h"{description}, dotted, from=1-3, to=3-1]
\end{tikzcd}\]
commute. Let $\mathcal{F}$ be an arbitrary sheaf of $A$-modules on $X$. By an  \textbf{injective resolution starting from $\mathcal{F} $}, we mean a sequence of sheaf of abelian groups on $X$: 
\begin{align*}
  0 \rightarrow \mathcal{F} \overset{d_1}{\rightarrow}  \mathcal{I}_1 \overset{d_2}{\rightarrow} \mathcal{I}_2  \overset{d_3}{\rightarrow} \mathcal{I}_3  \overset{d_4}{\rightarrow} \cdots 
\end{align*}
such that $\mathcal{I}_i$ are all injective sheaves. The \textbf{sheaf cohomology} $H^i(X,\mathcal{F})$ is then defined by $H^i(X,\mathcal{F} )\triangleq \operatorname{Ker}(d_i(X))\quotient \operatorname{Im}(d_{i-1}(X))$. 
\begin{theorem}
\textbf{(Grothendieck's vanishing theorem)} Let $X$ be a Noetherian topological space of dimension $n$. For all  $i>n$ and  sheaves $\mathcal{F}$ of abelian groups on $X$, we have  $H^i(X,\mathcal{F})=0$. 
\end{theorem}
\begin{proof}
Hartshorne III.2.7.
\end{proof}
Let $X$ be a projective scheme over a field $k$, and let  $\mathcal{F}$ be an coherent $\mathcal{O}_X$-module on $X$. The \textbf{Euler characteristic $\chi (\mathcal{F})$} is defined by: 
\begin{align*}
\chi (\mathcal{F}) \triangleq \sum (-1)^i \operatorname{dim}_k H^i (X,\mathcal{F})
\end{align*}
The \textbf{arithmetic genus $p_a(X)$} is defined by: 
\begin{align*}
p_a(X)\triangleq (-1)^{\operatorname{dim}(X)}(\chi (\mathcal{O}_X)-1)
\end{align*}


\chapter{A threshold of my knowledge}
\section{Canonical $\mathcal{O}_X$-module and geometric genus}
Let $X$ be a nonsingular variety over $k$. I don't understand how to construct the \textbf{$\mathcal{O}_X$-module $\Omega_{X \quotient k}$ of relative differentials}. Its \textbf{canonical $\mathcal{O}_X$-module} is $\omega_X \triangleq \extp^{\operatorname{dim}X} \Omega_{X\quotient k}$. If $X$ is moreover projective, then we define its \textbf{geometric genus} by $p_g=\operatorname{dim}_k \Gamma  (X,\omega_X)$. 
\begin{theorem}
\textbf{(Canonical $\mathcal{O}_X$-module is invertible)} Let $X$ be a nonsingular abstract variety over $k$. Then, its canonical $\mathcal{O}_X$-module $\omega_{X}$ is invertible. 
\end{theorem}
\begin{proof}
?
\end{proof}
Let $X$ be a nonsingular variety over $k$. Because $\omega_X$ is invertible and abstract varieties are integral, we know \customref{THoCiK}{$\omega_X$ is $\mathcal{O}_X$-module isomorphic to some sub-$\mathcal{O}_X$-module of the $\mathcal{O}_X$-module $\mathcal{K}$ of total ring of fraction on $X$}, which implies \customref{THoCiK}{$\omega_X= \mathcal{L}(K)$ for some unique Cartier divisor  $K$}. We call such $K$ the  \textbf{Canonical divisor} of $X$. 
\begin{theorem}
\textbf{(Existence of nonsingular open dense subset of arbitrary variety)} Let $X$ be an abstract variety. There exists an open dense subset $U \subseteq X$ that contains no singularities of $X$. 
\end{theorem}
\begin{proof}

\end{proof}
Now, let $X$ just be a normal variety, and let $U\subseteq X$ be an open dense subset that contains no singularities of $X$. Because  $U$ is a nonsingular variety, we may talk about its canonical Weil divisor $K_U$. The \textbf{canonical divisor} of $X$ is then just the image of  $K_U$  under the group homomorphism $\operatorname{Div}U\rightarrow \operatorname{Div}X$ defined by:
\begin{align*}
P \mapsto \begin{cases}
  \overline{\diota (P) }& \text{ if $\overline{\diota (P)}$ is a prime divisor of $X$ } \\
  0& \text{ if it isn't }
\end{cases},\quad \text{ where }\diota:U \rightarrow X\text{ is the inclusion map. } 
\end{align*}




\section{Riemann-Roch for curves}
A \textbf{Hartshorne $C$-scheme} $X$ is a $1$-dimensional complete nonsingular abstract variety over $k$. Note that Hartshorne curve is also a Hartshorne scheme. Therefore, we may talk about Weil divisors of $X$.\\

Because Hartshorne $C$-scheme is clearly integral separated Noetherian locally factorial, for each Weil divisor $D$ of $X$, we may \customref{THgib}{identify it as a Cartier divisor}, and therefore \customref{THoCiK}{associate it with a unique invertible sub-$\mathcal{O}_X$-module $\mathcal{L}(D)$ of the $\mathcal{O}_X$-module $\mathcal{K}$ of total ring of fraction}. Because of such, we may define the number:\footnote{Hartshorne II.5.19 guarantee that this number is finite.}
\begin{align*}
l(D)\triangleq \operatorname{dim}_k H^0 (X, \mathcal{L}(D) )
\end{align*}
Because \customref{EDcfnc}{Hartshorne $C$-scheme is projective}, we may also talk about its geometric genus $p_g(X)\triangleq \operatorname{dim}_kH^0(X,\omega_X )$. 
\begin{theorem}
\textbf{(Riemann-Roch for curve)} Let $D$ be a divisor on a Hartshorne $C$-scheme $X$, and let $g$ be the genus  of $X$. Then: 
\begin{align*}
l(D)-l(K-D)= \operatorname{deg}D + 1 -g
\end{align*}
\end{theorem}
\begin{proof}

\end{proof}
\section{Paper readings: Some notions for normal abstract variety}
Let $X$ be a normal abstract variety. Because \customref{ECoDp1}{Noetherian local integrally closed domains of Krull dimension one are regular}, we know $X$ must be nonsingular in codimension one. Therefore, we may talk about the Weil divisor groups of $X$. In the first paragraph of the proof of \myref{theorem}{THgib}, we constructed a group homomorphism from $\Gamma  (X, \mathcal{K}^{\times}\quotient \mathcal{O}^{\times}  )$ to $\operatorname{Div}X$. We say a \textbf{Weil divisor  $D \in \operatorname{Div}X$ is Cartier} if $D$ lies in the image of that group homomorphism.  A Weil divisor is called $\Q$-Cartier if  $mD$ is Cartier for some  $m \neq 0 \inz$. \\

Let $X$ be a normal abstract variety. By a \textbf{pair} $(X,\Delta)$,  we mean that $\Delta$ is a Weil divisor whose coefficients are all rational. \\



Let $Y$ be a normal abstract variety. We say a scheme morphism $f:X\rightarrow Y$ is a \textbf{resolution of singularities} if $X$ is a nonsingular abstract variety with  $f$ being proper birational. Let $D$ be a Cartier divisor of $Y$ defined in term of local section  $\set{(U_i,g_i \in \mathcal{K}^{\times}(U_i) )}$. Its \textbf{pullback} $f^*(D)$ is defined by $\set{(f^{-1}(U_i),f^{\sharp}(g_i))}$  . \\



Let $X,Y$ be two normal abstract variety, and $f:X\rightarrow Y$ a proper birational scheme morphism. The \textbf{exceptional locus} $\operatorname{Exc}(f)$ is defined to be the collection of $x \in X$ such that there exists no neighborhood $U$ of $x$ and neighborhood  $V$ of  $f(x)$ such that $f|_U:U \rightarrow V$ forms a scheme isomorphism. 
\begin{equiv_def}
\textbf{(Exceptional divisor)} Let $D$ be a prime divisor of $X$, and $f:X\rightarrow Y$ a proper birational scheme morphism. The followings are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $D \subseteq \operatorname{Exc}(f)$. 
  \item $\operatorname{codim}_Y(f(D))\geq 2$. 
\end{enumerate}
\end{equiv_def}
\begin{theorem}
\textbf{(Smooth implies log canonical)} Let $f\inc[x,y,z]$ be homogeneous. If $(f=0)\subseteq \P^2$ is smooth, then $(f=0) \subseteq \P^2$ is log canonical. 
\end{theorem}
\begin{proof}

\end{proof}
\section{Log canonical threshold}
Fix $n\geq 1$. We call $w \in (\Z_0^+)^n$ \textbf{weight vectors}. Given a monomial $c z_1^{\alpha _1}\cdots z_n ^{\alpha _n}\in \C[z_1,\dots ,z_n]$, we define its \textbf{degree respect to $w$} by: 
\begin{align*}
\operatorname{deg}_w (z_1^{\alpha_1 }\cdots z_n ^{\alpha _n})\triangleq \sum_{i=1}^n  w_i \alpha_i
\end{align*}
Let $f$ be a holomorphic $\C$-valued function defined on some neighborhood of  $\textbf{0}\inc^n$.  Its \textbf{log canonical threshold} is defined by: 
\begin{align*}
c_0 (\C^n,f)\triangleq \operatorname{sup} \set{c\inr_0^+: \abso{f}^{-c}\text{ is locally $L^2$ near $0$.}}
\end{align*}
\begin{equiv_def}
\textbf{(Log canonical threshold)} Let $f$ be a holomorphic $\C$-valued function defined on some neighborhood of  $\textbf{0}\inc^n$. The following real numbers exists and are equivalent:
\begin{enumerate}[label=(\roman*)]
  \item $\operatorname{sup} \set{c \inr: (\C^n, cZ(f))\text{ is log canonical near }0}$. 
  \item The log canonical threshold of  $f$.  
\end{enumerate}
\end{equiv_def}
\begin{proof}
  Highly nontrivial. This statement in proved in Proposition 8.2 (which is proved in Proposition 3.20) of the note \emph{Singularities of Pairs} by J.Kollar.
\end{proof}
Let $f$ be a holomorphic $\C$-valued function defined on some neighborhood of  $\textbf{0}\inc^n$. On some  neighborhood of $\textbf{0}$, we may write: 
\begin{align*}
f(\textbf{z})= \sum_{\alpha } b_\alpha \textbf{z}^{\alpha },\quad \text{ where $\alpha $ are multi-indices.}
\end{align*}
We define: 
\begin{enumerate}[label=(\roman*)]
  \item its \textbf{order of zero} at origin to be $\operatorname{mult}_0(f)\triangleq \min  \set{\abso{\alpha }\inz_0^+ :b_\alpha  \neq 0 }$. 
  \item its \textbf{weighted multiplicity} to be $w(f)\triangleq \min \set{\operatorname{deg}_w(\textbf{z}^{\alpha }): b_\alpha \neq 0 }$, when a weight vector $w\in (\Z_0^+)$  is given. 
  \item its \textbf{weighted homogeneous leading term} to be $f_w \triangleq \sum_{\abso{\alpha }= w(f)}b_\alpha \textbf{z}^{\alpha }$. 
  \item $f$ to be \textbf{critical} at $\textbf{z}'$ if  $\frac{\partial f}{\partial z_i}\big|_{\textbf{z}'}=0$ for all $i$.  
\end{enumerate}
Let $f:U\rightarrow \C,g:V\rightarrow \C$ be two holomorphic functions. We say they are \textbf{holomorphically equivalent} if there exists open subsets $U'\subseteq U,V' \subseteq V$, an $u\inc^\times$, and a biholomorphic function $\pfi : U' \rightarrow V'$ such that 
\begin{align*}
f(\textbf{z})= u g(\pfi (\textbf{z})),\quad \text{ for all }\textbf{z} \in U'
\end{align*}
If $f:U\rightarrow \C$ and $g:V\rightarrow \C$ are holomorphically equivalent, we write $f\sim  g$. 
\begin{theorem}
\textbf{(Complex Morse lemma)}  Let $U \subseteq \C^n$ be a neighborhood of origin, and let $f:U \rightarrow \C$ be holomorphic. 
\end{theorem}





Recall that the absolute convergent domain of a power series is always a union of polydiscs centered at origin. Therefore, we may talk about the \textbf{convergent power series ring} $\C\set{z_1,\dots ,z_n}$. 
\begin{theorem}
\textbf{(Process to find coordinate change that have higher remainder weight)} Let $U\subseteq \C^n$ be a neighborhood of $\textbf{0}$, and let $f:U \rightarrow \C$ be a nonzero holomorphic function critical at $\textbf{0}$. Let:
\begin{enumerate}[label=(\roman*)]
  \item $w$ be a weight vector. 
  \item $J \subseteq \C \set{z_1,\dots ,z_n}$ be the ideal generated by $\partial f_w\quotient \partial z_1,\dots , \partial f_w \quotient \partial z_n$. 
  \item $\set{u_i}$ be a basis for the $\C$-vector space $\C \set{z_1,\dots ,z_n} \quotient J$. 
\end{enumerate}
 For any $N> w(f)$, there exists some $\phi$ defined on some neighborhood of $\textbf{0}$  such that: 
\begin{enumerate}[label=(\roman*)]
  \item  $w(\phi)>N$. 
  \item We may write   $ f \sim  f_w+ \sum_{w(u_i)\leq N}a_i u_i + \phi$, for some  $a_i \inc,u_i \inc \set{z_1,\dots ,z_n}$. 
\end{enumerate}
\end{theorem}
\begin{proof}
Let $f=f_w+g$, and define $d_0 \triangleq w(f),d_1\triangleq w(g)$. Because $g_w$ is a weighted homogeneous polynomial, we may write $g_w= \sum_{i=1}^r a_ih_i$ where $h_i$ are monomials of weighted degree $d_1$, and $a_i\inc$. WLOG, let $h_1,\dots ,h_m$ be the collection of $h_i \not\in J$. We may then write: 
\begin{align*}
h_{m+1} + \cdots + h_r = \sum_{j=1}^n v_j \frac{\partial f_w}{\partial z_j},\quad \text{ for some }z_j \in \C \set{\textbf{z}}
\end{align*}
This give us: 
\begin{align*}
g_w= \sum_{i=1}^m a_ih_i + \sum_{j=1}^n v_j \frac{\partial f_w}{\partial z_j}
\end{align*}
Which implies: 
\begin{align*}
w\left( \sum_{j=1}^n v_j \frac{\partial f_w}{\partial z_j} \right) = w(g)
\end{align*}
How can we then deduce: 
\begin{align*}
w(v_j)= w(g)- w\left(\frac{\partial f_w}{\partial z_j}\right),\quad \text{ for all $j$ }? 
\end{align*}
\end{proof}

\begin{align*}
r\triangleq \sum_{\alpha } b_\alpha (\textbf{z}+\textbf{v})^{\alpha }- \sum_\alpha  b_\alpha \textbf{z}^{\alpha }  - \sum b_\alpha v_j \frac{\partial \textbf{z}^{\alpha }}{\partial z_j}
\end{align*}


\begin{theorem}
\textbf{(Powerful tool)} Let $U \subseteq \C^n$ be a neighborhood of $\textbf{0}$, and let $f:U\rightarrow \C$ be a nonzero holomorphic function. Let $d\triangleq \operatorname{mult}_0(f)$, and let $f_d$ be the degree  $d$ homogeneous part of the Taylor series of $f$. Then: 
\begin{enumerate}[label=(\roman*)]
  \item $1\quotient d \leq c_0(f) \leq n \quotient d$. 
  \item $c_0(f)= n \quotient d \iff  (\P^n , \frac{n}{d}(f_d=0))$  is log canonical. 
  \item If $(f_d=0) \subseteq \P^{n-1}$ is log canonical, then $c_0(f)=\min \set{1, n\quotient  d}$   
\end{enumerate}
Let $w$ be a weight vector. We have:
\begin{align*}
c_0(f) \leq \frac{\sum w(x_i)}{w(f)}
\end{align*}
If $(f_d=0)\subseteq \P^{n-1}$ is log canonical outside the origin $0$, then equality holds. 
\end{theorem}
\begin{proof}

\end{proof}
\begin{theorem}
\textbf{(All log canonical threshold for $\C^2$)} Let $U \subseteq \C^2$ be an open set, and let $f:U \rightarrow \C$ be a nonzero holomorphic function. Then the number $c_0(f)$ is one of the following forms: 
\begin{enumerate}[label=(\roman*)]
  \item $2\quotient n,\quad n\in \set{2,3,4,\dots }$. 
  \item 
    \begin{align*}
    \frac{m_1+m_2}{km_1m_2+n_1m_2+n_2m_1},\quad \text{ where } -km_1 < n_1-n_2 < km_2,\operatorname{gcd}(m_1,m_2)=1
    \end{align*}
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}
Let $U\subseteq \C^n$ be a neighborhood of origin, and let $f:U\rightarrow \C$ be nonzero holomorphic. On a small enough polydisc centered at origin, we may write 
\begin{align*}
f(\textbf{z})= \sum_{\alpha } b_\alpha \textbf{z}^{\alpha },\quad \text{ where $\alpha $ are multi-indices.}
\end{align*}
We define the  \textbf{zero multiplicity} of $f$ by 
\begin{align*}
\operatorname{mult}_0(f)\triangleq  \min \set{\abso{\alpha }: b_\alpha \neq 0} 
\end{align*}
\begin{theorem}
\textbf{(Compute)} Let $f=x^3 +yz^2+ dxy^{2k+2}+ey^{3k+3}$, where $d,e \inc^{\times}$ and $k\inn$. Then 
\begin{align*}
f(x,y,z)=0,\frac{\partial f}{\partial x}(x,y,z)=0,\frac{\partial f}{\partial y}(x,y,z)=0,\frac{\partial f}{\partial z}(x,y,z)=0 \implies 
\end{align*}
\end{theorem}
\begin{proof}
Compute 
\begin{align*}
&\frac{\partial f}{\partial x}= 3x^2 +dy^{2k+2} \\
&\frac{\partial f}{\partial y}=z^2+d(2k+2)xy^{2k+1}+e(3k+3)y^{3k+2}  \\
& \frac{\partial f}{\partial z}= 2yz
\end{align*}
Because $2yz=0$, we know either $y=0$ or $z=0$. If $y=0$, then  we know $z=0$ from  $\frac{\partial f}{\partial y}=0$ and $x=0$ from  $ \frac{\partial f}{\partial x}=0$. \\

We from now no  
\end{proof}
\chapter{Not used yet} 
 \section{Dimension Theory}
\label{DT}

\begin{theorem}
\textbf{(Equivalent definition of variety dimension: Krull dimension of coordinate ring)} Given variety $V\subseteq \A^n$, its dimension equals to the Krull dimension of its coordinate ring $\Gamma  (V) \cong k[x_1,\dots ,x_n]\quotient I(V)$.  
\end{theorem}
\begin{proof}
Let $Z_0 \subset \cdots \subset Z_m$ be a chain of distinct irreducible closed subset of $V$. As one may check with \customref{ctfr}{ring correspondence theorem},   
\begin{align*}
I(Z_m)+ I(V) \subset \cdots \subset I(Z_0)+I(V) \subseteq \Gamma (V)  
\end{align*}
forms a chain of distinct prime ideals of $\Gamma (V)$. We have shown $\operatorname{dim}(V)\leq  \operatorname{Krudim}(\Gamma V)$.\\

Let $\mathfrak{p}_0 \subset \cdots \subset \mathfrak{p}_m $ be a chain of distinct prime ideals of $\Gamma (V)$, so again by \customref{ctfr}{ring correspondence theorem}, there exists a chain $I(V)\subseteq I_0 \subset \cdots \subset I_m $ of distinct prime ideals of $k[x_1,\dots,x_n]$. It is easy to check that $V(I_m)\subset \cdots \subset V(I_0)$ indeed forms a distinct irreducible closed subset of $V$ by corollary of Nullstellensatz.  
\end{proof}
Let $V\subseteq \A^n$ be an nonempty affine variety. We use the notation $k(V)\triangleq \operatorname{Frac}(\Gamma V)$ to denote the \textbf{field of rational function on $V$}. Given rational function $f$ on $V$, we say $f \in k(V)$ is \textbf{defined} at $a  \in V$ if there exists $g,h \in \Gamma  V$ such that $f=gh^{-1}$ and $h(a)\neq 0$. Given $a \in V$, we use the notation $\mathscr{O}_a(V)$ to denote the ring of rational functions on $V$ that are defined at $a$. We have 
\begin{align*}
 k \subseteq \Gamma (V)\subseteq \mathscr{O}_a (V) \subseteq k(V) 
\end{align*}
Clearly, for each $f \in \mathscr{O}_a(V)$, we may well-define a \textbf{value of $f$ at $a$} by saying $f(a)\triangleq g(a)h(a)^{-1}$, and we see that indeed, $\mathscr{O}_a(V)$ is a local ring whose maximal ideal is
\begin{align*}
\mathfrak{m}_a(V)\triangleq \set{f\in \mathscr{O}_a(V):f(a)=0}
\end{align*}


\begin{lemma}
Suppose $B \subseteq A$, $A$ integral domain, and $B$ integrally closed. We have 
\begin{align*}
\operatorname{Krudim}(A_\mathfrak{m})=\operatorname{Krudim}(B_{B \cap \mathfrak{m}})
\end{align*}
\end{lemma}



\begin{theorem}
\textbf{(Equivalent Definition of variety dimension: Transcendence degree of field of rational function)} Given nonempty variety $V \subseteq \A^n$, its dimension equals $\operatorname{trdeg}_kk(V)$. 
\end{theorem}
\begin{proof}
According to \customref{NNL}{Noether normalization lemma}, there exists $x_1,\dots ,x_r \in \Gamma (V)$,  algebraically independent over $k$ with $r=\operatorname{Krudim}(\Gamma  V)$ such that $\Gamma (V)$  integral over $k[x_1,\dots ,x_r]$. This implies $k(V)$ algebraic over $k(x_1,\dots ,x_r)$ and thus  $\operatorname{trdeg}_kk(V)=r$\footnote{Clearly, $\operatorname{trdeg}_kk(x_1,\dots ,x_r)=r$}.  



\end{proof}



\section{Some Fulton 2}
For intuitively geometrical reason, we usually call locus of a single non-constant polynomial $F \in k[x_1,\dots ,x_n]$ a \textbf{hypersurface}, and a hypersurface in $\A^2$ an  \textbf{affine plane curve}. 
\begin{lemma}
\label{IL}
\textbf{(Intuitive Lemma)} If $F,G \in k[x,y]$ have no common factor, then $V(F,G)=V(F)\cap  V(G)$ is a finite set of points.
\end{lemma}
\begin{proof}

\end{proof}
Because algebraically closed field is always infinite, the following classification theorem particularly applies to affine varieties.   
\begin{theorem}
\textbf{(Classification of irreducible affine variety in $\A^2$)} If $k$ is infinite, every irreducible affine algebraic set $V \subseteq \A^2$ falls into one of the following class: 
\begin{enumerate}[label=(\alph*)]
  \item  $\A^2$. 
  \item Empty set.  
  \item A finite set. 
  \item $V(F)$ where $F \in k[x_1,x_2]$ is irreducible. 
\end{enumerate}
\end{theorem}
\begin{proof}
  Clearly, if $I(V)=0$\footnote{Zero ideal is prime in the integral domain $k[x_1,x_2]$.} then $V=\A^2$, class (a). Also, if $I(V)$ contains a nonzero constant, then $V$ is empty, class (b). We have shown that if $V$ is not in class  (a) nor class (b), then $I(V)$ contains some non-constant polynomial $F$.\\

Because $k[x_1,x_2]$ is a UFD, we may write $F=F_1\cdots F_n$ where $F_1,\dots ,F_n$ are all irreducible. It then follows from $I(V)$ being prime that $F_1 \in I(V)$, WLOG. If $I(V)=\langle F_1\rangle $, then $V$ is in class (d), so suppose there exists some $G \in I(V)- \langle F_1\rangle $. This immediately implies $V \subseteq V (F_1,G)$, and since  $F_1$ is irreducible and  $G \not\in \langle F_1\rangle $, we may apply \myref{Lemma}{IL} to see that $V$ is finite, class (c).
\end{proof}
\section{More Equivalent Definitions of DVR}
Let $u \in K^{\times}$. We sometimes denote the \textbf{fractional principal ideal} $Au$ by  $\langle u\rangle $. It is clear that $\langle u\rangle $ is invertible with inverse $\langle u^{-1}\rangle $. 
\begin{theorem}
\textbf{(Equivalent Definitions of DVR)} Given an integral domain $D$, the following are equivalent: 
\begin{enumerate}[label=(\roman*)]
  \item $D$ is a DVR with discrete valuation $\nu$.   
  \item $D$ is a local Euclidean domain and not a field.  
  \item $D$ is a local PID and not a field. 
  \item $D$ is local and every nonzero fractional ideal of $D$ is invertible. 
  \item $D$ is local and  
  \item $D$ is local, Noetherian and of Krull dimension $1$. 
\end{enumerate}
\end{theorem}
\begin{proof}
  For $(\text{i})\implies (\text{ii})$, note that $D$ is local because  \customref{EDovr}{ideals of $D$ are totally ordered by inclusion}, that  $\nu $ is the desired Euclidean function\footnote{Suppose $x,y \in D, y\neq 0$. If $\frac{x}{y}\in D$, then $x= y \cdot \frac{x}{y}+0$ suffices. If $\frac{x}{y}\not\in D$, then $x=y+(x-y)$ suffices.}, and $D$ is not a field because $\nu$ is nontrivial.\\

  For $(\text{ii})\implies (\text{iii})$, just recall  \customref{un1}{Euclidean domains are PID}.\\

For  $(\text{i})\implies (\text{iv})$, let $ \mathfrak{a}_1 = \langle x\rangle $ in \myref{Equation}{Da1}, and let $M$ be a nonzero fractional ideal. Let $y \in D$ satisfies $yM \subseteq D$, so $yM= \langle x^k\rangle $ for some $k\inn$. This implies $M$ is a fractional principal ideal $M= \langle x^{k- \frac{\nu  (y)}{p}}\rangle $, thus invertible.  \\

For $(\text{iv})\implies (\text{i})$, first note that because every integral ideal of $D$ is invertible, thus finitely generated, \customref{EDoN}{$D$ is Noetherian}.  
\end{proof}
\begin{theorem}
\textbf{(Sufficient conditions for valuation rings to be discrete)} If $D$ is a valuation ring of  $\nu :\operatorname{Frac}(D)\rightarrow \Gamma \cup \set{\infty}$, then the following are equivalent: 
\begin{enumerate}[label=(\alph*)]
  \item $\nu $ is discrete. 
  \item $D$ is Noetherian. 
  \item $D$ is a principal ideal domain.   
\end{enumerate}
\end{theorem}


\section{PID, UFD and Gauss Lemma}
Let $A$ be a ring and $a \in A$ be an non-unit nonzero element. We say $a$ is  \textbf{irreducible} if  $a=xy\implies x\text{ is a unit or $y$ is a unit}$. We say $a$ is \textbf{prime} if $\langle a\rangle $ is prime. We say an integral domain $D$ is a \textbf{UFD (Unique Factorization Domain)} if every nonzero non-unit element of $D$ can be written as some finite product of irreducible elements, up to units and change of order. We say an integral domain is a \textbf{PID (Principal Ideal Domain)} if every ideal is principal. We say an integral domain is a  \textbf{GCD domain} if there always exists a unique minimal principal ideal containing the ideal generated by two given elements. If $D$ is a GCD domain, and $x,y \in D$, we use $\operatorname{gcd}(x,y)$ to denote the unique principal ideal containing $\langle x,y\rangle $. Clearly, every PID is  Noetherian, and moreover: 
\begin{theorem}
\textbf{(Irreducibles are prime in PID)} If $D$ is a PID and $a \in D$  is irreducible, then $a$ is prime. 
\end{theorem}
\begin{proof}
Let  $bc \in \langle a\rangle$. From the premise, if we write 
\begin{align*}
\langle a,b\rangle = \langle d\rangle \text{ and }a=de
\end{align*}
We see that either $d$ or $e$ is a unit. If $e$ is a unit, then when we write $b=yd$ we see $b=yae^{-1} \in \langle a\rangle $. If $d$ is a unit, then $\langle a,b\rangle = \langle d\rangle =D$ implies existence of some $x,y \in D$ such that $xa+yb=1$ which implies $c=cxa+ybc \in \langle a\rangle $.  \footnote{Because $bc \in \langle a\rangle $}
\end{proof}
\begin{corollary}
\textbf{(PID are UFD)} If $D$ is a PID, then $D$ is an UFD. 
\end{corollary}
\begin{proof}
Let 
\begin{align*}
\mathscr{U}\triangleq \set{\langle x\rangle \subseteq D: x \in D\text{ can't be written as some finite product of irreducible elements.}}
\end{align*}
Assume for a contradiction that $\mathscr{U}$ is nonempty. \customref{EDoN}{Because $D$ is Noetherian, there exists maximal $\langle x\rangle  \in \mathscr{U}$}. By construction, $x$ is reducible and thus not prime, which implies the existence of some maximal ideal $\langle y\rangle$ that strictly include $\langle x\rangle $. Because $\langle y\rangle \not \in \mathscr{U}$, we have irreducible factorization $y=a_1\cdots a_n$. Let $x=sy$ and  $u\triangleq sa_2\cdots a_n$. We shall cause a contradiction from  $x=a_1u$. If $\langle u\rangle \not \in  \mathscr{U}$, then because $a_1$ is irreducible, we see $x$ can be written as a finite product of irreducible elements\footnote{You may check that in general, if and $\langle t\rangle = \langle t'\rangle $, then $t=u't'$ for some unit $u'$}, a contradiction. If $\langle u\rangle \in \mathscr{U}$, then by maximality of $\langle x\rangle $, we have $\langle u\rangle = \langle x\rangle $, which implies $a_1$ is a unit, a contradiction. \\

We now prove the uniqueness of factorization. Suppose 
\begin{align*}
a= p_1\cdots p_n= q_1 \cdots q_m
\end{align*}
are two factorization. Because $p_1$ is prime, for some $i$ we have $q_i \in \langle p_1\rangle $. WLOG suppose $i=1$. Because  $q_1$ is irreducible, we see that  $q_1=u_1p_1$ for some unit  $u_1$, which implies\footnote{Because $A$ is an integral domain.}
\begin{align*}
p_2\cdots p_n= u_1q_2 \cdots q_m
\end{align*}
Continuing this process, we have 
\begin{align*}
p_n=u_{n-1}q_n \cdots q_m
\end{align*}
The proof then follows from $p_n$ being irreducible.
\end{proof}
\begin{theorem}
\textbf{(UFD are GCD domain)} If $D$ is an UFD, then  $D$ is a GCD domain. 
\end{theorem}
\begin{proof}
Let $x,y \in D$. If any of $x,y$ is a unit, then $\langle 1\rangle $ is the unique minimal principal ideal containing $\langle x,y\rangle $, and if $y$ is zero, then $\langle x\rangle$ is the unique minimal principal ideal containing $\langle x,y\rangle $. Now suppose they have the irreducible decomposition: 
\begin{align}
\label{irxx}
x=(x_1\cdots x_t)x_{t+1}\cdots x_r \text{ and }y=(x_1 \cdots x_t)y_{t+1}\cdots y_s
\end{align}
where $ux_i \neq y_j$ for all unit $u$ and $i,j>t$. Define $d\triangleq x_1\cdots x_t$. Clearly, if $\langle d\rangle$ is the smallest principal ideal containing $\langle x,y\rangle $, then it is the unique minimal principal ideal containing $\langle x,y\rangle $. Therefore, it suffices to prove for any $\langle f\rangle $ containing $\langle x,y\rangle $, we have $\langle d\rangle \subseteq \langle f\rangle $.\\

If $f$ is a unit, then what we want to prove trivially holds true. Assume for a contradiction that $\langle d\rangle \not \subseteq \langle f\rangle $. Clearly, the irreducible decomposition of $f$ must always contain some $g$ that doesn't divide $d$ in the sense that $d \not\in gD$. This implies for some $i,j>t$, $g$ divides both $x_{i}$ and $y_{j}$. This cause a contradiction to how we construct \myref{Equation}{irxx}: $y_{j} \not\in D^{\times}x_i$ for all $i,j>t$.
\end{proof}
Let $A$ be a ring, and $f\in A[x_1,\dots ,x_n]$ a formal polynomial. Its \textbf{content} $\operatorname{cont}(f)$ is the ideal in $A$ generated by its coefficients, and we say $f$ is \textbf{primitive} if $\operatorname{cont}(f)=A$. Gauss show that a non-constant polynomial in $\Z[x]$ is irreducible in $\Z[x]$ if it is irreducible in $\Q[x]$ and primitive in $\Z[x]$. Here, we generalize his result to the case of commutative ring. 
\begin{theorem}
\textbf{(Gauss lemma over commutative ring)} For each pair of polynomials $f,g \in A[x_1,\dots ,x_n]$, we have 
\begin{align*}
\operatorname{cont}(fg)\subseteq \operatorname{cont}(f)\operatorname{cont}(g) \subseteq  \sqrt{\operatorname{cont}(fg)} 
\end{align*}
\end{theorem}
\begin{proof}
$\operatorname{cont}(fg)\subseteq \operatorname{cont}(f)\operatorname{cont}(g)$ is clear. By \customref{raed}{definition of radical}, to prove $\operatorname{cont}(f)\operatorname{cont}(g)\subseteq \sqrt{\operatorname{cont}(fg)} $, we only have to prove every prime ideal containing $\operatorname{cont}(fg)$ also contains $\operatorname{cont}(f)\operatorname{cont}(g)$. Let $\mathfrak{p}\subseteq A$ be a prime ideal containing $\operatorname{cont}(fg)$. Because 
\begin{align*}
\mathfrak{p}[x_1,\dots ,x_n]\triangleq \set{h \in A[x_1,\dots ,x_n]:\text{ All coefficients of $h$ lie in $\mathfrak{p}$.}}
\end{align*}
forms a prime ideal of $A[x_1,\dots ,x_n]$ as one can check and because $fg \in \mathfrak{p}[x_1,\dots ,x_n]$, we see that one of $f,g$ is an element of  $\mathfrak{p}[x_1,\dots ,x_n]$, i.e., one of $\operatorname{cont}(f),\operatorname{cont}(g)$ is a subset of $\mathfrak{p}$. This immediately implies $\operatorname{cont}(f)\operatorname{cont}(g)\subseteq \mathfrak{p}$. 
\end{proof}
Noting that in a GCD domain 
\begin{align*}
\operatorname{gcd}(x,y,z)\triangleq \operatorname{gcd}(d,z)\text{ where }\langle d\rangle =\operatorname{gcd}(x,y)
\end{align*}
and so 
\begin{align*}
\operatorname{gcd}(\operatorname{cont}(a_nx^n+\cdots +a_1x+a_0))\triangleq \operatorname{gcd}(a_0,\dots ,a_n)\text{ is well defined. }
\end{align*}
We may give the Gauss lemma for UFD, whose proof is obvious if one use the notion of "divisors".   
\begin{theorem}
\textbf{(Gauss lemma over UFD)} If $A$ is an UFD, then for each pair of polynomials $f,g \in A[x_1,\dots ,x_n]$, we have 
\begin{align*}
\operatorname{gcd}(\operatorname{cont}(fg))= \operatorname{gcd}(\operatorname{cont}(f))\operatorname{gcd}(\operatorname{cont}(g))
\end{align*}
\end{theorem}
\begin{corollary}
\textbf{(Gauss lemma over UFD)} Given UFD $A$ with $K\triangleq \operatorname{Frac}(A)$, if $f \in A[x_1,\dots ,x_n]$ is irreducible, then $f \in K[x_1,\dots ,x_n]$ is also irreducible.
\end{corollary}
\begin{proof}
If $f=gh \in K[x_1,\dots ,x_n]$ is reducible, then $f=g(rh)\in A[x_1,\dots ,x_n]$ is reducible, where $r$ is the product of all denominators of coefficients of $h$. 
\end{proof}
\begin{proposition}
\textbf{()} Every algebraically closed set is infinite. 
\end{proposition}
\begin{proposition}
\label{un2}
\textbf{()} If $k$ is an infinite filed, and $F\in k[x_1,\dots ,x_n]$ maps all $a \in \A^n$ to $0$, then  $F=0$. 
\end{proposition}
\section{Archived}
Moreover, clearly we have
\begin{align*}
I(\overline{X})=I(X),\quad\text{for all }X \subseteq \A^n
\end{align*}
and in summary, we have the (not commutative) diagram:  
\[\begin{tikzcd}
\label{di1}
  {\text{subsets of }\A^n} && {\text{ideals of }k[x_1,\dots,x_n]} \\
	\\
                           & {\text{ closed set of }\A^n}
	\arrow["I", from=1-1, to=1-3]
	\arrow["V", from=1-3, to=3-2]
	\arrow[hook', from=3-2, to=1-1]
\end{tikzcd}\]
Even thought not commutative at the top two nodes, indeed the diagram is commutative at the node below: 
\begin{align}
\label{VVIV}
V=V(I(V)),\quad \text{for all closed $V \subseteq \A^n$ }
\end{align}
  \item  By \customref{HBT}{Hilbert's basis theorem}, every closed set in $\A^1$, even if $k$ is not closed, must be either finite or the whole space. \label{CnD}
  \item Because of (B), if $k$ is infinite, then $\A^1$ is irreducible, which in particular apply to the usual case when $k$ is closed.\footnote{To see algebraically closed field is infinite, assume not and consider $1+ \prod (x-y_i)$ where $y_i$ runs through all elements.} 
  \item  $Y\subseteq \A^n$ is irreducible if and only if $I(Y)$ is prime, and in such case if $Y$ moreover is closed, we call $Y$ an \textbf{(affine) variety}. This in particular shows that $\A^n$ are irreducible, as  $I(\A^n)=0$, another proof of (D). 
 Because of \customref{CnD}{(C) ad (D)}, clearly $\A^1$ is $1$-dimensional as expected. We will show in the \customref{DT}{section on Dimension Theory} that indeed for all $n$, $\A^n$ is  $n$-dimensional.   

\chapter{The Great Theorems}
\section{Hilbert's Nullstellensatz and basis theorem}
\label{FGN}
\begin{theorem}
\label{HBT}
\textbf{(Hilbert's Basis Theorem)} If $A$ is Noetherian, than the polynomial ring $A[x]$ is also Noetherian. 
\end{theorem}
\begin{proof}
Let $X$ be an ideal in  $A[x]$. We are required to show that $X$ is finitely generated. Let $I$ be the ideal in $A$  that contains exactly the leading coefficients of elements of  $X$. Because $A$ is Noetherian, we may let $I=  \langle a_1,\dots ,a_n\rangle $ and let $f_1,\dots ,f_n \in X$ have leading coefficients $a_1,\dots ,a_n$. Let $X'\triangleq \langle f_1,\dots ,f_n\rangle \subseteq X$ and let $r\triangleq  \max \set{\operatorname{deg}(f_1),\dots ,\operatorname{deg}(f_n)}$.\\

We first show 
\begin{align}
\label{23X}
X= \Big(X \cap \langle 1,x,\dots ,x^{r-1}\rangle \Big) + X'
\end{align}
Let $f\in X$ with $\operatorname{deg}(f)=m$ and leading coefficients $a$. We wish to show $f \in (X \cap \langle 1,x,\dots ,x^{r-1}\rangle )+X'$. Because $a \in I$, we may find some $u_i \in A$ such that $a= \sum u_i a_i$. Clearly, these $u_i$ satisfy
\begin{align*}
f- \sum u_if_ix^{m-\operatorname{deg}(f_i)} \in X,\quad \text{and }\sum u_i f_ix^{m-\operatorname{deg}(f_i)}\in X'
\end{align*}
and satisfy
\begin{align*}
\operatorname{deg}\Big(f- \sum u_i f_i x^{m-\operatorname{deg}(f_i)}\Big)<m
\end{align*}
Proceeding this way, we end up with $f-g=h$ where  $g\in X'$ and $h \in X \cap \langle 1,x,\dots ,x^{r-1}\rangle $. We have proved \myref{Equation}{23X}. Now, because $X'$ is finitely generated, to show  $X$ is finitely generated, it only remains to show the ideal $X \cap \langle 1,x,\dots ,x^{r-1}\rangle $  is finitely generated, which follows immediately from noting $\langle 1,x,\dots ,x^{r-1}\rangle $ as a module is Noetherian.    
\end{proof}
\begin{theorem}
\label{WfoN}
\textbf{(Weak form of Nullstellensatz)} Given field $k$ and finitely generated  $k$-algebra  $B$, if  $B$ is a field then it is a finite algebraic extension of $k$.  
\end{theorem}
\begin{proof}
A proof can be found in the end of Chapter 5 of Atiyah-MacDonald. Another proof can be found in Chapter 7 of Atiyah-MacDonald, at page 82.
\end{proof}
\begin{theorem}
\label{HN}
\textbf{(Hilbert's Nullstellensatz)} Given algebraically closed field $k$ and ideal  $I\subseteq k[x_1,\dots ,x_n]$. If we let $V$ be the locus of $I$: 
\begin{align*}
V\triangleq   \set{x\in k^n : F(x)=0\text{ for all }F \in I}
\end{align*}
and let $J$ be the defining ideal of $V$: 
 \begin{align*}
J\triangleq  \set{F \in k[x_1,\dots ,x_n]: F(x)=0\text{ for all }x \in V}
\end{align*}
then $J = \sqrt{I}$. 
\end{theorem}
\begin{proof}
  $\sqrt{I}\subseteq J$ is clear. Assume for a contradiction that $F \in J - \sqrt{I}$. \customref{raed}{Because $F \not\in \sqrt{I}$, there exists some prime $\mathfrak{p}\subseteq k[x_1,\dots ,x_n]$ that contains $\sqrt{I}$ but does not contain $F$}. Denote 
\begin{align*}
B \triangleq k[x_1,\dots ,x_n]\quotient  \mathfrak{p} \text{ and }g\triangleq [F] \in B\text{ and }C\triangleq B_g
\end{align*}
Let $\mathfrak{m}$ be some maximal ideal of $C$. Because of the $k$-algebra homomorphism diagram: 
 \begin{align}
\label{kdm}
k[x_1,\dots ,x_n]\xrightarrow{\text{ring quotient}}  B\xrightarrow{\text{localization}} C\xrightarrow{\text{ring quotient}} C \quotient \mathfrak{m}
\end{align}
We see that  by  \customref{HBT}{Hilbert Basis Theorem}, \myref{theorem}{cpoN}, and \customref{EDoN}{equivalent definition of Noetherian},  $C\quotient \mathfrak{m}$ is finitely generated over $k$, thus a finite algebraic extension of $k$ by  \customref{WfoN}{weak form of Nullstellensatz}. Because $k$ is algebraically closed, this implies $C\quotient \mathfrak{m}\cong  k$. \\

Now, for each  $1\leq i\leq n$, let $t_i\in k\cong C\quotient \mathfrak{m}$ be the image of $x_i\in k[x_1,\dots ,x_n]$ under the $k$-module homomorphism in \myref{diagram}{kdm}.  Letting $t\triangleq (t_1,\dots ,t_n)\in k^n$, it is easy to check\footnote{Recall $k[x_1,\dots ,x_n]=\langle x_1,\dots ,x_n\rangle $.} by direct computation that \myref{diagram}{kdm} have action $G \in k[x_1,\dots ,x_n]\mapsto G(t)\in k$. Because  $I \subseteq \mathfrak{p}$, by construction of $B$ we see \myref{diagram}{kdm} maps every element of $I$ to $0\in k$. Yet, at the same time the image of $F$ in $C$ is a unit by construction of  $C$, which implies the image of $F$ in the quotient ring $C\quotient \mathfrak{m}$ is nonzero. We have shown $t \in V$ and $F(t)\neq 0$, a contradiction. 
\end{proof}
\section{Noether Normalization Lemma (Half way there)}
Let $k$ be a field and $A$ a $k$-algebra. If we say $E\subseteq A$ is \textbf{algebraically independent over $k$}, we mean that there exists no $\set{y_1,\dots ,y_n}\subseteq E$ and polynomial $F\neq 0 \in k[x_1,\dots ,x_n]$ such that $F(y_1,\dots ,y_n)=0$. Before stating our version of \customref{NNL}{Noether Normalization Lemma}, we should prove what we should have proved in \customref{Id}{the previous section on Integral Dependence}, so one can see the equivalency between our version and others. 
\begin{theorem}
\label{IaFT1}
\textbf{(Integral and Finite Type)} Given rings $B\subseteq A$, if $x_1,\dots ,x_n \in A$ are integral over $B$, then  $B[x_1,\dots ,x_n]$ as a $B$-module finitely generated. 
\end{theorem}
\begin{proof}
We shall prove by induction on $n$.  Base case $n=1$ follows from \customref{EDfid}{the second definition of integral dependence}. Let $n> 1$.  Trivially, $x_n$ is integral over $B[x_1,\dots ,x_{n-1}]$, so it follows from  \customref{EDfid}{the second definition of integral dependence} that $B[x_1,\dots ,x_n]=(B[x_1,\dots,x_{n-1}])[x_n]$ is finitely generated as a $B[x_1,\dots ,x_{n-1}]$-module. Now, because inductive hypothesis said that $B[x_1,\dots ,x_{n-1}]$ is finitely generated as a $B$-module, we see from \myref{theorem}{Fgas}\footnote{You may check that the module structures here all agree with scalar extension.} that indeed $B[x_1,\dots ,x_n]$ is finitely generated as a $B$-module.
\end{proof}
\begin{corollary}
\textbf{(Integral and Finite Type)} Let $k$ be a field, and $A$ a finitely generated a $k$-algebra. Given any $y_1,\dots ,y_r \in A$, we have
\begin{align*}
A\text{ as a $k[y_1,\dots ,y_r]$-module is finitely generated }\iff A\text{ is integral over }k[y_1,\dots ,y_r] 
\end{align*}
\end{corollary}
\begin{proof}
$(\implies):$ This follows from  \customref{EDfid}{the third definition of integral dependence}. \\

$(\impliedby):$ Because $A$ is finitely generated as a $k$-algebra, there exists some $m$ and $y_1',\dots ,y_m'\in A$ such that $A=k[y_1',\dots,y_m']$. The proof then follows from  $A=(k[y_1,\dots ,y_r])[y_1',\dots ,y_m']$ and \myref{Theorem}{IaFT1}. 
\end{proof}
\begin{theorem}
\label{NNL}
\textbf{(Noether Normalization Lemma)} Let $k$ be a field. If $A$ is a finitely generated $k$-algebra, says, 
\begin{align*}
A= k[y_1',\dots ,y_m']\text{ for smallest }m,
\end{align*}
then there exists $y_1,\dots ,y_r \in A$ algebraically independent over $k$ such that  $A$ as a $k[y_1,\dots ,y_r]$-module is finitely generated. 
\end{theorem}
\begin{proof}
We shall prove by induction on $m$.  Consider the base case $m=1$. If $y_1'$ is algebraic independent over  $k$, then $y_1 \triangleq y_1'$ suffices trivially. If not, then clearly $A$ as a $k$-algebra is isomorphic to the quotient  $k[y]\quotient I$, where $k[y]$ is the formal polynomial ring and $I$ is the (clearly nonzero) ideal of polynomials vanishing at $y_1'$. Let $f$ be the generator of $I$.\footnote{$k[y]$ is a PID (To see this, just consider smallest degree element and division algorithm.). Its nonzero prime ideals are exactly those whose generator is irreducible (To see irreducible polynomials generate prime ideals, prove that they generate maximal ideal.).} The proof then follows from noting $A$ as a $k$-module is generated by $1,y,\dots ,y^{\operatorname{deg}f-1}$. \\

Let $m\geq 2$. If $y_i'$ are algebraically independent, then $y_i\triangleq y_i'$ suffices trivially. Suppose not.

(Remains to show Krudim)  \\





\end{proof}

(So $\operatorname{Krudim}(A)=0$. HOW? Because $A=k[y]\quotient I$ and $I$ nonzero  $\operatorname{Krudim}(k[y])=1$) 
 If $A$ is itself a field and the algebra-defining ring homomorphism $k \longrightarrow A$ forms an injective field homomorphism, then we can talk about the \textbf{transcendence degree $\operatorname{trdeg}_k A$ of $A$ over  $k$}. By Zorn's Lemma, there exists some maximal algebraically independent subset $E \subseteq A$, and by an argument similar to that for vector space, two maximal algebraically independent subsets $E_1,E_2 \subseteq A$ must have the same cardinality. It thus make sense for us to talk about the transcendence degree $\operatorname{trdeg}_k A$. 
 \section{Hilbert-Serre Theorem}
 \begin{theorem}
 \textbf{(Hilbert-Serre Theorem)} 
 \end{theorem}
\end{document}
